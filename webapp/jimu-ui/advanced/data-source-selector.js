define(["jimu-core","jimu-ui","jimu-arcgis","jimu-layouts/layout-runtime","jimu-ui/basic/item-selector","jimu-core/data-source"],(function(e,t,n,a,o,s){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1063)}({0:function(t,n){t.exports=e},1063:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1064);n(0).ThemeManager.getInstance().registerJimuThemeStyleModule("jimu-ui/advanced/data-source-selector/",{componentStyles:a}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(1075))},1064:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1065);t.DataSourceSelector=a.dataSourceSelectorStyles;var o=n(1066);t.DataSourceList=o.dataSourceListStyles;var s=n(1067);t.DataSourceTree=s.dataSourceTreeStyles;var r=n(1068);t.ExternalDataSourceSelector=r.externalDataSourceSelectorStyles;var i=n(1069);t.DataSourceItem=i.dataSourceItemStyles;var l=n(1070);t.DataSourceErrorItem=l.dataSourceErrorItemStyles;var c=n(1071);t.FieldSelector=c.fieldSelectorStyles;var d=n(1072);t.MainDataAndViewSelector=d.mainDataAndViewSelectorStyles;var u=n(1073);t.DataViewSettingPopup=u.dataViewSettingPopupStyles;var p=n(1074);t.DataSourceRemoveWarningPopup=p.dataSourceRemoveWarningPopupStyles},1065:function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(0);t.dataSourceSelectorStyles=function(e){var t=e.theme;return s.css(o||(o=a(["\n    .component-data-source-selector{\n      .font-dark-600{\n        color: ",";\n      }\n      .dv-select-container{\n        margin-top: ",";\n        .jimu-dropdown-button{\n          .settings-icon{\n            display: none;\n          }\n        }\n      }\n      .ds-selector-button{\n        height: ",";\n        line-height: ",";\n        padding: 0;\n        border: 1px dashed ",";\n        border-radius: ",";\n        cursor: pointer;\n        color: ",";\n        font-size: ",";\n        text-decoration: none;\n        &:hover{\n          border-color: ",";\n          color: ",";\n        }\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        padding: "," "," "," ",";\n        margin-top: ",";\n        background-color: ",";\n        cursor: pointer;\n\n        .mr-30{\n          margin-right: ",";\n        }\n\n        &.disable-cursor{\n          cursor: default;\n        }\n\n        .ds-item-close{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n          margin-right: -5px;\n        }\n\n        .ds-item-filter{\n          height: 100%;\n          cursor: pointer;\n        }\n\n        .ds-item-sort{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n        }\n\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .top-right-red-dot-container{\n          position: relative;\n        }\n        .top-right-red-dot{\n          position: absolute;\n          top: 0;\n          right: 0;\n          display: inline-block;\n          width: 8px;\n          height: 8px;\n          border-radius: 4px;\n          background-color: ",";\n        }\n      }\n    }\n\n  "],["\n    .component-data-source-selector{\n      .font-dark-600{\n        color: ",";\n      }\n      .dv-select-container{\n        margin-top: ",";\n        .jimu-dropdown-button{\n          .settings-icon{\n            display: none;\n          }\n        }\n      }\n      .ds-selector-button{\n        height: ",";\n        line-height: ",";\n        padding: 0;\n        border: 1px dashed ",";\n        border-radius: ",";\n        cursor: pointer;\n        color: ",";\n        font-size: ",";\n        text-decoration: none;\n        &:hover{\n          border-color: ",";\n          color: ",";\n        }\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        padding: "," "," "," ",";\n        margin-top: ",";\n        background-color: ",";\n        cursor: pointer;\n\n        .mr-30{\n          margin-right: ",";\n        }\n\n        &.disable-cursor{\n          cursor: default;\n        }\n\n        .ds-item-close{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n          margin-right: -5px;\n        }\n\n        .ds-item-filter{\n          height: 100%;\n          cursor: pointer;\n        }\n\n        .ds-item-sort{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n        }\n\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .top-right-red-dot-container{\n          position: relative;\n        }\n        .top-right-red-dot{\n          position: absolute;\n          top: 0;\n          right: 0;\n          display: inline-block;\n          width: 8px;\n          height: 8px;\n          border-radius: 4px;\n          background-color: ",";\n        }\n      }\n    }\n\n  "])),t.colors.palette.dark[600],s.polished.rem(12),s.polished.rem(40),s.polished.rem(40),t.colors.palette.dark[100],s.polished.rem(2),t.colors.palette.primary[700],s.polished.rem(14),t.colors.palette.dark[400],t.colors.palette.primary[800],t.colors.palette.secondary[400],t.colors.palette.dark[400],t.colors.palette.secondary[800],s.polished.rem(8),s.polished.rem(10),s.polished.rem(10),s.polished.rem(10),s.polished.rem(8),t.colors.palette.secondary[500],s.polished.rem(30),s.polished.rem(5),s.polished.rem(5),s.polished.rem(18),s.polished.rem(18),t.colors.palette.info[400],s.polished.rem(14),t.colors.palette.dark[800],t.colors.palette.danger[700])}},1066:function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(0);t.dataSourceListStyles=function(e){var t=e.theme;return s.css(o||(o=a(["\n    .component-data-source-list{\n      font-size: ",";\n      overflow: hidden;\n\n      .search{\n        position: relative;\n      }\n      .search-input{\n        height: 26px;\n        text-indent: 22px;\n        border-radius: 2px;\n      }\n      .search-icon{\n        color: ",";\n        position: absolute;\n        top: 6px;\n        left: 22px;\n      }\n\n      .empty-placeholder{\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        .empty-placeholder-text, .empty-placeholder-icon{\n          display: table;\n          margin: 0 auto;\n        }\n        .empty-placeholder-text{\n          color: ",";\n          font-size: ",";\n          margin-top: 16px;\n          text-align: center;\n        }\n        .empty-placeholder-icon{\n          color: ",";\n        }\n      }\n\n      .jimu-tab{\n        height: 100%;\n        .tab-content{\n          height: calc(100% - 40px);\n        }\n        .tab-pane{\n          width: 100%;\n        }\n        .jimu-nav.nav-pills{\n            padding: 0 "," !important;\n          }\n      }\n\n      .ds-list-container{\n        height: calc(100% - 80px);\n      }\n\n      .ds-list{\n        height: calc(100% - 120px);\n        overflow: auto;\n      }\n\n      .ds-list-header{\n        width: 100%;\n        height: ",";\n        line-height: ",";\n        border-bottom: 0;\n        color: ",";\n        font-size: ",";\n        font-weight: 500;\n      }\n\n      .ds-add-data{\n        position: absolute;\n        bottom: 0;\n        height: ",";\n        width: 100%;\n        color: ",";\n        font-size: ",";\n        border-top: 1px solid ",";\n        cursor: pointer;\n        &:hover{\n          .add-data-icon-container{\n            background-color: ",";\n          }\n          color: ",";\n        }\n        .add-data-icon-container{\n          width: ",";\n          height: ",";\n          background-color: ",";\n          border-radius: ",";\n        }\n        .add-data-icon{\n          color: ",";\n        }\n      }\n\n      .ds-list-close{\n        width: ",";\n        height: 100%;\n        cursor: pointer;\n      }\n\n      .ds-widget-back{\n        width: ",";\n        height: ",";\n        cursor: pointer;\n      }\n\n      .ds-types{\n        color: ",";\n        font-size: ",";\n        margin: "," 0;\n        padding: 0 ",";\n      }\n\n      .ds-widget-outputs{\n        padding: 0;\n      }\n\n      .ds-added-data{\n        padding: 0;\n      }\n\n      .to-use-types{\n        color: ",";\n        .types-selected{\n          max-width: ",";\n        }\n        .to-use-dp{\n          width: ",";\n          height: ",";\n        }\n      }\n\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        border: 2px solid transparent;\n        position: relative;\n        left: -2px;\n        cursor: pointer;\n        .item{\n          height: ",";\n          background-color: ",";\n          padding-left: 0;\n          padding-right: ",";\n        }\n        .selected{\n          width:  ",";\n          height:  ",";\n          border-radius: 0 0 0 2px;\n          background-color: ",";\n          position: absolute;\n          top: 0;\n          right: 0;\n          .selected-icon{\n            color: ",";\n            margin-left: 2px;\n            margin-top: -2px;\n          }\n        }\n      }\n      .ds-item.ds-item-selected{\n        border: 2px solid ",";\n      }\n    }\n\n  "],["\n    .component-data-source-list{\n      font-size: ",";\n      overflow: hidden;\n\n      .search{\n        position: relative;\n      }\n      .search-input{\n        height: 26px;\n        text-indent: 22px;\n        border-radius: 2px;\n      }\n      .search-icon{\n        color: ",";\n        position: absolute;\n        top: 6px;\n        left: 22px;\n      }\n\n      .empty-placeholder{\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        .empty-placeholder-text, .empty-placeholder-icon{\n          display: table;\n          margin: 0 auto;\n        }\n        .empty-placeholder-text{\n          color: ",";\n          font-size: ",";\n          margin-top: 16px;\n          text-align: center;\n        }\n        .empty-placeholder-icon{\n          color: ",";\n        }\n      }\n\n      .jimu-tab{\n        height: 100%;\n        .tab-content{\n          height: calc(100% - 40px);\n        }\n        .tab-pane{\n          width: 100%;\n        }\n        .jimu-nav.nav-pills{\n            padding: 0 "," !important;\n          }\n      }\n\n      .ds-list-container{\n        height: calc(100% - 80px);\n      }\n\n      .ds-list{\n        height: calc(100% - 120px);\n        overflow: auto;\n      }\n\n      .ds-list-header{\n        width: 100%;\n        height: ",";\n        line-height: ",";\n        border-bottom: 0;\n        color: ",";\n        font-size: ",";\n        font-weight: 500;\n      }\n\n      .ds-add-data{\n        position: absolute;\n        bottom: 0;\n        height: ",";\n        width: 100%;\n        color: ",";\n        font-size: ",";\n        border-top: 1px solid ",";\n        cursor: pointer;\n        &:hover{\n          .add-data-icon-container{\n            background-color: ",";\n          }\n          color: ",";\n        }\n        .add-data-icon-container{\n          width: ",";\n          height: ",";\n          background-color: ",";\n          border-radius: ",";\n        }\n        .add-data-icon{\n          color: ",";\n        }\n      }\n\n      .ds-list-close{\n        width: ",";\n        height: 100%;\n        cursor: pointer;\n      }\n\n      .ds-widget-back{\n        width: ",";\n        height: ",";\n        cursor: pointer;\n      }\n\n      .ds-types{\n        color: ",";\n        font-size: ",";\n        margin: "," 0;\n        padding: 0 ",";\n      }\n\n      .ds-widget-outputs{\n        padding: 0;\n      }\n\n      .ds-added-data{\n        padding: 0;\n      }\n\n      .to-use-types{\n        color: ",";\n        .types-selected{\n          max-width: ",";\n        }\n        .to-use-dp{\n          width: ",";\n          height: ",";\n        }\n      }\n\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        border: 2px solid transparent;\n        position: relative;\n        left: -2px;\n        cursor: pointer;\n        .item{\n          height: ",";\n          background-color: ",";\n          padding-left: 0;\n          padding-right: ",";\n        }\n        .selected{\n          width:  ",";\n          height:  ",";\n          border-radius: 0 0 0 2px;\n          background-color: ",";\n          position: absolute;\n          top: 0;\n          right: 0;\n          .selected-icon{\n            color: ",";\n            margin-left: 2px;\n            margin-top: -2px;\n          }\n        }\n      }\n      .ds-item.ds-item-selected{\n        border: 2px solid ",";\n      }\n    }\n\n  "])),t.typography.fontSizeBase,t.colors.palette.dark[600],t.colors.palette.dark[400],s.polished.rem(14),t.colors.palette.secondary[800],s.polished.rem(16),s.polished.rem(66),s.polished.rem(66),t.colors.palette.dark[600],s.polished.rem(16),s.polished.rem(40),t.colors.palette.primary[700],s.polished.rem(14),t.colors.palette.secondary[800],t.colors.palette.primary[800],t.colors.palette.primary[800],s.polished.rem(20),s.polished.rem(20),t.colors.palette.primary[700],s.polished.rem(10),t.colors.palette.light[300],s.polished.rem(30),s.polished.rem(80),s.polished.rem(30),t.colors.black,t.typography.fontSizeBase,s.polished.rem(6),s.polished.rem(16),t.colors.black,s.polished.rem(150),s.polished.rem(120),s.polished.rem(26),s.polished.rem(26),s.polished.rem(26),t.colors.palette.info[400],s.polished.rem(14),t.colors.palette.dark[800],t.colors.palette.secondary[400],t.colors.palette.dark[400],t.colors.palette.secondary[800],s.polished.rem(26),t.colors.palette.secondary[500],s.polished.rem(10),s.polished.rem(24),s.polished.rem(24),t.colors.palette.primary[700],t.colors.palette.secondary[500],t.colors.palette.primary[700])}},1067:function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(0);t.dataSourceTreeStyles=function(e){var t=e.theme;return s.css(o||(o=a(["\n    *{\n      margin: 0;\n      padding: 0;\n    }\n    .bg{\n      padding: "," ",";\n      background-color: ",";\n      border-top: 2px solid ",";\n    }\n    .tree-root{\n      padding-left: ",";\n      padding-right: ",";\n    }\n    .component-data-source-tree{\n      position: relative;\n      .collapse-button{\n        position: absolute;\n        left: 2px;\n        z-index: 1;\n      }\n      .collapse-content{\n        padding-left: ",";\n        padding-top: ",";\n        position: relative;\n      }\n      .collapse-button:not(.root):not(.leaf){\n        left: ",";\n      }\n      .collapse-button.leaf{\n        left: 2px;\n      }\n      .collapse-button:not(.root):before{\n        content: '';\n        position: absolute;\n        top: 50%;\n        left: -2px;\n        border-top: 1px solid ",";\n        width: ",";\n        transform: translateY(-50%);\n      }\n      .collapse-line{\n        border-left: 1px solid ",";\n        border-bottom: 1px solid ",";\n        width: ",";\n        position: absolute;\n        top: -1px;\n        left: 0;\n        z-index: 0;\n      }\n      .collapse-line:not(.root){\n        width: ",";\n        top: -2px;\n      }\n    }\n\n  "],["\n    *{\n      margin: 0;\n      padding: 0;\n    }\n    .bg{\n      padding: "," ",";\n      background-color: ",";\n      border-top: 2px solid ",";\n    }\n    .tree-root{\n      padding-left: ",";\n      padding-right: ",";\n    }\n    .component-data-source-tree{\n      position: relative;\n      .collapse-button{\n        position: absolute;\n        left: 2px;\n        z-index: 1;\n      }\n      .collapse-content{\n        padding-left: ",";\n        padding-top: ",";\n        position: relative;\n      }\n      .collapse-button:not(.root):not(.leaf){\n        left: ",";\n      }\n      .collapse-button.leaf{\n        left: 2px;\n      }\n      .collapse-button:not(.root):before{\n        content: '';\n        position: absolute;\n        top: 50%;\n        left: -2px;\n        border-top: 1px solid ",";\n        width: ",";\n        transform: translateY(-50%);\n      }\n      .collapse-line{\n        border-left: 1px solid ",";\n        border-bottom: 1px solid ",";\n        width: ",";\n        position: absolute;\n        top: -1px;\n        left: 0;\n        z-index: 0;\n      }\n      .collapse-line:not(.root){\n        width: ",";\n        top: -2px;\n      }\n    }\n\n  "])),s.polished.rem(16),s.polished.rem(2),t.colors.palette.light[200],t.colors.palette.info[400],s.polished.rem(20),s.polished.rem(5),s.polished.rem(20),s.polished.rem(16),s.polished.rem(-18),t.colors.palette.dark[400],s.polished.rem(21),t.colors.palette.dark[400],t.colors.palette.dark[400],s.polished.rem(22),s.polished.rem(20))}},1068:function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(0);t.externalDataSourceSelectorStyles=function(e){var t=e.theme;return s.css(o||(o=a(["\n    .component-external-data-source-selector{\n      height: 100%;\n      overflow: hidden;\n      position: relative;\n\n      .inner-item-selector-container{\n        .item-selector-container{\n          height: calc(100% - 110px);\n        }\n      }\n\n      .hint-label{\n        font-size: ",";\n        color: ",";\n      }\n\n      .added-ds-item{\n        position: relative;\n        cursor: pointer;\n        margin: "," "," "," ",";\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .item{\n          height: ",";\n        }\n      }\n\n      .added-ds-container{\n        width: ",";\n        background-color: ",";\n        box-shadow: 0 0 10px 4px ",";\n        position: absolute;\n        right: 30px;\n        bottom: 30px;\n        .added-ds-items{\n          max-height: ",";\n          overflow-y: auto;\n          overflow-x: hidden;\n        }\n        .small-done-btn{\n          max-width: ",";\n        }\n      }\n\n      .mt-30{\n        margin-top: ",";\n        margin-bottom: ",";\n      }\n\n      .selector-left{\n        width: ",";\n        background-color: ",";\n        border-right: 1px solid ",";\n        .selector-left-title{\n          padding: "," "," "," ",";\n          margin: 0;\n          font-size: ",";\n          color: ",";\n        }\n        .nav.nav-underline{\n          border: 0;\n          .nav-item{\n            .nav-link{\n              padding: 0;\n              border: 0;\n              .jimu-nav-link-wrapper{\n                display: flex;\n                justify-content: flex-start;\n                align-items: center;\n                padding: "," ",";\n                font-size: ",";\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item:hover{\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item.active-tab{\n            background-color: ",";\n            border-left: 4px solid ",";\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n                font-weight: 500;\n                padding-left: ",";\n              }\n            }\n          }\n        }\n      }\n\n      .selector-right{\n        width: calc(100% - ",");\n        .selector-right-header{\n          padding: "," "," "," ",";\n        }\n        .selector-right-body{\n          padding: "," ",";\n          height: calc(100% - 70px);\n        }\n        .nav-item{\n          .nav-link{\n            .jimu-nav-link-wrapper{\n              font-size: ",";\n            }\n          }\n        }\n        .nav-item.active-tab{\n          .nav-link{\n            border-bottom: 3px solid ",";\n            padding: 0;\n            .jimu-nav-link-wrapper{\n              color: ",";\n              font-weight: 500;\n            }\n          }\n        }\n      }\n\n      .external-data-source-url-input{\n        .url-type-select{\n          width: ",";\n        }\n        .url-input{\n          width: ",";\n        }\n        .url-input-add-btn{\n          height: ",";\n        }\n        .url-input-label{\n          font-size: ",";\n          color: ",";\n          margin-bottom: 12px;\n          font-weight: 500;\n        }\n      }\n\n      .external-data-source-app-data{\n        .item-list{\n          display: flex;\n          flex-wrap: wrap;\n          margin-top: 2rem;\n          margin-left: -0.5rem;\n          margin-right: -0.5rem;\n          overflow-x: hidden;\n          overflow-y: auto;\n\n          .item{\n            width: ","%;\n            margin-bottom: 1rem;\n            padding: 0 0.5rem;\n\n            .item-active-border-transparent{\n              border: "," solid transparent;\n\n              &:hover{\n                border-color: ",";\n              }\n            }\n\n            .item-card-container.item-border-transparent{\n              border: "," solid transparent;\n            }\n\n            .item-card-container{\n              border: "," solid;\n              padding-bottom: ",";\n              position: relative;\n              overflow: hidden;\n\n              &:hover{\n                border-color: transparent !important;\n              }\n\n              .item-card{\n                position: absolute;\n\n                .item-card-content{\n                  padding: ",";\n                }\n\n                .item-label{\n                  max-height: ",";\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                  white-space: nowrap;\n                }\n\n                .item-logo{\n                  width: ",";\n                  height: ",";\n                }\n\n                .item-active-icon{\n                  position: absolute;\n                  top: ",";\n                  left: ",";\n\n                  .item-active-icon-container{\n                    width: ",";\n                    height: ",";\n                    line-height: ",";\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      .external-data-source-item-selector{\n        .nav.nav-underline{\n          border: 0;\n          .nav-item:not(:last-child){\n            margin-right: ",";\n          }\n        }\n        .item-selector-search{\n          position: relative;\n          margin-left: ",";\n\n          .search-icon{\n            position: absolute;\n            left: ",";\n            padding: 0;\n            padding: 0;\n            top: 4px;\n            .jimu-icon{\n              margin: 0;\n            }\n          }\n\n          .close-icon{\n            position: absolute;\n            right: ",";\n            padding: 0;\n            padding: 0;\n            top: 4px;\n            .jimu-icon{\n              margin: 0;\n            }\n          }\n\n          @media only screen and (max-width: 1350px){\n            .search-input{\n              width: 100%;\n            }\n          }\n\n          @media only screen and (min-width: 1350px){\n            .search-input{\n              width: ",";\n            }\n          }\n\n          .search-input{\n            height: ",";\n            line-height: ",";\n            background-color: ",";\n            color: ",";\n            font-size: ",";\n            padding-left: ",";\n            padding-right: ",";\n            border-radius: 2px;\n          }\n          .search-input::-ms-clear{\n            display: none;\n          }\n        }\n\n        .item-selector-sort{\n          margin-right: -",";\n          .item-selector-sort-by{\n            color: ",";\n            font-size: ",";\n            height: ",";\n            .item-selector-sort-select{\n              width: ",";\n              padding: 2px 6px;\n              font-size: ",";\n              height: ",";\n            }\n          }\n        }\n      }\n\n    }\n\n  "],["\n    .component-external-data-source-selector{\n      height: 100%;\n      overflow: hidden;\n      position: relative;\n\n      .inner-item-selector-container{\n        .item-selector-container{\n          height: calc(100% - 110px);\n        }\n      }\n\n      .hint-label{\n        font-size: ",";\n        color: ",";\n      }\n\n      .added-ds-item{\n        position: relative;\n        cursor: pointer;\n        margin: "," "," "," ",";\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .item{\n          height: ",";\n        }\n      }\n\n      .added-ds-container{\n        width: ",";\n        background-color: ",";\n        box-shadow: 0 0 10px 4px ",";\n        position: absolute;\n        right: 30px;\n        bottom: 30px;\n        .added-ds-items{\n          max-height: ",";\n          overflow-y: auto;\n          overflow-x: hidden;\n        }\n        .small-done-btn{\n          max-width: ",";\n        }\n      }\n\n      .mt-30{\n        margin-top: ",";\n        margin-bottom: ",";\n      }\n\n      .selector-left{\n        width: ",";\n        background-color: ",";\n        border-right: 1px solid ",";\n        .selector-left-title{\n          padding: "," "," "," ",";\n          margin: 0;\n          font-size: ",";\n          color: ",";\n        }\n        .nav.nav-underline{\n          border: 0;\n          .nav-item{\n            .nav-link{\n              padding: 0;\n              border: 0;\n              .jimu-nav-link-wrapper{\n                display: flex;\n                justify-content: flex-start;\n                align-items: center;\n                padding: "," ",";\n                font-size: ",";\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item:hover{\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item.active-tab{\n            background-color: ",";\n            border-left: 4px solid ",";\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n                font-weight: 500;\n                padding-left: ",";\n              }\n            }\n          }\n        }\n      }\n\n      .selector-right{\n        width: calc(100% - ",");\n        .selector-right-header{\n          padding: "," "," "," ",";\n        }\n        .selector-right-body{\n          padding: "," ",";\n          height: calc(100% - 70px);\n        }\n        .nav-item{\n          .nav-link{\n            .jimu-nav-link-wrapper{\n              font-size: ",";\n            }\n          }\n        }\n        .nav-item.active-tab{\n          .nav-link{\n            border-bottom: 3px solid ",";\n            padding: 0;\n            .jimu-nav-link-wrapper{\n              color: ",";\n              font-weight: 500;\n            }\n          }\n        }\n      }\n\n      .external-data-source-url-input{\n        .url-type-select{\n          width: ",";\n        }\n        .url-input{\n          width: ",";\n        }\n        .url-input-add-btn{\n          height: ",";\n        }\n        .url-input-label{\n          font-size: ",";\n          color: ",";\n          margin-bottom: 12px;\n          font-weight: 500;\n        }\n      }\n\n      .external-data-source-app-data{\n        .item-list{\n          display: flex;\n          flex-wrap: wrap;\n          margin-top: 2rem;\n          margin-left: -0.5rem;\n          margin-right: -0.5rem;\n          overflow-x: hidden;\n          overflow-y: auto;\n\n          .item{\n            width: ","%;\n            margin-bottom: 1rem;\n            padding: 0 0.5rem;\n\n            .item-active-border-transparent{\n              border: "," solid transparent;\n\n              &:hover{\n                border-color: ",";\n              }\n            }\n\n            .item-card-container.item-border-transparent{\n              border: "," solid transparent;\n            }\n\n            .item-card-container{\n              border: "," solid;\n              padding-bottom: ",";\n              position: relative;\n              overflow: hidden;\n\n              &:hover{\n                border-color: transparent !important;\n              }\n\n              .item-card{\n                position: absolute;\n\n                .item-card-content{\n                  padding: ",";\n                }\n\n                .item-label{\n                  max-height: ",";\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                  white-space: nowrap;\n                }\n\n                .item-logo{\n                  width: ",";\n                  height: ",";\n                }\n\n                .item-active-icon{\n                  position: absolute;\n                  top: ",";\n                  left: ",";\n\n                  .item-active-icon-container{\n                    width: ",";\n                    height: ",";\n                    line-height: ",";\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      .external-data-source-item-selector{\n        .nav.nav-underline{\n          border: 0;\n          .nav-item:not(:last-child){\n            margin-right: ",";\n          }\n        }\n        .item-selector-search{\n          position: relative;\n          margin-left: ",";\n\n          .search-icon{\n            position: absolute;\n            left: ",";\n            padding: 0;\n            padding: 0;\n            top: 4px;\n            .jimu-icon{\n              margin: 0;\n            }\n          }\n\n          .close-icon{\n            position: absolute;\n            right: ",";\n            padding: 0;\n            padding: 0;\n            top: 4px;\n            .jimu-icon{\n              margin: 0;\n            }\n          }\n\n          @media only screen and (max-width: 1350px){\n            .search-input{\n              width: 100%;\n            }\n          }\n\n          @media only screen and (min-width: 1350px){\n            .search-input{\n              width: ",";\n            }\n          }\n\n          .search-input{\n            height: ",";\n            line-height: ",";\n            background-color: ",";\n            color: ",";\n            font-size: ",";\n            padding-left: ",";\n            padding-right: ",";\n            border-radius: 2px;\n          }\n          .search-input::-ms-clear{\n            display: none;\n          }\n        }\n\n        .item-selector-sort{\n          margin-right: -",";\n          .item-selector-sort-by{\n            color: ",";\n            font-size: ",";\n            height: ",";\n            .item-selector-sort-select{\n              width: ",";\n              padding: 2px 6px;\n              font-size: ",";\n              height: ",";\n            }\n          }\n        }\n      }\n\n    }\n\n  "])),s.polished.rem(12),t.colors.palette.dark[400],s.polished.rem(16),s.polished.rem(8),s.polished.rem(16),s.polished.rem(10),s.polished.rem(26),s.polished.rem(26),t.colors.palette.info[400],s.polished.rem(13),t.colors.dark,s.polished.rem(26),s.polished.rem(300),t.colors.palette.light[600],s.polished.rgba(t.colors.white,.3),s.polished.rem(500),s.polished.rem(100),s.polished.rem(30),s.polished.rem(20),s.polished.rem(260),t.colors.palette.light[400],t.colors.palette.light[800],s.polished.rem(20),s.polished.rem(20),s.polished.rem(27),s.polished.rem(20),s.polished.rem(20),t.colors.palette.dark[600],s.polished.rem(7),s.polished.rem(20),s.polished.rem(16),t.colors.palette.dark[600],t.colors.black,t.colors.palette.light[500],t.colors.palette.primary[600],t.colors.black,s.polished.rem(16),s.polished.rem(260),s.polished.rem(23),s.polished.rem(20),s.polished.rem(12),s.polished.rem(20),s.polished.rem(10),s.polished.rem(65),s.polished.rem(16),t.colors.palette.primary[600],t.colors.black,s.polished.rem(250),s.polished.rem(500),s.polished.rem(30),s.polished.rem(13),t.colors.palette.dark[400],20,s.polished.rem(2),t.colors.primary,s.polished.rem(2),s.polished.rem(1),s.polished.rem(135),s.polished.rem(5),s.polished.rem(60),s.polished.rem(60),s.polished.rem(60),s.polished.rem(5),s.polished.rem(5),s.polished.rem(20),s.polished.rem(20),s.polished.rem(20),s.polished.rem(40),s.polished.rem(50),s.polished.rem(4),s.polished.rem(4),s.polished.rem(400),s.polished.rem(32),s.polished.rem(32),t.colors.palette.secondary[200],t.colors.palette.dark[400],s.polished.rem(14),s.polished.rem(28),s.polished.rem(28),s.polished.rem(16),t.colors.palette.dark[400],s.polished.rem(13),s.polished.rem(32),s.polished.rem(140),s.polished.rem(13),s.polished.rem(26))}},1069:function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(0);t.dataSourceItemStyles=function(e){var t=e.theme;return s.css(o||(o=a(["\n    .component-data-source-item{\n      background-color: ",";\n      font-size: ",";\n      border-radius: 2px;\n      padding: 0;\n      .font-dark-600{\n        color: "," !important;\n      }\n      .ds-item-header{\n        width: 100%;\n        height: ",";\n        padding: 0 10px;\n        background-color: ",";\n      }\n      .ds-item-body{\n        width: 100%;\n        height: 100%;\n        padding: 14px 10px 6px 10px;\n      }\n      .two-line-truncate{\n        overflow: hidden;\n        text-overflow: ellipsis;\n        display: -webkit-box;\n        -webkit-line-clamp: 2;\n        -webkit-box-orient: vertical;\n        word-break: break-word;\n        word-wrap: break-word;\n      }\n      .ds-more{\n        margin-right: ",";\n      }\n      .ds-label{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-related-widgets, .ds-child-dss{\n        font-size: ",";\n      }\n      .warning-icon, .warning-icon>*{\n        color: ",";\n        fill: ",";\n      }\n    }\n\n    .component-data-source-item.component-data-source-item-selected-item{\n      border: "," solid ",";\n    }\n\n    .cursor-pointer{\n      cursor: pointer;\n    }\n\n  "],["\n    .component-data-source-item{\n      background-color: ",";\n      font-size: ",";\n      border-radius: 2px;\n      padding: 0;\n      .font-dark-600{\n        color: "," !important;\n      }\n      .ds-item-header{\n        width: 100%;\n        height: ",";\n        padding: 0 10px;\n        background-color: ",";\n      }\n      .ds-item-body{\n        width: 100%;\n        height: 100%;\n        padding: 14px 10px 6px 10px;\n      }\n      .two-line-truncate{\n        overflow: hidden;\n        text-overflow: ellipsis;\n        display: -webkit-box;\n        -webkit-line-clamp: 2;\n        -webkit-box-orient: vertical;\n        word-break: break-word;\n        word-wrap: break-word;\n      }\n      .ds-more{\n        margin-right: ",";\n      }\n      .ds-label{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-related-widgets, .ds-child-dss{\n        font-size: ",";\n      }\n      .warning-icon, .warning-icon>*{\n        color: ",";\n        fill: ",";\n      }\n    }\n\n    .component-data-source-item.component-data-source-item-selected-item{\n      border: "," solid ",";\n    }\n\n    .cursor-pointer{\n      cursor: pointer;\n    }\n\n  "])),t.colors.palette.light[500],s.polished.rem(12),t.colors.palette.dark[600],s.polished.rem(38),t.colors.palette.light[700],s.polished.rem(-8),s.polished.rem(14),t.colors.palette.dark[800],s.polished.rem(11),t.colors.palette.dark[800],s.polished.rem(18),s.polished.rem(18),t.colors.palette.info[400],s.polished.rem(13),t.colors.palette.danger[700],t.colors.palette.danger[700],s.polished.rem(2),t.colors.primary)}},1070:function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(0);t.dataSourceErrorItemStyles=function(e){var t=e.theme;return s.css(o||(o=a(["\n    .component-data-source-error-item{\n      .component-data-source-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n\n        .ds-origin-label{\n          max-width: 100%;\n          .ds-origin-label-link, .ds-origin-label-link:hover, .ds-origin-label-link:focus, .ds-origin-label-link:active{\n            color: ",";\n          }\n        }\n        .ds-item-header{\n          background-color: ",";\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n\n    }\n\n  "],["\n    .component-data-source-error-item{\n      .component-data-source-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n\n        .ds-origin-label{\n          max-width: 100%;\n          .ds-origin-label-link, .ds-origin-label-link:hover, .ds-origin-label-link:focus, .ds-origin-label-link:active{\n            color: ",";\n          }\n        }\n        .ds-item-header{\n          background-color: ",";\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n\n    }\n\n  "])),t.colors.palette.secondary[400],t.colors.palette.dark[400],t.colors.palette.dark[400],t.colors.palette.secondary[500],t.colors.palette.light[800])}},1071:function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(0);t.fieldSelectorStyles=function(e){var t=e.theme;return s.css(o||(o=a(["\n    .component-field-selector{\n      font-size: ",";\n      .ds-name{\n        color: ",";\n      }\n      .ds-name-label{\n        font-size: ",";\n        color: ",";\n        font-weight: 400;\n      }\n      .field-data-selected{\n        width: 70%;\n      }\n\n      .item-selector-search{\n        height: ",";\n        position: relative;\n      }\n\n      .field-list{\n        height: calc(100% - 50px);\n        overflow-y: auto;\n        .field-item.field-item-selected{\n          border: 1px solid ",";\n        }\n        .field-item{\n          border: 1px solid transparent;\n          cursor: pointer;\n          background-color: ",";\n          user-select: none;\n        }\n        .field-item:hover{\n          background-color: ",";\n        }\n        .field-item:active.field-item:hover{\n          background-color: ",";\n        }\n      }\n\n      .search-icon{\n        position: absolute;\n        top: ",";\n        left: ",";\n      }\n\n      .search-input{\n        height: ",";\n        text-indent: ",";\n      }\n\n    }\n\n  "],["\n    .component-field-selector{\n      font-size: ",";\n      .ds-name{\n        color: ",";\n      }\n      .ds-name-label{\n        font-size: ",";\n        color: ",";\n        font-weight: 400;\n      }\n      .field-data-selected{\n        width: 70%;\n      }\n\n      .item-selector-search{\n        height: ",";\n        position: relative;\n      }\n\n      .field-list{\n        height: calc(100% - 50px);\n        overflow-y: auto;\n        .field-item.field-item-selected{\n          border: 1px solid ",";\n        }\n        .field-item{\n          border: 1px solid transparent;\n          cursor: pointer;\n          background-color: ",";\n          user-select: none;\n        }\n        .field-item:hover{\n          background-color: ",";\n        }\n        .field-item:active.field-item:hover{\n          background-color: ",";\n        }\n      }\n\n      .search-icon{\n        position: absolute;\n        top: ",";\n        left: ",";\n      }\n\n      .search-input{\n        height: ",";\n        text-indent: ",";\n      }\n\n    }\n\n  "])),t.typography.fontSizeBase,t.colors.black,s.polished.rem(14),t.colors.palette.dark[400],s.polished.rem(26),t.colors.primary,t.colors.palette.light[400],t.colors.palette.light[500],t.colors.white,s.polished.rem(5),s.polished.rem(25),s.polished.rem(26),s.polished.rem(25))}},1072:function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(0);t.mainDataAndViewSelectorStyles=function(e){var t=e.theme;return s.css(o||(o=a(["\n    .component-main-data-and-view{\n      .option-label{\n        font-size: ",";\n        font-weight: 500;\n        color: ",";\n      }\n    }\n  "],["\n    .component-main-data-and-view{\n      .option-label{\n        font-size: ",";\n        font-weight: 500;\n        color: ",";\n      }\n    }\n  "])),s.polished.rem(13),t.colors.palette.dark[400])}},1073:function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(0);t.dataViewSettingPopupStyles=function(e){var t=e.theme;return s.css(o||(o=a(["\n    .data-view-container{\n      width: ",";\n      height: ",";\n      border: 0;\n    }\n    .cicle-button{\n      width: ",";\n      height: ",";\n      border-radius: ",";\n    }\n    .w-38{\n      width: 38%;\n    }\n    .w-62{\n      width: 62%;\n    }\n    .preview-table{\n      position: relative;\n    }\n    .table-container{\n      height : 100%;\n      overflow-x: auto;\n      .table-body{\n        overflow-y: auto;\n        width: fit-content;\n      }\n      .table-header{\n        position: sticky;\n        top: 0;\n      }\n      tr{\n        border-top: 1px solid ",";\n      }\n      tr:last-child{\n        border-bottom: 1px solid ",";\n      }\n      td, th{\n        width: ",";\n        height: ",";\n        display: inline-block !important;\n        border-left: 1px solid ",";\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        padding: 6px 4px;\n      }\n      td{\n        background-color: ",";\n      }\n      th{\n        background-color: ",";\n      }\n      td:last-child, th:last-child{\n        border-right: 1px solid ",";\n      }\n    }\n    .modal-body{\n      height: calc(100% - ",");\n    }\n    &.modal-dialog{\n      max-width: ",";\n    }\n    .modal-header{\n      .close{\n        display: none;\n      }\n      .modal-title{\n        width: 100%;\n        display: flex !important;\n        align-items: center !important;\n      }\n    }\n\n    .jimu-nav{\n      margin-bottom: ",";\n    }\n\n    .label{\n      font-size: ",";\n      color: ",";\n    }\n\n    .header{\n      height: ",";\n    }\n\n    .tab-content{\n      height: ",";\n      overflow-y: auto;\n    }\n\n  "],["\n    .data-view-container{\n      width: ",";\n      height: ",";\n      border: 0;\n    }\n    .cicle-button{\n      width: ",";\n      height: ",";\n      border-radius: ",";\n    }\n    .w-38{\n      width: 38%;\n    }\n    .w-62{\n      width: 62%;\n    }\n    .preview-table{\n      position: relative;\n    }\n    .table-container{\n      height : 100%;\n      overflow-x: auto;\n      .table-body{\n        overflow-y: auto;\n        width: fit-content;\n      }\n      .table-header{\n        position: sticky;\n        top: 0;\n      }\n      tr{\n        border-top: 1px solid ",";\n      }\n      tr:last-child{\n        border-bottom: 1px solid ",";\n      }\n      td, th{\n        width: ",";\n        height: ",";\n        display: inline-block !important;\n        border-left: 1px solid ",";\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        padding: 6px 4px;\n      }\n      td{\n        background-color: ",";\n      }\n      th{\n        background-color: ",";\n      }\n      td:last-child, th:last-child{\n        border-right: 1px solid ",";\n      }\n    }\n    .modal-body{\n      height: calc(100% - ",");\n    }\n    &.modal-dialog{\n      max-width: ",";\n    }\n    .modal-header{\n      .close{\n        display: none;\n      }\n      .modal-title{\n        width: 100%;\n        display: flex !important;\n        align-items: center !important;\n      }\n    }\n\n    .jimu-nav{\n      margin-bottom: ",";\n    }\n\n    .label{\n      font-size: ",";\n      color: ",";\n    }\n\n    .header{\n      height: ",";\n    }\n\n    .tab-content{\n      height: ",";\n      overflow-y: auto;\n    }\n\n  "])),s.polished.rem(960),s.polished.rem(670),s.polished.rem(32),s.polished.rem(32),s.polished.rem(16),t.colors.palette.light[400],t.colors.palette.light[400],s.polished.rem(86),s.polished.rem(32),t.colors.palette.light[400],t.colors.palette.light[200],t.colors.palette.light[400],t.colors.palette.light[400],s.polished.rem(150),s.polished.rem(960),s.polished.rem(30),s.polished.rem(13),t.colors.palette.dark[400],s.polished.rem(54),s.polished.rem(426))}},1074:function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(0);t.dataSourceRemoveWarningPopupStyles=function(e){var t=e.theme;return s.css(o||(o=a(["\n    &.modal-dialog{\n      position: fixed !important;\n      top: 50% !important;\n      left: 50% !important;\n      transform: translate(-50%, -50%) !important;\n      width: 480px;\n      height: 560px;\n    }\n    .modal-content{\n      border: 0;\n    }\n    .modal-header, .modal-body{\n      padding-left: 20px;\n      padding-right: 20px;\n    }\n    .modal-footer{\n      padding-top: 0;\n      padding-bottom: 20px;\n    }\n    .font-16{\n      font-size: ",";\n    }\n    .font-14{\n      font-size: ",";\n    }\n    .font-13{\n      font-size: ",";\n    }\n    .font-dark-800{\n      color: ",";\n    }\n    .font-dark-600{\n      color: ",";\n    }\n    .related-widgets{\n      width: 100%;\n      height: ",";\n      overflow: auto;\n      background-color: ",";\n    }\n  "],["\n    &.modal-dialog{\n      position: fixed !important;\n      top: 50% !important;\n      left: 50% !important;\n      transform: translate(-50%, -50%) !important;\n      width: 480px;\n      height: 560px;\n    }\n    .modal-content{\n      border: 0;\n    }\n    .modal-header, .modal-body{\n      padding-left: 20px;\n      padding-right: 20px;\n    }\n    .modal-footer{\n      padding-top: 0;\n      padding-bottom: 20px;\n    }\n    .font-16{\n      font-size: ",";\n    }\n    .font-14{\n      font-size: ",";\n    }\n    .font-13{\n      font-size: ",";\n    }\n    .font-dark-800{\n      color: ",";\n    }\n    .font-dark-600{\n      color: ",";\n    }\n    .related-widgets{\n      width: 100%;\n      height: ",";\n      overflow: auto;\n      background-color: ",";\n    }\n  "])),s.polished.rem(16),s.polished.rem(14),s.polished.rem(13),t.colors.palette.dark[800],t.colors.palette.dark[600],s.polished.rem(160),t.colors.palette.light[200])}},1075:function(e,t,n){"use strict";function a(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var o=n(125);t.AllDataSourceTypes=o.AllDataSourceTypes;var s=n(59);t.dataComponentsUtils=s,a(n(1076)),a(n(558)),a(n(559)),a(n(566)),a(n(1087)),a(n(1088)),a(n(567)),a(n(564)),a(n(565))},1076:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),l=n(3),c=n(1077),d=function(e){function t(t){var n=e.call(this,t)||this;return n.onToggleUseDataEnabled=function(){n.props.onToggleUseDataEnabled&&n.props.onToggleUseDataEnabled(!n.props.useDataSourcesEnabled)},n.onChange=function(e){n.props.onChange&&n.props.onChange(e)},n}return o(t,e),t.prototype.render=function(){var e,t=this.props,n=(t.onChange,r(t,["onChange"]));return i.jsx("div",{className:i.classNames("w-100",(e={},e[this.props.className]=!!this.props.className,e))},i.jsx("div",{className:"component-data-source-selector"},!this.props.mustUseDataSource&&i.jsx("div",{className:i.classNames("d-flex justify-content-between w-100 align-items-center",{"mb-3":this.props.useDataSourcesEnabled})},i.jsx("label",{className:"w-75 text-truncate d-inline-block font-dark-600"},this.props.intl.formatMessage({id:"connectToData",defaultMessage:l.defaultMessages.connectToData})),i.jsx(l.Switch,{checked:this.props.useDataSourcesEnabled,onChange:this.onToggleUseDataEnabled})),(this.props.mustUseDataSource||this.props.useDataSourcesEnabled)&&i.jsx(c.default,s({types:this.props.types},n,{onChange:this.onChange,intl:this.props.intl,closeDataSourceListOnChange:this.props.closeDataSourceListOnChange,fromDsIds:this.props.fromDsIds,widgetId:this.props.widgetId}))))},t}(i.React.PureComponent),u=i.injectIntl(i.themeUtils.withStyles(d,"DataSourceSelector"));t.DataSourceSelector=i.ReactRedux.connect((function(e){return{dataSources:e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.dataSources,dataSourcesInfo:e.appStateInBuilder&&e.appStateInBuilder.dataSourcesInfo}}))(u)},1077:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(59),l=n(558),c=n(1086);t.DefaultDataViewId="USE_MAIN_DATA_SOURCE";var d=function(e){function n(n){var a=e.call(this,n)||this;return a.__unmount=!1,a.DefaultDataView=s.Immutable({id:t.DefaultDataViewId,label:a.props.intl.formatMessage({id:"default",defaultMessage:r.defaultMessages.default})}),a.changeInitStatus=function(e){a.setState({isDataSourceInited:e})},a.disableSelection=function(){if(a.props.disableSelection){var e=a.props.useDataSources||s.Immutable([]);return a.props.disableSelection(e.asMutable({deep:!0}))}return!1},a.disableRemove=function(){if(a.props.disableRemove){var e=a.props.useDataSources||s.Immutable([]);return a.props.disableRemove(e.asMutable({deep:!0}))}return!1},a.onModalClose=function(){a.setState({modalType:"none"})},a.onMainDsChanged=function(e){e&&(a.props.onChange&&a.props.onChange(e),a.props.closeDataSourceListOnChange&&a.setState({modalType:"none"}))},a.onMainDsRemoved=function(e){if(e&&a.props.useDataSources){var t=a.props.useDataSources.filter((function(t){return(null==t?void 0:t.mainDataSourceId)!==e}));a.props.onChange&&a.props.onChange(t.asMutable({deep:!0}))}},a.onDataViewChanged=function(e,n){if(e&&a.props.useDataSources){var o=s.Immutable(a.props.useDataSources.find((function(t){return t.mainDataSourceId===e}))||{dataSourceId:e,mainDataSourceId:e}),r=n.map((function(n){return n.id===t.DefaultDataViewId?o.without("dataViewId").set("dataSourceId",e).asMutable({deep:!0}):o.set("dataViewId",n.id).set("dataSourceId",s.DataSourceManager.getInstance().getDataViewDataSourceId(e,n.id)).asMutable({deep:!0})})),i=a.props.useDataSources.filter((function(t){return(null==t?void 0:t.mainDataSourceId)!==e})).concat(r);a.props.onChange&&a.props.onChange(i.asMutable({deep:!0}))}},a.toggleDsList=function(){a.props.disableDataSourceList||a.setState({modalType:"ds"===a.state.modalType?"none":"ds"})},a.getWhetherShowPlaceholder=function(){var e;if(null===(e=a.props.useDataSources)||void 0===e?void 0:e.some((function(e){return!s.DataSourceManager.getInstance().getDataSource(e.dataSourceId)})))return!0;if(a.props.disableSelection){var t=a.props.useDataSources||s.Immutable([]);return!a.props.disableSelection(t.asMutable({deep:!0}))}return a.props.isMultiple||!a.props.isMultiple&&(!a.props.useDataSources||0===a.props.useDataSources.filter((function(e){return!!e})).length)},a.groupUseDssByMainDataSource=function(e){if(!e||0===e.length)return null;var t={};return e.forEach((function(e){if(t[e.mainDataSourceId]||(t[e.mainDataSourceId]=s.Immutable([])),e.dataViewId){var n=s.DataSourceManager.getInstance().getDataSource(e.mainDataSourceId),o=n&&n.getDataSourceJson(),r=o&&o.dataViews;t[e.mainDataSourceId]=r?t[e.mainDataSourceId].concat(r[e.dataViewId]):s.Immutable([])}else t[e.mainDataSourceId]=t[e.mainDataSourceId].concat(a.DefaultDataView)})),t},a.state={isDataSourceInited:i.getWhetherDataSourceIsInited(a.props.dataSourcesInfo),modalType:"none",SidePopper:null},a}return o(n,e),n.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,s.moduleLoader.loadModule("jimu-ui/advanced/setting-components").then((function(t){e.__unmount||e.setState({SidePopper:t.SidePopper})}))},n.prototype.componentWillUnmount=function(){this.__unmount=!0},n.prototype.componentDidUpdate=function(e){s.lodash.isDeepEqual(this.props.dataSources,e.dataSources)&&s.lodash.isDeepEqual(this.props.dataSourcesInfo,e.dataSourcesInfo)||this.changeInitStatus(i.getWhetherDataSourceIsInited(this.props.dataSourcesInfo))},n.prototype.render=function(){var e=this,t=this.state.modalType,n=this.state.SidePopper,a=this.getWhetherShowPlaceholder(),o=this.groupUseDssByMainDataSource(this.props.useDataSources);return s.jsx("div",{className:"w-100"},o&&Object.keys(o).sort((function(e,t){return e.localeCompare(t)})).map((function(t,n){return t?s.jsx(c.default,{key:n,mainDataSourceId:t,onRemove:e.onMainDsRemoved,intl:e.props.intl,hideRemove:e.disableRemove(),theme:e.props.theme,disableDataSourceList:e.props.disableDataSourceList,onClick:e.toggleDsList,className:e.props.isMultiple&&"mb-3",onChange:e.onDataViewChanged,disableDataView:e.props.disableDataView,disableAddData:e.props.disableAddData,isMultiple:e.props.isMultiple,dataViews:o[t],DefaultDataView:e.DefaultDataView,hideDataView:e.props.hideDataView}):null})),n&&s.jsx(n,{isOpen:"none"!==t&&!s.urlUtils.getAppIdPageIdFromUrl().pageId,position:"right"},s.jsx("div",{className:"bg-light-300 h-100 w-100"},"ds"===t?s.jsx(l.DataSourceList,{types:this.props.types,onChange:this.onMainDsChanged,changeInitStatus:this.changeInitStatus,onCloseClick:this.onModalClose,isMultiple:this.props.isMultiple,fromDsIds:this.props.fromDsIds,useDataSources:this.props.useDataSources,isDataSourceInited:this.state.isDataSourceInited,widgetId:this.props.widgetId,disableSelection:this.disableSelection(),disableRemove:this.disableRemove(),fromRootDsIds:this.props.fromRootDsIds,hideHeader:this.props.hideHeader,hideTypeDropdown:this.props.hideTypeDropdown,disableAddData:this.props.disableAddData}):null)),a&&s.jsx(r.Link,{className:"ds-selector-button w-100 mt-0 d-flex justify-content-center align-items-center px-2",onClick:this.toggleDsList},s.jsx("div",{className:"text-truncate"},this.props.buttonLabel||this.props.intl.formatMessage({id:"setDataSource",defaultMessage:r.defaultMessages.setDataSource}))))},n}(s.React.PureComponent);t.default=s.themeUtils.withTheme(d)},1078:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(560),l=function(e){function t(t){var n=e.call(this,t)||this;return n.dataSourceUrlTypes=[{label:n.props.intl.formatMessage({id:"anArcGISServerWebService",defaultMessage:r.defaultMessages.anArcGISServerWebService})}],n.onUrlTypesClicked=function(e){n.setState({selectedDataSourceUrlType:e.target.value})},n.onInputUrl=function(e){var t=!1;(/^https:\/\//.test(e.target.value)||/^\/\//.test(e.target.value))&&s.dataSourceUtils.isSupportedService(e.target.value)&&(t=!0),n.setState({url:e.target.value,isSupported:t})},n.onAdded=function(){if(n.state.url){var e=n.state.url.split("?")[0];if(!e)return;return n.props.toggleLoadStatus(!1),i.fetchDataFromService(e,n.props.getDsId()).then((function(e){n.changeDsJsons(e),n.props.toggleLoadStatus(!0)}),(function(e){console.error(e),n.props.toggleToastStatus(!0),n.props.toggleLoadStatus(!0)}))}},n.changeDsJsons=function(e){(null==e?void 0:e.dsJson)?(n.props.onAdded(e),n.setState({isSupported:!0})):n.setState({isSupported:!1})},n.state={selectedDataSourceUrlType:n.dataSourceUrlTypes[0],url:"",isSupported:!0},n}return o(t,e),t.prototype.componentDidMount=function(){},t.prototype.render=function(){return s.React.createElement("div",{className:"external-data-source-url-input"},s.React.createElement("div",{className:"mt-3 ml-2"},s.React.createElement("h5",{className:"url-input-label"},this.props.intl.formatMessage({id:"serviceType",defaultMessage:r.defaultMessages.serviceType})),s.React.createElement(r.Select,{value:this.state.selectedDataSourceUrlType.label,title:this.state.selectedDataSourceUrlType.label,onChange:this.onUrlTypesClicked,className:"url-type-select",buttonProps:{className:"text-truncate"}},this.dataSourceUrlTypes.map((function(e){return s.React.createElement("option",{key:e.label,value:e.label},e.label)})))),s.React.createElement("div",{className:"mt-4 ml-2"},s.React.createElement("h5",{className:"url-input-label"},this.props.intl.formatMessage({id:"url",defaultMessage:r.defaultMessages.url})),s.React.createElement(r.TextInput,{placeholder:"URL",onChange:this.onInputUrl,className:"url-input",value:this.state.url}),s.React.createElement("p",{className:"mt-2 hint-label"},this.props.intl.formatMessage({id:"addDataByUrlHint",defaultMessage:r.defaultMessages.addDataByUrlHint}))),s.React.createElement("div",{className:"mt-3 ml-2"},s.React.createElement(r.Button,{onClick:this.onAdded,type:"primary",disabled:!this.state.url||!this.state.isSupported,className:"url-input-add-btn px-3"},this.props.intl.formatMessage({id:"add",defaultMessage:r.defaultMessages.add}))))},t}(s.React.PureComponent);t.default=l},1079:function(e,t){e.exports=s},1080:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(383),l=n(384),c=n(37),d=n(385),u=n(386),p=function(e){function t(t){var n,a,o,l,c=e.call(this,t)||this;return c.__unmount=!1,c.itemCategory=((n={})[i.ItemCategory.MyContent]=c.props.intl.formatMessage({id:"myContent",defaultMessage:r.defaultMessages.myContent}),n[i.ItemCategory.MyGroup]=c.props.intl.formatMessage({id:"myGroup",defaultMessage:r.defaultMessages.myGroup}),n[i.ItemCategory.MyOrganization]=c.props.intl.formatMessage({id:"myOrganization",defaultMessage:r.defaultMessages.myOrganization}),n[i.ItemCategory.Public]=c.props.intl.formatMessage({id:"public",defaultMessage:r.defaultMessages.public}),n),c.sortField=((a={})[i.SortField.Modified]=c.props.intl.formatMessage({id:"modified",defaultMessage:r.defaultMessages.modified}),a[i.SortField.Title]=c.props.intl.formatMessage({id:"title",defaultMessage:r.defaultMessages.title}),a[i.SortField.Views]=c.props.intl.formatMessage({id:"numViews",defaultMessage:r.defaultMessages.numViews}),a),c.defaultSelectedFolder={id:null,title:c.props.intl.formatMessage({id:"allMyContent",defaultMessage:r.defaultMessages.allMyContent})},c.rootFolder={id:"root",title:(null===(l=null===(o=s.getAppStore().getState())||void 0===o?void 0:o.user)||void 0===l?void 0:l.username)||c.props.intl.formatMessage({id:"rootFolder",defaultMessage:r.defaultMessages.rootFolder})},c.defaultFolders=[c.defaultSelectedFolder,c.rootFolder],c.defaultSelectedGroup={id:null,title:c.props.intl.formatMessage({id:"allMyGroupsContent",defaultMessage:r.defaultMessages.allMyGroupsContent})},c.onCategoryChange=function(e){c.setState({selectedCategory:e})},c.onSearchInputKeyDown=function(e){13===e.which?c.enterOrSearchIsClicked():c.enterOrSearchIsUnclicked()},c.enterOrSearchIsClicked=function(){c.setState({isEnterOrSearchIconClicked:!0})},c.enterOrSearchIsUnclicked=function(){c.setState({isEnterOrSearchIconClicked:!1})},c.clearSearch=function(){c.setSearchValue(""),c.enterOrSearchIsUnclicked()},c.setSearchValue=function(e){c.setState({searchValue:e})},c.onSearchChange=function(e){c.debounceSetSearchValue(e.target.value)},c.onSortFieldChange=function(e){var t=e.target.value;c.setState({sortField:t})},c.onFolderChange=function(e){var t=e.target.value,n=c.state.folders.find((function(e){return e.id===t}))||c.defaultSelectedFolder;c.setState({selectedFolder:n})},c.onGroupChange=function(e){var t=e.target.value,n=c.state.groups.find((function(e){return e.id===t}))||c.defaultSelectedGroup;c.setState({selectedGroup:n})},c.onSortOrderChange=function(){c.setState({sortOrder:c.state.sortOrder===i.SortOrder.Desc?i.SortOrder.Asc:i.SortOrder.Desc})},c.onItemAdded=function(e,t){c.props.onSelect(e,t)},c.onItemRemoved=function(e,t){c.props.onRemove(e,t)},c.debounceSetSearchValue=s.lodash.debounce((function(e){return c.setSearchValue(e)}),500),c.state={searchValue:"",sortField:i.SortField.Modified,sortOrder:i.SortOrder.Desc,isEnterOrSearchIconClicked:!1,selectedCategory:i.ItemCategory.MyContent,selectedFolder:c.defaultSelectedFolder,selectedGroup:c.defaultSelectedGroup,appServices:null,folders:c.defaultFolders,groups:[c.defaultSelectedGroup]},c}return o(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,this.setState({groups:this.getGroups()}),s.moduleLoader.loadModule("jimu-for-builder/service").then((function(t){e.__unmount||e.setState({appServices:t.appServices},(function(){e.getFolders().then((function(t){return e.setState({folders:t})}))}))}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.getGroups=function(){var e,t,n=null===(t=null===(e=s.getAppStore())||void 0===e?void 0:e.getState())||void 0===t?void 0:t.user;return(null==n?void 0:n.groups)?[this.defaultSelectedGroup].concat(n.groups.asMutable({deep:!0})):[this.defaultSelectedGroup]},t.prototype.getFolders=function(){var e,t,n=this.defaultFolders;return(null===(t=null===(e=this.state)||void 0===e?void 0:e.appServices)||void 0===t?void 0:t.getFolders)?this.state.appServices.getFolders({num:1}).then((function(e){return n=e?n.concat(e):n}),(function(e){return console.log("Getting user content failed: ",e),n})):Promise.resolve(n)},t.prototype.render=function(){var e=this;return s.React.createElement("div",{className:"external-data-source-item-selector w-100 h-100"},Object.keys(i.ItemCategory).map((function(t,n){var a,o;return s.React.createElement("div",{className:s.classNames("h-100 w-100",{"d-none":i.ItemCategory[t]!==e.state.selectedCategory}),key:n},s.React.createElement("div",{className:"w-100 d-flex justify-content-between align-items-end"},s.React.createElement(r.Nav,{underline:!0},Object.keys(i.ItemCategory).map((function(t){return s.React.createElement(r.NavItem,{key:t,title:e.itemCategory[i.ItemCategory[t]],className:s.classNames({"active-tab":e.state.selectedCategory===i.ItemCategory[t]})},s.React.createElement(r.NavLink,{onClick:function(){e.onCategoryChange(i.ItemCategory[t])},active:e.state.selectedCategory===i.ItemCategory[t],className:"w-100 text-truncate"},e.itemCategory[i.ItemCategory[t]]))}))),s.React.createElement("div",{className:"flex-grow-1 d-flex justify-content-end"},s.React.createElement("div",{className:"item-selector-search"},s.React.createElement(r.Button,{type:"tertiary",className:"search-icon",onClick:e.enterOrSearchIsClicked,icon:!0},s.React.createElement(r.Icon,{width:16,height:16,icon:l})),s.React.createElement(r.TextInput,{onKeyDown:e.onSearchInputKeyDown,placeholder:e.props.intl.formatMessage({id:"search",defaultMessage:s.defaultMessages.search}),onChange:e.onSearchChange,className:"search-input",value:e.state.searchValue}),e.state.searchValue&&s.React.createElement(r.Button,{type:"tertiary",className:"close-icon",onClick:e.clearSearch,icon:!0},s.React.createElement(r.Icon,{width:16,height:16,icon:c}))))),s.React.createElement("div",{className:"d-flex justify-content-between mt-30 mb-20"},s.React.createElement("div",null,e.state.selectedCategory===i.ItemCategory.MyContent&&s.React.createElement(r.Select,{value:""+e.state.selectedFolder.id,title:e.state.selectedFolder.title,onChange:e.onFolderChange,className:"d-inline-block item-selector-sort-select",buttonProps:{className:"text-truncate"}},e.state.folders.map((function(e){return s.React.createElement("option",{key:e.id,value:""+e.id},e.title)}))),e.state.selectedCategory===i.ItemCategory.MyGroup&&s.React.createElement(r.Select,{value:""+e.state.selectedGroup.id,title:e.state.selectedGroup.title,onChange:e.onGroupChange,className:"d-inline-block item-selector-sort-select",buttonProps:{className:"text-truncate"}},e.state.groups.map((function(e){return s.React.createElement("option",{key:e.id,value:""+e.id},e.title)})))),s.React.createElement("div",{className:"d-flex justify-content-between align-items-center item-selector-sort"},s.React.createElement("div",{className:"item-selector-sort-by"},s.React.createElement("div",{className:"d-inline-block mr-2"},e.props.intl.formatMessage({id:"sortBy",defaultMessage:r.defaultMessages.sortBy})),s.React.createElement(r.Select,{value:e.state.sortField,title:e.sortField[i.SortField[e.state.sortField]],onChange:e.onSortFieldChange,className:"d-inline-block item-selector-sort-select",buttonProps:{className:"text-truncate"}},Object.keys(i.SortField).map((function(t){return s.React.createElement("option",{key:i.SortField[t],value:i.SortField[t]},e.sortField[i.SortField[t]])})))),s.React.createElement("div",{className:"item-selector-sort-order"},e.state.sortOrder===i.SortOrder.Desc?s.React.createElement(r.Button,{type:"tertiary",onClick:e.onSortOrderChange,title:e.props.intl.formatMessage({id:"decending",defaultMessage:r.defaultMessages.decending})},s.React.createElement(r.Icon,{width:16,height:16,icon:d})):s.React.createElement(r.Button,{type:"tertiary",onClick:e.onSortOrderChange,title:e.props.intl.formatMessage({id:"ascending",defaultMessage:r.defaultMessages.ascending})},s.React.createElement(r.Icon,{width:16,height:16,icon:u}))))),s.React.createElement("div",{className:"w-100 item-selector-container"},s.React.createElement(i.ItemSelector,{category:i.ItemCategory[t],portalUrl:e.props.portalUrl,searchValue:e.state.searchValue.length>2||0===e.state.searchValue.length||e.state.isEnterOrSearchIconClicked?e.state.searchValue:"",itemType:e.props.itemType,getDetailPosition:e.props.getItemDetailPosition,selectedItems:e.props.selectedItems,sortField:e.state.sortField,onSelect:e.onItemAdded,onRemove:e.onItemRemoved,isRadio:e.props.isRadio,partSelectedItems:e.props.partSelectedItems,sortOrder:e.state.sortOrder,folderId:null===(a=e.state.selectedFolder)||void 0===a?void 0:a.id,groupId:null===(o=e.state.selectedGroup)||void 0===o?void 0:o.id})))})))},t}(s.React.PureComponent);t.default=p},1081:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(562),l=n(563),c=n(391),d=n(59),u=n(238),p=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.initData=function(){n.setSelectedType(null),n.setToUseDataSources(n.props.types,n.props.fromRootDsIds,n.props.fromDsIds,n.props.searchValue)},n.setToUseDataSources=function(e,t,a,o){var s=n.getToUseRootDss(e,t,a,o);n.getToUseChildDss(e,t,a,o).then((function(e){var t=n.getToUseWidgets(s,e);n.__unmount||n.setState({toUseRootDss:s,toUseChildDss:e,toUseWidgets:t})}))},n.setSelectedType=function(e){e&&n.setState({selectedTypes:e})},n.setHasErrorDss=function(e){return n.setState({hasErrorSelectedDss:e})},n.getRootDss=function(){var e=s.DataSourceManager.getInstance().getWidgetGeneratedDataSources();return Object.keys(e).forEach((function(t){e[t]=e[t].filter((function(e){return e&&e.id&&e.getDataSourceJson()}))})),e},n.getToUseWidgets=function(e,t){return s.appConfigUtils.getAllWidgets(s.getAppStore().getState().appStateInBuilder.appConfig).filter((function(a){return e[a.id]||n.getRootDss()[a.id]&&n.getRootDss()[a.id].some((function(e){return!!t[e.id]}))}))},n.getToUseRootDss=function(e,t,a,o){var s={};if(t)return s;var r=n.getRootDss();return Object.keys(r).forEach((function(t){var n=r[t].filter((function(t){return t&&t.getDataSourceJson()&&c.getWhetherUseDataSource(t.getDataSourceJson(),e)&&d.isFuzzySearch(t.getLabel(),o)&&d.isFuzzyFromDsIds(t.getDataSourceJson(),a)}));n&&n.length>0&&(s[t]||(s[t]=[]),s[t]=s[t].concat(n))})),Object.keys(s).forEach((function(e){0===s[e].length&&delete s[e]})),s},n.getToUseChildDss=function(e,t,a,o){var r=[];if(t)r=t.asMutable().map((function(e){return s.DataSourceManager.getInstance().getDataSource(e)}));else{var i=n.getRootDss();Object.keys(i).forEach((function(e){r=r.concat(i[e])}))}return c.getToUseChildDss(r,e).then((function(e){var t={};return Object.keys(e).forEach((function(n){e[n].some((function(e){return d.isFuzzySearch(e.getLabel(),o)&&d.isFuzzyFromDsIds(e.getDataSourceJson(),a)}))&&(t[n]=e[n].filter((function(e){return d.isFuzzySearch(e.getLabel(),o)&&d.isFuzzyFromDsIds(e.getDataSourceJson(),a)})))})),t}))},n.getToUseChildDssByWidgetId=function(e){var t={};return n.getRootDss()[e].forEach((function(e){t[e.id]||(t[e.id]=[]),t[e.id]=n.state.toUseChildDss[e.id]?t[e.id].concat(n.state.toUseChildDss[e.id]):t[e.id]})),Object.keys(t).forEach((function(e){0===t[e].length&&delete t[e]})),t},n.getWhetherShowList=function(){return n.getWhetherShowRootDss()||n.getWhetherShowChildDss()||!(!n.state.hasErrorSelectedDss||!n.props.useDataSources)},n.getWhetherShowRootDss=function(){return n.state.toUseRootDss&&Object.keys(n.state.toUseRootDss).length>0},n.getWhetherShowChildDss=function(){return n.state.toUseChildDss&&Object.keys(n.state.toUseChildDss).length>0},n.state={toUseRootDss:null,toUseChildDss:null,toUseWidgets:null,selectedTypes:null,hasErrorSelectedDss:!0},n}return o(t,e),t.prototype.componentDidMount=function(){this.__unmount=!1,this.props.isDataSourceInited&&this.initData()},t.prototype.componentDidUpdate=function(e,t){this.props.isDataSourceInited&&(t.selectedTypes===this.state.selectedTypes&&e.fromRootDsIds===this.props.fromRootDsIds&&e.fromDsIds===this.props.fromDsIds||(this.state.selectedTypes?this.setToUseDataSources(this.state.selectedTypes,this.props.fromRootDsIds,this.props.fromDsIds,this.props.searchValue):this.setToUseDataSources(this.props.types,this.props.fromRootDsIds,this.props.fromDsIds,this.props.searchValue)),e.types===this.props.types&&!1!==e.isDataSourceInited&&e.dataSources===this.props.dataSources||this.initData())},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t,n=this;if(!this.state.toUseChildDss||!this.state.toUseRootDss||!this.state.toUseWidgets)return null;var a=c.getOutputTypes(this.props.types);return s.React.createElement("div",{className:"ds-widget-outputs h-100 w-100"},a&&a.length>0?s.React.createElement("div",{className:"pt-3 h-100"},this.props.hideTypeDropdown?null:s.React.createElement("div",{className:"ds-types"},s.React.createElement(l.default,{toUseTypes:a,onTypeSelected:this.setSelectedType,selectedTypes:this.state.selectedTypes,intl:this.props.intl})),this.getWhetherShowList()?this.state.toUseWidgets.map((function(e){return s.React.createElement("div",{key:null==e?void 0:e.id,className:"mb-3"},s.React.createElement("div",{className:"w-100 px-3 pb-2 text-truncate",title:null==e?void 0:e.label},null==e?void 0:e.label),s.React.createElement(i.default,{rootDss:c.getAllToUseRootDss(n.state.toUseRootDss[e.id],n.getToUseChildDssByWidgetId(e.id)),useDataSources:n.props.useDataSources,allToUseDss:c.getAllToUseDss(n.state.toUseRootDss[e.id],n.getToUseChildDssByWidgetId(e.id)),onChange:n.props.onChange,isMultiple:n.props.isMultiple,showErrorDss:!0,disableSelection:n.props.disableSelection,disableRemove:n.props.disableRemove,intl:n.props.intl,changeHasErrorSelectedDss:n.setHasErrorDss,widgetId:n.props.widgetId}))})):s.React.createElement("div",null,(null===(t=null===(e=s.getAppStore().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)&&this.props.isDataSourceInited&&s.React.createElement("div",{className:"empty-placeholder w-100"},s.React.createElement("div",{className:"empty-placeholder-icon"},s.React.createElement(r.Icon,{icon:u,width:80,height:71})),s.React.createElement("div",{className:"empty-placeholder-text",dangerouslySetInnerHTML:{__html:this.props.intl.formatMessage({id:"noWidgetOutputCanBeUsed",defaultMessage:r.defaultMessages.noWidgetOutputCanBeUsed})+"<br/>"+this.props.intl.formatMessage({id:"pleaseAddData",defaultMessage:r.defaultMessages.pleaseAddData})}})))):this.props.intl.formatMessage({id:"noSelectedType",defaultMessage:r.defaultMessages.noSelectedType}))},t}(s.React.PureComponent);t.default=p},1082:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(59),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getWhetherSelected=function(){return t.props.useDataSources&&t.props.useDataSources.some((function(e){return((null==e?void 0:e.mainDataSourceId)||(null==e?void 0:e.dataSourceId))===t.props.dsId}))},t.getUseDs=function(){return{dataSourceId:t.props.dsId,mainDataSourceId:t.props.dsId}},t.onItemClick=function(){if(t.getWhetherSelected()){if(t.props.disableRemove)return;t.onDsRemoved(t.getUseDs())}else{if(t.props.disableSelection)return;t.onDsSelected(t.getUseDs())}},t.onDsSelected=function(e){var n;e&&(n=t.props.useDataSources&&t.props.isMultiple?t.props.useDataSources.asMutable({deep:!0}).concat(e):[e],t.props.onChange&&t.props.onChange(n))},t.onDsRemoved=function(e){if(e&&t.props.useDataSources){var n=t.props.useDataSources.filter((function(t){return(null==t?void 0:t.dataSourceId)!==e.dataSourceId}));t.props.onChange&&t.props.onChange(n.asMutable({deep:!0}))}},t}return o(t,e),t.prototype.render=function(){var e;if(!this.props.dsId)return null;var t=this.getWhetherSelected(),n=s.getAppStore()&&s.getAppStore().getState(),a=n&&n.appStateInBuilder&&n.appStateInBuilder.appConfig&&n.appStateInBuilder.appConfig.dataSources,o=a&&a[this.props.dsId];return s.React.createElement("div",{onClick:this.onItemClick,className:s.classNames("ds-item ds-error-item",(e={"ds-item-selected":t},e[this.props.className]=!!this.props.className,e))},s.React.createElement("div",{className:"d-flex align-items-center w-100 item"},s.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},s.React.createElement(r.Icon,{icon:i.getDsIcon(o),className:"text-dark",size:"12"})),s.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},s.React.createElement("div",{className:"text-truncate ds-type-name",title:this.props.dsId},this.props.dsId))))},t}(s.React.PureComponent);t.default=l},1083:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(1084),l=n(561),c=n(235),d=function(e){function t(t){var n=e.call(this,t)||this;return n.renderDsItem=function(e){return s.React.createElement(i.default,{useDataSources:n.props.useDataSources,ds:e,widgetId:n.props.widgetId,key:e.id,onChange:n.props.onChange,isMultiple:n.props.isMultiple,intl:n.props.intl,disableSelection:n.props.disableSelection,disableRemove:n.props.disableRemove,className:"w-100"})},n.renderDsLabel=function(e){return s.React.createElement("div",{className:"d-flex w-100"},s.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},s.React.createElement(r.Icon,{icon:c,className:"text-dark",size:"12"})),s.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},s.React.createElement("div",{className:"text-truncate ds-type-name",title:e},e)))},n.getChildDataSources=function(e){return(null==e?void 0:e.isDataSourceSet)?e.getChildDataSources():[]},n.getLabel=function(e){return(null==e?void 0:e.getLabel())||(null==e?void 0:e.id)},n.state={inAllToUseDss:function(e){return n.props.allToUseDss.some((function(t){return t.id===e.id}))}},n}return o(t,e),t.prototype.componentDidUpdate=function(e){var t=this;e.allToUseDss!==this.props.allToUseDss&&this.setState({inAllToUseDss:function(e){return t.props.allToUseDss.some((function(t){return t.id===e.id}))}})},t.prototype.render=function(){return this.props.ds?s.React.createElement("div",{className:"mb-3"},s.React.createElement(l.DataSourceTree,{dataSource:this.props.ds,isNodeSelectable:this.state.inAllToUseDss,renderSelectableNode:this.renderDsItem,renderUnselectableNode:this.renderDsLabel,useDefaultBackground:!0,getChildDataSources:this.getChildDataSources,getLabel:this.getLabel})):null},t}(s.React.PureComponent);t.default=d},1084:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(39),l=n(59),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getWhetherSelected=function(){return t.props.useDataSources&&t.props.useDataSources.some((function(e){return((null==e?void 0:e.mainDataSourceId)||(null==e?void 0:e.dataSourceId))===t.props.ds.id}))},t.getParentWidget=function(e){var t,n,a=null===(n=null===(t=s.getAppStore().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===n?void 0:n.appConfig;if(!a||!e)return null;var o=a.widgets||{},r=Object.values(o).filter((function(e){var t;return e.useDataSources&&e.layouts&&(null===(t=e.manifest.properties)||void 0===t?void 0:t.passDataSourceToChildren)}));if(0===r.length)return null;var l=[];return r.find((function(t){return(l=i.searchUtils.getChildrenWidgetsOrSections(a,t.id,s.LayoutItemType.Widget,!0))&&l.some((function(t){return t.id===e}))}))||null},t.getUseDsWithoutFields=function(e){if(!e)return null;var t={};Object.keys(e).forEach((function(n){"fields"!==n&&(t[n]=e[n])}))},t.getUseDs=function(){var e={dataSourceId:t.props.ds.id,mainDataSourceId:t.props.ds.id},n=t.getParentWidget(t.props.widgetId),a=((null==n?void 0:n.useDataSources)||[]).find((function(t){var n=s.DataSourceManager.getInstance().getDataSource(t.dataSourceId),a=n&&n.getMainDataSource();return a&&a.id===e.mainDataSourceId}));if(a)e=t.getUseDsWithoutFields(a);else{var o=t.props.ds.getRootDataSource&&t.props.ds.getRootDataSource();o&&(e.rootDataSourceId=o.id)}return e},t.getDsLabel=function(e){return e?e.getLabel()||e.id:""},t.onItemClick=function(e){if(t.getWhetherSelected()){if(t.props.disableRemove)return;t.onDsRemoved(t.getUseDs())}else{if(t.props.disableSelection)return;t.onDsSelected(t.getUseDs())}},t.onDsSelected=function(e){var n;e&&(n=t.props.useDataSources&&t.props.isMultiple?t.props.useDataSources.asMutable({deep:!0}).concat(e):[e],t.props.onChange&&t.props.onChange(n))},t.onDsRemoved=function(e){if(e&&t.props.useDataSources){var n=t.props.useDataSources.filter((function(t){return(null==t?void 0:t.dataSourceId)!==e.dataSourceId}));t.props.onChange&&t.props.onChange(n.asMutable({deep:!0}))}},t}return o(t,e),t.prototype.render=function(){var e;if(!this.props.ds||!this.props.ds.getDataSourceJson())return null;var t=this.getWhetherSelected();return s.React.createElement("div",{onClick:this.onItemClick,className:s.classNames("ds-item",(e={"ds-item-selected":t},e[this.props.className]=!!this.props.className,e))},s.React.createElement("div",{className:"d-flex align-items-center w-100 item"},s.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},s.React.createElement(r.Icon,{icon:l.getDsIcon(this.props.ds.getDataSourceJson()),className:"text-dark",size:"12"})),s.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},s.React.createElement("div",{className:"text-truncate ds-type-name",title:this.getDsLabel(this.props.ds)},this.getDsLabel(this.props.ds)))))},t}(s.React.PureComponent);t.default=c},1085:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(562),l=n(563),c=n(391),d=n(59),u=n(238),p=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.initData=function(){n.setSelectedType(null),n.setToUseDataSources(n.props.types,n.props.fromRootDsIds,n.props.fromDsIds,n.props.searchValue)},n.setHasErrorDss=function(e){return n.setState({hasErrorSelectedDss:e})},n.setToUseDataSources=function(e,t,a,o){var s=n.getToUseRootDss(e,t,a,o);n.getToUseChildDss(e,t,a,o).then((function(e){n.__unmount||n.setState({toUseRootDss:s,toUseChildDss:e})}))},n.setSelectedType=function(e){n.setState({selectedTypes:e})},n.getRootDss=function(){return s.DataSourceManager.getInstance().getConfiguredDataSources().filter((function(e){return e&&e.id&&e.getDataSourceJson()&&!e.parentDataSource}))},n.getToUseRootDss=function(e,t,a,o){return t?[]:s.DataSourceManager.getInstance().getConfiguredDataSources().filter((function(t){return!t.parentDataSource&&!t.isDataView&&!t.isLocal&&!t.getDataSourceJson().isHidden&&c.getWhetherUseDataSource(t.getDataSourceJson(),e)&&d.isFuzzySearch(t.getLabel(),o)&&d.isFuzzyFromDsIds(t.getDataSourceJson(),a)&&n.props.dataSources&&n.props.dataSources[null==t?void 0:t.id]}))},n.getToUseChildDss=function(e,t,a,o){var r;return r=t?t.asMutable().map((function(e){return s.DataSourceManager.getInstance().getDataSource(e)})):n.getRootDss(),c.getToUseChildDss(r,e).then((function(e){var t={};return Object.keys(e).forEach((function(n){e[n].some((function(e){var t;return!e.isDataView&&!e.isLocal&&!(null===(t=e.getDataSourceJson())||void 0===t?void 0:t.isHidden)&&d.isFuzzySearch(e.getLabel(),o)&&d.isFuzzyFromDsIds(e.getDataSourceJson(),a)}))&&(t[n]=e[n].filter((function(e){var t;return!e.isDataView&&!e.isLocal&&!(null===(t=e.getDataSourceJson())||void 0===t?void 0:t.isHidden)&&d.isFuzzySearch(e.getLabel(),o)&&d.isFuzzyFromDsIds(e.getDataSourceJson(),a)})))})),t}))},n.getWhetherShowList=function(){return n.getWhetherShowRootDss()||n.getWhetherShowChildDss()||!(!n.state.hasErrorSelectedDss||!n.props.useDataSources)},n.getWhetherShowRootDss=function(){return n.state.toUseRootDss&&n.state.toUseRootDss.length>0},n.getWhetherShowChildDss=function(){return n.state.toUseChildDss&&Object.keys(n.state.toUseChildDss).length>0},n.state={selectedTypes:null,toUseRootDss:null,toUseChildDss:null,hasErrorSelectedDss:!0},n}return o(t,e),t.prototype.componentDidMount=function(){this.__unmount=!1,this.props.isDataSourceInited&&this.initData()},t.prototype.componentDidUpdate=function(e,t){this.props.isDataSourceInited&&(t.selectedTypes===this.state.selectedTypes&&e.fromRootDsIds===this.props.fromRootDsIds&&e.fromDsIds===this.props.fromDsIds&&e.searchValue===this.props.searchValue&&e.dataSources===this.props.dataSources||(this.state.selectedTypes?this.setToUseDataSources(this.state.selectedTypes,this.props.fromRootDsIds,this.props.fromDsIds,this.props.searchValue):this.setToUseDataSources(this.props.types,this.props.fromRootDsIds,this.props.fromDsIds,this.props.searchValue)),e.types===this.props.types&&!1!==e.isDataSourceInited&&e.dataSources===this.props.dataSources||this.initData())},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t,n=c.getAddedDataTypes(this.props.types);return s.React.createElement("div",{className:"ds-added-data h-100 w-100"},n&&n.length>0?s.React.createElement("div",{className:"pt-3 h-100"},!this.props.hideTypeDropdown&&s.React.createElement("div",{className:"ds-types"},s.React.createElement(l.default,{toUseTypes:n,onTypeSelected:this.setSelectedType,selectedTypes:this.state.selectedTypes,intl:this.props.intl})),this.getWhetherShowList()?s.React.createElement(i.default,{rootDss:c.getAllToUseRootDss(this.state.toUseRootDss,this.state.toUseChildDss),allToUseDss:c.getAllToUseDss(this.state.toUseRootDss,this.state.toUseChildDss),onChange:this.props.onChange,isMultiple:this.props.isMultiple,changeHasErrorSelectedDss:this.setHasErrorDss,useDataSources:this.props.useDataSources,showErrorDss:!0,disableRemove:this.props.disableRemove,disableSelection:this.props.disableSelection,intl:this.props.intl,widgetId:this.props.widgetId}):s.React.createElement("div",null,(null===(t=null===(e=s.getAppStore().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)&&this.props.isDataSourceInited&&s.React.createElement("div",{className:"empty-placeholder w-100"},s.React.createElement("div",{className:"empty-placeholder-icon"},s.React.createElement(r.Icon,{icon:u,width:80,height:71})),s.React.createElement("div",{className:"empty-placeholder-text",dangerouslySetInnerHTML:{__html:this.props.intl.formatMessage({id:"noAddedDataSourceCanBeUsed",defaultMessage:r.defaultMessages.noAddedDataSourceCanBeUsed})+"<br/>"+this.props.intl.formatMessage({id:"pleaseAddData",defaultMessage:r.defaultMessages.pleaseAddData})}})))):this.props.intl.formatMessage({id:"noSelectedType",defaultMessage:r.defaultMessages.noSelectedType}))},t}(s.React.PureComponent);t.default=p},1086:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(59),l=n(564),c=n(37),d=n(143),u=n(182),p=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.onRemove=function(e){var t=n.props.onRemove;t&&t(n.props.mainDataSourceId)},n.onDataViewChange=function(e){var t=e.target.value;if(t&&"create_a_view"!==t){var a=n.getAllDataViews()[t],o=s.Immutable([a.asMutable({deep:!0})]);n.props.onChange(n.props.mainDataSourceId,o)}},n.onMultiDataViewChange=function(e,t){if(t&&"create_a_view"!==t){var a=n.getAllDataViews()[t],o=n.props.dataViews||s.Immutable([]),r=n.props.dataViews&&n.props.dataViews.find((function(e){return e.id===a.id}))?o.filter((function(e){return e.id!==a.id})):o.concat(a);n.props.onChange(n.props.mainDataSourceId,r)}},n.formatMessage=function(e,t){var a=Object.assign({},r.defaultMessages);return n.props.intl.formatMessage({id:e,defaultMessage:a[e]},t)},n.getDsLabel=function(e){var t=s.DataSourceManager.getInstance(),a=e&&t.getDataSource(e);return a&&a.getLabel()||n.formatMessage("none")},n.getWhetherItemError=function(e){var t=s.DataSourceManager.getInstance();return!(e&&t.getDataSource(e))},n.getAllDataViews=function(){if(!n.props.mainDataSourceId)return null;var e=s.DataSourceManager.getInstance().getDataSource(n.props.mainDataSourceId),t=e&&e.getDataSourceJson(),a=t&&t.dataViews;return a&&(a=a.set(n.props.DefaultDataView.id,t.query?t.query.merge(n.props.DefaultDataView.asMutable({deep:!0})):n.props.DefaultDataView).without(s.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION)),a},n.getMultiSelectItems=function(e){if(!n.props.mainDataSourceId)return s.Immutable([]);var t=[];return e&&Object.keys(e).forEach((function(a){t.push({value:a,label:e[a].label,render:function(t){return s.jsx("div",{className:"d-flex w-100 align-items-center justify-content-between"},s.jsx("div",{className:"d-flex align-items-center"},s.jsx(r.Checkbox,{checked:n.props.dataViews&&n.props.dataViews.map((function(e){return e.id})).indexOf(t.value)>-1}),s.jsx("span",{className:"ml-2"},e[a].label)),s.jsx("div",{className:"px-2",onClick:function(t){return n.onDataViewClick(t,e[a])},title:n.props.intl.formatMessage({id:"settings",defaultMessage:r.defaultMessages.settings})},s.jsx(r.Icon,{icon:u,size:12})))}})})),t.push({value:"create_a_view",render:function(){return n.getCreateViewButton()}}),s.Immutable(t)},n.getCreateViewButton=function(){return s.jsx("div",{onClick:n.onCreateViewClick,className:"create-view-button"},s.jsx(r.Icon,{icon:d,size:12,className:"create-view-icon"}),s.jsx("span",{className:"ml-2"},n.formatMessage("createAView")))},n.getSelectedValueForSingleSelect=function(){var e;return n.props.dataViews&&n.props.dataViews.length>0?null===(e=n.props.dataViews[0])||void 0===e?void 0:e.id:n.props.DefaultDataView.id},n.getMultiSelectSelectedString=function(e){if(e)return n.formatMessage("numSelected",{number:e.length})},n.onDataViewClick=function(e,t){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.setState({settingDataView:t}),n.toggleViewSetting()},n.onCreateViewClick=function(){n.setState({settingDataView:null}),n.toggleViewSetting()},n.toggleViewSetting=function(){return n.setState({isViewSettingOpen:!n.state.isViewSettingOpen})},n.toggleViewSelect=function(){return n.setState({isViewSelectOpen:!n.state.isViewSelectOpen})},n.stopPropagation=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.onDataViewSettingApply=function(e){n.toggleViewSetting(),e.id===n.props.DefaultDataView.id?n.editQuery(e):n.editDataView(e)},n.editQuery=function(e){if(e){var t=n.state.getAppConfigAction;if(t){var a=s.DataSourceManager.getInstance().getDataSource(n.props.mainDataSourceId),o=a&&a.getDataSourceJson();if(o){var r=i.editDataSourceJson(o.setIn(["query"],(null==o?void 0:o.query)?o.query.merge(e.without("id").without("label").asMutable({deep:!0})):e.set("id","default").set("label",a.getLabel())));t().editDataSource(r).exec()}}}},n.editDataView=function(e){if(e){var t=n.state.getAppConfigAction;if(t){var a=s.DataSourceManager.getInstance().getDataSource(n.props.mainDataSourceId),o=a&&a.getDataSourceJson(),r=o.dataViews||s.Immutable({});r=r.set(e.id,e);var l=i.editDataSourceJson(o.setIn(["dataViews"],r));t().editDataSource(l).exec(),n.setState({settingDataView:e})}}},n.state={isViewSettingOpen:!1,isViewSelectOpen:!1,settingDataView:null,getAppConfigAction:null},n}return o(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,s.moduleLoader.loadModule("jimu-for-builder").then((function(t){e.__unmount||e.setState({getAppConfigAction:t.getAppConfigAction})}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t,n,a=this,o=this.props.mainDataSourceId;if(!o)return null;var d=s.DataSourceManager.getInstance().getDataSource(o),p=d&&d.getDataSourceJson(),h=this.getAllDataViews(),m=s.jsx(r.Button,{icon:!0,size:"sm",type:"tertiary",title:this.formatMessage("remove"),onClick:this.onRemove,className:"ds-item-close"},s.jsx(r.Icon,{icon:c,size:"12"})),f=(null==p?void 0:p.type)===s.DataSourceTypes.FeatureLayer;return s.jsx("div",{className:this.props.className?"w-100 "+this.props.className:"w-100"},p&&s.jsx("div",{className:s.classNames("ds-item",{"ds-error-item":this.getWhetherItemError(o),"disable-cursor":this.props.disableDataSourceList}),onClick:this.props.onClick},s.jsx("div",{className:"d-flex align-items-center w-100 item"},s.jsx("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},s.jsx(r.Icon,{icon:i.getDsIcon(p),className:"text-dark",size:"12"})),s.jsx("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},s.jsx("div",{className:"text-truncate ds-type-name",title:this.getDsLabel(o)},this.getDsLabel(o))),!this.props.hideRemove&&m),!this.props.hideDataView&&h&&Object.keys(h).length>0&&s.jsx("div",{className:"dv-select-container"},this.props.isMultiple?s.jsx(r.MultiSelect,{fluid:!0,items:this.getMultiSelectItems(h),onClickItem:this.onMultiDataViewChange,values:this.props.dataViews&&this.props.dataViews.map((function(e){return e.id})),buttonProps:{disabled:this.props.disableDataView},displayByValues:this.getMultiSelectSelectedString}):s.jsx(r.Select,{value:this.getSelectedValueForSingleSelect(),onChange:this.onDataViewChange,onClick:this.stopPropagation,isOpen:this.state.isViewSelectOpen,toggle:this.toggleViewSelect,disabled:this.props.disableDataView},Object.values(h).map((function(e,t){return s.jsx("option",{value:e.id,key:t},s.jsx("div",{className:"d-flex justify-content-between align-items-center w-100"},s.jsx("div",null,e.label),a.state.isViewSelectOpen&&s.jsx("div",{className:"px-2 settings-icon",onClick:function(t){return a.onDataViewClick(t,e)},title:a.props.intl.formatMessage({id:"settings",defaultMessage:r.defaultMessages.settings})},s.jsx(r.Icon,{icon:u,size:12}))))})),s.jsx("option",{value:"create_a_view"},this.getCreateViewButton())))),f&&s.jsx(l.DataViewSettingPopup,{isOpen:this.state.isViewSettingOpen,toggle:this.toggleViewSetting,onApply:this.onDataViewSettingApply,onDuplicate:this.onDataViewSettingApply,mainDataSource:d,dataView:this.state.settingDataView,disableDuplicate:!this.state.settingDataView||(null===(e=this.state.settingDataView)||void 0===e?void 0:e.id)===this.props.DefaultDataView.id,disableRemove:!this.state.settingDataView||(null===(t=this.state.settingDataView)||void 0===t?void 0:t.id)===this.props.DefaultDataView.id,disableRename:!this.state.settingDataView||(null===(n=this.state.settingDataView)||void 0===n?void 0:n.id)===this.props.DefaultDataView.id}))},t}(s.React.PureComponent);t.default=p},1087:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(566),l=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.render=function(){var e;return this.props.dataSourceJson?r.jsx("div",{className:r.classNames((e={},e[this.props.className]=!!this.props.className,e))},r.jsx("div",{className:"component-data-source-error-item"},r.jsx(i.DataSourceItem,s({},this.props)))):null},t}(r.React.PureComponent);t.DataSourceErrorItem=r.themeUtils.withStyles(l,"DataSourceErrorItem")},1088:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),l=n(1089),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){var e=this.props,t=e.useDataSources,n=e.dataSources,a=r(e,["useDataSources","dataSources"]);return n?i.React.createElement(l.FieldSelectorInner,s({},this.props)):1===(null==t?void 0:t.length)?i.React.createElement(i.DataSourceComponent,{useDataSource:t[0]},(function(e,t){return i.React.createElement(l.FieldSelectorInner,s({},a,{dataSources:[e]}))})):i.React.createElement(i.MultipleDataSourceComponent,{useDataSources:t},(function(e,t){return i.React.createElement(l.FieldSelectorInner,s({},a,{dataSources:e&&Object.values(e)}))}))},t}(i.React.PureComponent);t.FieldSelector=c},1089:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(1090),l=n(1091),c=n(1092),d=n(567),u=n(139),p=function(e){function t(t){var n=e.call(this,t)||this;return n.getWhetherArrayIsShallowEqual=function(e,t){var n=!1;return e&&t&&e.length===t.length&&(n=!e.some((function(e,n){return e!==t[n]}))),n},n.getDefaultSelectedDs=function(e,t){return n.hasSelectedFields()||n.props.isDataSourceDropDownHidden?n.getDsFromSelectedFieldsAndUseDss(n.props.dataSources,n.props.selectedFields):null},n.hasSelectedFields=function(){return!!n.props.selectedFields&&(Array.isArray(n.props.selectedFields)?n.props.selectedFields.length>0:"object"==typeof n.props.selectedFields&&Object.values(n.props.selectedFields).every((function(e){return e&&e.length>0})))},n.getDsFromSelectedFieldsAndUseDss=function(e,t){var a;if(t&&e)if(n.getAreFromMultipleDss(e,t)){var o=Object.keys(n.props.selectedFields)[0];if(o.split("-").reverse()[0]===s.CONSTANTS.SELECTION_DATA_VIEW_ID){var r=s.DataSourceManager.getInstance().getDataSource(o),i=r&&r.getMainDataSource(),l=i&&i.id;a=n.props.dataSources.some((function(e){return e&&e.getMainDataSource().id===l}))?r:null}else a=n.props.dataSources.find((function(e){return e&&e.id===o}))}else a=e[0];else e&&(a=e[0]);return a},n.getAreFromMultipleDss=function(e,t){return t?!Array.isArray(t):(null==e?void 0:e.length)>1},n.getDsLabel=function(e){return e&&e.getDataSourceJson()&&(e.getLabel()||e.id)||""},n.getSelectedFields=function(e,t,a,o){if(!e||!e.id||!a)return s.Immutable([]);var r=n.getAreFromMultipleDss(t,a)?s.Immutable(a[e.id]):a;return r?o?r:r.slice(0,1):s.Immutable([])},n.getSelectedUseDataSource=function(){return n.state.selectedDs?n.getUseDataSources([n.state.selectedDs])[0]:null},n.getWhetherJimuNameIsInHiddenFields=function(e){var t,a=!1;if(n.props.hiddenFields){var o=n.getAreFromMultipleDss(n.props.dataSources,n.props.selectedFields);s.Immutable([]);a=(o?n.props.hiddenFields[null===(t=n.state.selectedDs)||void 0===t?void 0:t.id]:n.props.hiddenFields).some((function(t){return t===e}))}return a},n.getFieldsFromSchema=function(e){if(!e||!e.fields)return null;if(n.props.types||n.props.hiddenFields||n.state.searchValue){var t,a,o=s.Immutable({});return Object.keys(e.fields).forEach((function(s){t=e.fields[s].type,a=e.fields[s].alias||e.fields[s].name;var r=!n.props.types||t&&n.props.types&&n.props.types.some((function(e){return e===t})),i=n.getWhetherJimuNameIsInHiddenFields(s),l=!n.state.searchValue||n.state.searchValue&&a&&a.toLowerCase().indexOf(n.state.searchValue.toLowerCase())>-1;r&&!i&&l&&(o=o.setIn([s],e.fields[s]))})),o}return e.fields},n.getUseDataSources=function(e){if(!e)return null;var t=s.Immutable([]);return e.forEach((function(e){var n;e&&(t=t.concat({dataSourceId:e.id,mainDataSourceId:e.getMainDataSource().id,dataViewId:e.dataViewId,rootDataSourceId:null===(n=e.getRootDataSource())||void 0===n?void 0:n.id}))})),t},n.onSelectedUseDsChange=function(e,t){var a=s.DataSourceManager.getInstance().getDataSource(e.dataSourceId);if(n.setState({selectedDs:a}),n.hasSelectedFields()){var o=n.getSelectedFields(n.state.selectedDs,n.props.dataSources,n.props.selectedFields,n.props.isMultiple).map((function(e){var t;return a&&(null===(t=a.getSchema())||void 0===t?void 0:t.fields[e])})).filter((function(e){return!!e}));n.props.onChange&&n.props.onChange(o.asMutable(),a,t)}n.setState({selectedDs:a,isFromRepeatedDs:t})},n.onSearchChange=function(e){n.setState({searchValue:e.target.value})},n.onFieldClick=function(e){n.onSelectedFieldsChange(e,n.state.selectedDs,n.props.dataSources,n.props.selectedFields,n.state.isFromRepeatedDs,n.props.isMultiple)},n.onSelectedFieldsChange=function(e,t,a,o,s,r){var i,l=t&&t.getSchema(),c=n.getSelectedFields(t,a,o,r),d=n.getFieldsFromSchema(l);c&&c.some((function(t){return t===e.jimuName}))?n.props.isMultiple?(i=c.filter((function(t){return t!==e.jimuName})).map((function(e){return d[e]})),n.props.onChange&&n.props.onChange(i,t,s)):n.props.onChange&&n.props.onChange([],t,s):r?(i=c?c.map((function(e){return d[e]})).concat(e):[e],n.props.onChange&&n.props.onChange(i,t,s)):n.props.onChange&&n.props.onChange([e],t,s)},n.state={selectedDs:n.getDefaultSelectedDs(n.props.dataSources,n.props.selectedFields),searchValue:"",isFromRepeatedDs:!!n.props.isSelectedFromRepeatedDataSourceContext},n}return o(t,e),t.prototype.componentDidMount=function(){this.props.getDefaultField&&this.props.getDefaultField(this.getDefaultFieldFromDs(this.props.dataSources,this.props.selectedFields))},t.prototype.componentDidUpdate=function(e,t){this.getWhetherArrayIsShallowEqual(this.props.dataSources,e.dataSources)&&this.props.selectedFields===e.selectedFields||this.setState({selectedDs:this.getDefaultSelectedDs(this.props.dataSources,this.props.selectedFields)}),this.getWhetherArrayIsShallowEqual(this.props.dataSources,e.dataSources)||this.props.getDefaultField&&this.props.getDefaultField(this.getDefaultFieldFromDs(this.props.dataSources,this.props.selectedFields)),e.isSelectedFromRepeatedDataSourceContext!==this.props.isSelectedFromRepeatedDataSourceContext&&this.setState({isFromRepeatedDs:!!this.props.isSelectedFromRepeatedDataSourceContext})},t.prototype.getDefaultFieldFromDs=function(e,t){var n,a=this;if(this.getAreFromMultipleDss(e,t))n={},e.forEach((function(e){n[e.id]=a.getOneDefaultFieldFromDs(e)}));else{var o=e[0];n=this.getOneDefaultFieldFromDs(o)}return n},t.prototype.getOneDefaultFieldFromDs=function(e){if(e&&e.getSchema){var t=this.getFieldsFromSchema(e.getSchema()),n=t&&Object.keys(t)[0];return t&&n?t[n]:null}return null},t.prototype.render=function(){var e,t,n,a;return this.props.dataSources&&0!==this.props.dataSources.filter((function(e){return!!e})).length?s.jsx("div",{style:this.props.style,className:s.classNames("w-100 h-100",(e={},e[this.props.className]=!!this.props.className,e))},s.jsx("div",{className:"component-field-selector w-100 h-100"},this.props.isDataSourceDropDownHidden?null:s.jsx("div",{className:"ds-name p-3 d-flex justify-content-between align-items-center"},s.jsx(d.MainDataAndViewSelector,{widgetId:this.props.widgetId,useDataSources:this.getUseDataSources(this.props.dataSources),onChange:this.onSelectedUseDsChange,useSelectionDataView:this.props.useSelectionDataView,usePopulatedDataView:this.props.usePopulatedDataView,selectedUseDataSource:this.getSelectedUseDataSource(),isSelectedFromRepeatedDataSourceContext:this.state.isFromRepeatedDs})),this.props.isSearchInputHidden?null:s.jsx("div",{className:"d-inline-block w-100 px-3 mb-3 item-selector-search"},s.jsx(r.Icon,{icon:u,className:"search-icon",color:this.props.theme.colors.dark}),s.jsx(r.TextInput,{placeholder:this.props.intl.formatMessage({id:"search",defaultMessage:s.defaultMessages.search}),onChange:this.onSearchChange,className:"d-inline-block search-input",value:this.state.searchValue})),this.props.useDropdown?s.jsx("div",null,this.props.isMultiple?s.jsx(c.default,{placeHolder:this.props.placeHolder,ds:this.state.selectedDs,fields:this.getFieldsFromSchema(null===(a=this.state.selectedDs)||void 0===a?void 0:a.getSchema()),selectedFields:this.getSelectedFields(this.state.selectedDs,this.props.dataSources,this.props.selectedFields,this.props.isMultiple),onFieldClick:this.onFieldClick,theme:this.props.theme,dropdownProps:this.props.dropdownProps}):s.jsx(l.default,{placeHolder:this.props.placeHolder,ds:this.state.selectedDs,fields:this.getFieldsFromSchema(null===(n=this.state.selectedDs)||void 0===n?void 0:n.getSchema()),selectedFields:this.getSelectedFields(this.state.selectedDs,this.props.dataSources,this.props.selectedFields,this.props.isMultiple),onFieldClick:this.onFieldClick,theme:this.props.theme,dropdownProps:this.props.dropdownProps})):s.jsx(i.default,{ds:this.state.selectedDs,fields:this.getFieldsFromSchema(null===(t=this.state.selectedDs)||void 0===t?void 0:t.getSchema()),selectedFields:this.getSelectedFields(this.state.selectedDs,this.props.dataSources,this.props.selectedFields,this.props.isMultiple),isMultiple:this.props.isMultiple,onFieldClick:this.onFieldClick,theme:this.props.theme}))):(console.warn("No data sources"),null)},t}(s.React.PureComponent);t.FieldSelectorInner=s.injectIntl(s.themeUtils.withStyles(s.themeUtils.withTheme(p),"FieldSelector"))},1090:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(399),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isOpen:!1},n}return o(t,e),t.prototype.render=function(){var e=this,t=this.props.fields;return t&&this.props.ds?s.React.createElement("div",{className:"field-list px-3"},t&&Object.keys(t).map((function(n){var a=i.getIconFromFieldType(t[n].type,e.props.theme);return s.React.createElement("div",{key:n,onClick:function(){e.props.onFieldClick(t[n])},className:s.classNames("field-item mt-2 p-1 d-flex w-100",{"field-item-selected":e.props.selectedFields&&(e.props.isMultiple?e.props.selectedFields.some((function(e){return e===n})):n===e.props.selectedFields[0])})},s.React.createElement(r.Icon,{icon:a.icon,color:a.color,className:"mr-2 flex-shrink-0",size:16}),s.React.createElement("div",{className:"flex-grow-1 text-truncate",title:t[n].alias||t[n].name},t[n].alias||t[n].name))}))):null},t}(s.React.PureComponent);t.default=l},1091:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(3),l=n(399),c=function(e){function t(t){var n=e.call(this,t)||this;return n.toggle=function(){n.setState({isOpen:!n.state.isOpen})},n.getSelectedFieldJimuName=function(){var e=n.props.fields;if(e&&n.props.selectedFields&&n.props.selectedFields[0]){var t=e[n.props.selectedFields[0]];return null==t?void 0:t.jimuName}},n.onFieldChange=function(e){n.props.onFieldClick(n.props.fields[e.currentTarget.value])},n.state={isOpen:!1},n}return o(t,e),t.prototype.render=function(){var e=this,t=this.props.fields;if(!t||!this.props.ds)return null;var n=this.props.dropdownProps||{};return r.React.createElement("div",null,r.React.createElement(i.Select,s({},n,{value:this.getSelectedFieldJimuName(),fluid:!0,isOpen:this.state.isOpen,toggle:this.toggle,className:"field-dropdown",placeholder:this.props.placeHolder,onChange:this.onFieldChange}),t&&Object.keys(t).map((function(n,a){var o=l.getIconFromFieldType(t[n].type,e.props.theme);return r.React.createElement(i.Option,{key:a,value:n},r.React.createElement(i.Icon,{icon:o.icon,color:o.color,className:"d-inline-block mr-2",size:16}),r.React.createElement("span",null,t[n].alias||t[n].name))}))))},t}(r.React.PureComponent);t.default=c},1092:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(3),l=n(399),c=function(e){function t(t){var n=e.call(this,t)||this;return n.onFieldClick=function(e,t){var a=n.props.fields[t];n.props.onFieldClick(a)},n.getMultiSelectItems=function(){if(n.props.fields){var e=[];return Object.keys(n.props.fields).forEach((function(t){e.push({value:t,label:n.props.fields[t].alias||n.props.fields[t].name,render:function(e){var a=l.getIconFromFieldType(n.props.fields[t].type,n.props.theme);return r.React.createElement("div",{className:"d-flex w-100 align-items-center"},r.React.createElement(i.Checkbox,{checked:n.props.selectedFields.indexOf(e.value)>-1}),r.React.createElement(i.Icon,{icon:a.icon,color:a.color,className:"d-inline-block mr-2 ml-2",size:16}),r.React.createElement("span",null,n.props.fields[t].alias||n.props.fields[t].name))}})})),e}return[]},n}return o(t,e),t.prototype.render=function(){if(!this.props.fields||!this.props.ds)return null;var e=this.props.dropdownProps||{};return r.React.createElement("div",null,r.React.createElement(i.MultiSelect,s({},e,{fluid:!0,items:r.Immutable(this.getMultiSelectItems()),onClickItem:this.onFieldClick,values:this.props.selectedFields,placeHolder:this.props.placeHolder})))},t}(r.React.PureComponent);t.default=c},125:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),s=n(21);t.AllDataSourceTypes=a(a({},o.DataSourceTypes),s.ArcGISDataSourceTypes)},126:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M5.47 9.521L.162 3.981a.592.592 0 010-.813.534.534 0 01.779 0L6 8.448l5.06-5.28a.534.534 0 01.779 0 .592.592 0 010 .813l-5.31 5.54a.726.726 0 01-1.058 0z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},127:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.212 9.936L2 12.27l2.333-.212L13.27 3.12 11.149 1 2.212 9.936zm-.707-.707L10.441.293a1 1 0 011.415 0l2.12 2.121a1 1 0 010 1.414l-8.935 8.937a1 1 0 01-.617.289l-2.333.212a1 1 0 01-1.087-1.087l.212-2.333a1 1 0 01.289-.617zm7.434-6.497l2.829 2.829-.707.707-2.829-2.829.707-.707zM.5 15h15a.5.5 0 010 1H.5a.5.5 0 010-1z" fill="#000" fill-rule="nonzero"></path></svg>'},139:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7 1a6 6 0 100 12A6 6 0 007 1zm0 13a7 7 0 115.621-2.828l-.222.284 3.405 3.404a.668.668 0 01-.944.944L11.456 12.4A6.974 6.974 0 017 14z" fill="#000" fill-rule="evenodd"></path></svg>'},143:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 5.5v-5a.5.5 0 011 0v5h5a.5.5 0 010 1h-5v5a.5.5 0 01-1 0v-5h-5a.5.5 0 010-1h5z" fill="#000" fill-rule="nonzero"></path></svg>'},172:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 0a.5.5 0 01.5.5V1h2a1 1 0 011 1v9a1 1 0 01-1 1H1a1 1 0 01-1-1V2a1 1 0 011-1h2V.5a.5.5 0 011 0V1h4V.5a.5.5 0 01.5-.5zM11 5H1v6h10V5zM8.5 8.5a.5.5 0 010 1h-5a.5.5 0 010-1h5zm0-2a.5.5 0 010 1h-5a.5.5 0 010-1h5zM3 2H1v2h10V2H9v.5a.5.5 0 01-1 0V2H4v.5a.5.5 0 01-1 0V2z" fill="#000" fill-rule="nonzero"></path></svg>'},181:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M5.47 3.229L.162 8.769a.592.592 0 000 .813.534.534 0 00.779 0L6 4.302l5.06 5.28a.534.534 0 00.779 0 .592.592 0 000-.813l-5.31-5.54a.726.726 0 00-1.058 0z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},182:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M7.185 0c.105 0 .195.118.232.24l.013.062.245 1.567c.294.145.588.29.85.465l.19.138 1.53-.603c.154-.05.264-.016.332.031l.036.03 1.224 2.11c.051.1.06.201-.01.302l-.05.06-1.286 1.025c.061.181.061.362.061.603 0 .181-.034.328-.052.467l-.01.136 1.409.965c.105.052.12.192.083.307l-.022.055-1.224 2.11c-.053.104-.195.163-.312.14l-.056-.019-1.53-.603a4.796 4.796 0 01-.82.494l-.22.109-.245 1.568c0 .103-.135.207-.25.234L7.246 12H4.798c-.157 0-.27-.089-.298-.19l-.253-1.619c-.293-.145-.587-.29-.85-.465l-.19-.138-1.53.603c-.153.05-.264.017-.332-.03l-.036-.03L.085 8.02c-.05-.101-.06-.202.01-.302l.051-.06 1.286-1.026c-.061-.18-.061-.362-.061-.603 0-.18.034-.328.051-.466l.01-.137-1.286-.965c-.104-.103-.164-.25-.14-.329L1.247 1.99c.102-.1.204-.16.342-.141l.087.02 1.469.603.419-.281c.135-.09.268-.17.407-.236l.214-.086.245-1.628c0-.103.135-.207.25-.234L4.738 0h2.448zm-.658 1h-1.2l-.243 1.627-.586.192a1.42 1.42 0 00-.3.154l-.503.335-.441.29-1.439-.593-.59 1.017 1.207.905v.5c0 .088-.003.147-.013.228l-.044.31a.577.577 0 00-.004.065l.005.26.005.027.223.66L1.258 8.05l.581 1.001 1.536-.604.45.356c.162.126.334.226.712.416l.618.304.23 1.476h1.274l.23-1.476.751-.371c.206-.106.342-.182.453-.258l.126-.091.451-.356 1.506.595.587-1.01-1.272-.872v-.607l.009-.117.048-.341.003-.035v-.18l-.003-.098-.004-.034-.225-.665 1.345-1.073-.581-1.002-1.535.605-.451-.355-.126-.092a5.312 5.312 0 00-.59-.326l-.614-.303L6.527 1zM6 3.75a2.25 2.25 0 110 4.5 2.25 2.25 0 010-4.5zm0 1a1.25 1.25 0 100 2.5 1.25 1.25 0 000-2.5z" fill="#000" fill-rule="nonzero"></path></svg>'},21:function(e,t){e.exports=n},231:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6 11.943l4 1.711V4.057L6 2.346v9.597zm-1 .17V2.494l-4 1.48v9.619l4-1.48zm6 1.393l4-1.48V2.407l-4 1.48v9.619zM0 15V3.307L5.75 1.18l4.528 1.937L16 1v11.693l-5.75 2.127-4.528-1.937L0 15z" fill="#000" fill-rule="nonzero"></path></svg>'},232:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 4V1.39C6.402 2.12 5.565 2.99 4.985 4H7.5zm0 3.5V5H4.512a8.13 8.13 0 00-.5 2.5H7.5zm0 3.5V8.5H4.012a8.13 8.13 0 00.5 2.5H7.5zm0 3.61V12H4.985c.58 1.01 1.417 1.88 2.515 2.61zm2.543.087A7.014 7.014 0 0013.745 12h-1.6a8.278 8.278 0 01-2.102 2.697zM11.015 12H8.5v2.61c1.098-.73 1.935-1.6 2.515-2.61zm1.974-3.5a9.328 9.328 0 01-.441 2.5h1.778c.365-.767.594-1.61.656-2.5H12.99zm-1.001 0H8.5V11h2.988a8.13 8.13 0 00.5-2.5zm.56-3.5c.254.775.401 1.609.441 2.5h1.993a6.957 6.957 0 00-.656-2.5h-1.778zm-1.06 0H8.5v2.5h3.488a8.13 8.13 0 00-.5-2.5zm-1.445-3.697c.91.78 1.611 1.68 2.102 2.697h1.6a7.014 7.014 0 00-3.702-2.697zM8.5 4h2.515c-.58-1.01-1.417-1.88-2.515-2.61V4zm-.527 12a8 8 0 11.055-16 8 8 0 01-.055 16zM5.957 1.302A7.014 7.014 0 002.255 4h1.6a8.278 8.278 0 012.102-2.697zM3.011 7.5c.04-.891.187-1.725.441-2.5H1.674a6.957 6.957 0 00-.656 2.5H3.01zm.441 3.5a9.328 9.328 0 01-.441-2.5H1.018c.062.89.291 1.733.656 2.5h1.778zm2.505 3.697A8.278 8.278 0 013.855 12h-1.6a7.014 7.014 0 003.702 2.697z" fill="#000" fill-rule="nonzero"></path></svg>'},233:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0l8 6-8 6-8-6 8-6zM1.887 6L8 10.82 14.113 6 8 1.18 1.887 6zM.563 9L8 14.775 15.437 9l.563.81L8 16 0 9.81.563 9z" fill="#000" fill-rule="nonzero"></path></svg>'},234:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="M7.25 8.201V14h5.8V8.201h-5.8zM0 14h5.8V8.201H0V14zM0 .953v5.799h5.8V.953H0zM9.9 0L5.8 4.103 9.9 8.2 14 4.103 9.9 0z" fill-rule="nonzero"></path></svg>'},235:function(e,t){e.exports='<svg viewBox="0 0 14 16" xmlns="http://www.w3.org/2000/svg"><path d="M1 5.304V6.5C1 7.692 3.615 9 7 9s6-1.308 6-2.5V5.304C11.775 6.32 9.546 7 7 7s-4.775-.68-6-1.696zM14 3.5v9c0 1.933-3.134 3.5-7 3.5s-7-1.567-7-3.5v-9C0 1.567 3.134 0 7 0s7 1.567 7 3.5zm-1 4.804C11.775 9.32 9.546 10 7 10s-4.775-.68-6-1.696V9.5C1 10.692 3.615 12 7 12s6-1.308 6-2.5V8.304zm0 3C11.775 12.32 9.546 13 7 13s-4.775-.68-6-1.696V12.5C1 13.692 3.615 15 7 15s6-1.308 6-2.5v-1.196zM7 6c3.385 0 6-1.308 6-2.5S10.385 1 7 1 1 2.308 1 3.5 3.615 6 7 6z" fill="#000" fill-rule="nonzero"></path></svg>'},236:function(e,t){e.exports='<svg viewBox="0 0 12 8" xmlns="http://www.w3.org/2000/svg"><path d="M6 5.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3zm0 1a2.5 2.5 0 110-5 2.5 2.5 0 010 5zM6 1c-2.124 0-3.714.967-4.867 3C2.286 6.033 3.876 7 6 7s3.714-.967 4.867-3C9.714 1.967 8.124 1 6 1zm0 7C3.333 8 1.333 6.667 0 4c1.333-2.667 3.333-4 6-4s4.667 1.333 6 4c-1.333 2.667-3.333 4-6 4z"></path></svg>'},237:function(e,t){e.exports='<svg viewBox="0 0 12 10" xmlns="http://www.w3.org/2000/svg"><path d="M6.62 6.366L4.635 4.379a1.5 1.5 0 001.987 1.987zm.746-.745a1.5 1.5 0 00-1.987-1.987l1.987 1.987zM3.899 3.644l-.825-.825C2.322 3.314 1.678 4.038 1.133 5 2.286 7.033 3.876 8 6 8c.702 0 1.345-.106 1.934-.32L7.356 7.1A2.5 2.5 0 013.9 3.645zm.745-.745A2.5 2.5 0 018.1 6.355l.826.826c.752-.495 1.396-1.219 1.941-2.181C9.714 2.967 8.124 2 6 2c-.702 0-1.345.106-1.934.32l.578.579zM2.354 2.1L1.155.9A.527.527 0 011.9.154l1.4 1.4C4.107 1.184 5.008 1 6 1c2.667 0 4.667 1.333 6 4-.634 1.268-1.419 2.235-2.355 2.9l1.2 1.2a.527.527 0 01-.745.746l-1.4-1.4C7.893 8.816 6.992 9 6 9 3.333 9 1.333 7.667 0 5c.634-1.268 1.419-2.235 2.355-2.9z"></path></svg>'},238:function(e,t){e.exports='<svg viewBox="0 0 80 71" xmlns="http://www.w3.org/2000/svg"><path d="M63.86 24a4 4 0 013.327 1.781l12.141 18.211a4 4 0 01.672 2.22V67a4 4 0 01-4 4H4a4 4 0 01-4-4V46.211a4 4 0 01.672-2.219l12.14-18.21A4 4 0 0116.142 24h47.718zm0 4H16.14L4.808 44.999H29a2 2 0 012 2V47c0 .687.077 1.357.223 2l-27.224-.001L4 67h72l-.001-18.001H48.777A9.03 9.03 0 0049 47a2 2 0 012-2.001h23.585L63.859 28zM31.222 49a9.003 9.003 0 0017.554 0h4.07C51.885 55.23 46.499 60 40 60c-6.5 0-11.885-4.77-12.847-11h4.07zm36.42-42.128a2.5 2.5 0 01.307 3.522l-7.07 8.426a2.5 2.5 0 01-3.83-3.214l7.07-8.426a2.5 2.5 0 013.522-.308zM15.88 7.18l7.07 8.426a2.5 2.5 0 01-3.83 3.214l-7.07-8.426a2.5 2.5 0 013.83-3.214zM40 0a2.5 2.5 0 012.5 2.5v14a2.5 2.5 0 11-5 0v-14A2.5 2.5 0 0140 0z" fill="#6A6A6A" fill-rule="evenodd"></path></svg>'},3:function(e,n){e.exports=t},37:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M7.745 7l4.1 4.1a.527.527 0 01-.745.746L7 7.746l-4.1 4.1a.527.527 0 01-.746-.746l4.1-4.1-4.1-4.1a.527.527 0 01.746-.746l4.1 4.1 4.1-4.1a.527.527 0 01.746.746L7.746 7z" fill="#000"></path><path d="M1 1h12v12H1z"></path></g></svg>'},376:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1.5 16a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0-13a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm13 13a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0-13a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM8 9.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3z" fill-rule="nonzero"></path></svg>'},377:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.147 13.146l11-11a1.5 1.5 0 11.707.707l-11 11a1.5 1.5 0 11-.707-.707z" fill-rule="nonzero"></path></svg>'},378:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.915 14h10.17c.05-.14.12-.271.207-.389l-2.204-4.114a1.5 1.5 0 110-2.995l2.204-4.113A1.496 1.496 0 0113.085 2H2.915c-.151.426-.489.764-.915.915v10.17c.426.151.764.489.915.915zm0 1A1.5 1.5 0 111 13.085V2.915A1.5 1.5 0 112.915 1h10.17a1.5 1.5 0 111.276 1.994l-2.272 3.975a1.495 1.495 0 010 2.063l2.272 3.974A1.5 1.5 0 1113.086 15H2.914z" fill-rule="nonzero"></path></svg>'},379:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M0 11V1h12v10H0zm1-.833l2-.001V9H1v1.167zM7 9H4v1.166h3V9zm4 0H8v1.166h3V9zm0-1V7H8v1h3zM1 8h2V7H1v1zm6-1H4v1h3V7zm4-1V5H8v1h3zM1 6h2V5H1v1zm6-1H4v1h3V5zm4-3.167H1V4h10V1.833z" fill="#000" fill-rule="nonzero"></path></svg>'},38:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 6.598L14.308.29a.991.991 0 011.402 1.402L9.402 8l6.308 6.308a.991.991 0 01-1.402 1.402L8 9.402 1.692 15.71A.991.991 0 01.29 14.308L6.598 8 .29 1.692A.991.991 0 011.692.29L8 6.598z" fill="#000" fill-rule="nonzero"></path></svg>'},380:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M10 0l2 9c-2.352-.588-4.186-.657-5.5-.208V11H10v1H2v-1h3.5l.002-1.792c-1.247.426-2.961.386-5.142-.121L0 9l2-9h8zm-.803 1H2.802l-1.61 7.243.062.013c1.831.356 3.214.317 4.14-.077l.159-.073c1.244-.622 2.876-.758 4.906-.442l.227.037L9.197 1zM6 1.5a2 2 0 012 2V6L6 7.5 4 6V3.5a2 2 0 012-2zm0 1a1 1 0 00-.993.883L5 3.5v2l1 .75 1-.75v-2a1 1 0 00-.883-.993L6 2.5zm0 1a.5.5 0 110 1 .5.5 0 010-1z" fill="#000" fill-rule="nonzero"></path></svg>'},381:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M10 0l2 9c-2.352-.588-4.186-.657-5.5-.208V11H10v1H2v-1h3.5l.002-1.792c-1.247.426-2.961.386-5.142-.121L0 9l2-9h8zm-.803 1H2.802l-1.61 7.243.062.013c1.831.356 3.214.317 4.14-.077l.159-.073c1.244-.622 2.876-.758 4.906-.442l.227.037L9.197 1zm-.572 1L9.5 7h-7l.875-5h5.25zM3.929 4.637L3.69 6h3.035l-.084-.058c-.282-.185-.446-.264-.584-.281L6 5.657c-.632 0-1.314-.345-2.07-1.02zM7.784 3H4.215l-.077.45C4.927 4.265 5.562 4.657 6 4.657c.439 0 .741.14 1.322.537l.165.115c.369.259.604.402.78.45L7.784 3zm-.584.5a.5.5 0 110 1 .5.5 0 010-1zm-1.3-.3a.5.5 0 110 1 .5.5 0 010-1z" fill="#000" fill-rule="evenodd"></path></svg>'},382:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M12 0v12H0V0h12zm-1 1H1v10h3L1 9l3-2 3 2-3 2h7V1zM4 8.202L2.803 9 4 9.797 5.196 9 4 8.202zM8 4l3 2-3 2-3-2 3-2zm0 1.202L6.803 6 8 6.797 9.196 6 8 5.202zM4 1l3 2-3 2-3-2 3-2zm0 1.202L2.803 3 4 3.797 5.196 3 4 2.202z" fill="#000" fill-rule="nonzero"></path></svg>'},383:function(e,t){e.exports=o},384:function(e,t){e.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zm0 2C4.477 20 0 15.523 0 10S4.477 0 10 0s10 4.477 10 10-4.477 10-10 10zm8.282-1.718a.961.961 0 011.359 0l4.077 4.077a.961.961 0 01-1.359 1.36l-4.077-4.078a.961.961 0 010-1.36z" fill="#000" fill-rule="nonzero"></path></svg>'},385:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 15a.5.5 0 010 1h-9a.5.5 0 010-1h9zM2 0a.5.5 0 01.5.5V14l.6-.8a.5.5 0 01.623-.147l.077.047a.5.5 0 01.148.623L3.9 13.8l-1.5 2a.5.5 0 01-.734.072L1.6 15.8l-1.5-2a.5.5 0 01.74-.667l.06.067.6.8V.5A.5.5 0 012 0zm10.5 10a.5.5 0 010 1h-6a.5.5 0 010-1h6zm-2-5a.5.5 0 010 1h-4a.5.5 0 010-1h4zm-2-5a.5.5 0 010 1h-2a.5.5 0 010-1h2z" fill="#000" fill-rule="evenodd"></path></svg>'},386:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 15a.5.5 0 010 1h-9a.5.5 0 010-1h9zm-3-5a.5.5 0 010 1h-6a.5.5 0 010-1h6zm-2-5a.5.5 0 010 1h-4a.5.5 0 010-1h4zm-2-5a.5.5 0 010 1h-2a.5.5 0 010-1h2zM2 16a.5.5 0 00.5-.5V2l.6.8a.5.5 0 00.623.147L3.8 2.9a.5.5 0 00.148-.623L3.9 2.2 2.4.2a.5.5 0 00-.734-.072L1.6.2l-1.5 2a.5.5 0 00.74.667L.9 2.8l.6-.8v13.5a.5.5 0 00.5.5z" fill="#000" fill-rule="evenodd"></path></svg>'},387:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M6 0a6 6 0 110 12A6 6 0 016 0zm0 1a5 5 0 100 10A5 5 0 006 1zm4 4.5v1H2v-1h8z" fill="#000" fill-rule="nonzero"></path></svg>'},388:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M6 0a6 6 0 110 12A6 6 0 016 0zm0 1a5 5 0 100 10A5 5 0 006 1zm.5 1v3.5H10v1H6.5V10h-1V6.5H2v-1h3.5V2h1z" fill="#000" fill-rule="nonzero"></path></svg>'},389:function(e,t){e.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.462 12l10.235 10.235a1.034 1.034 0 11-1.462 1.462L12 13.462 1.765 23.697a1.034 1.034 0 11-1.462-1.462L10.538 12 .303 1.765A1.034 1.034 0 111.765.303L12 10.538 22.235.303a1.034 1.034 0 111.462 1.462L13.462 12z" fill="#000" fill-rule="nonzero"></path></svg>'},39:function(e,t){e.exports=a},390:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6.262 6.972l-.893-.893a.5.5 0 010-.707l.003-.003a.5.5 0 01.707 0l.893.893.709-.709a1.003 1.003 0 000-1.419L4.844 1.297a1.003 1.003 0 00-1.419 0L1.297 3.425a1.003 1.003 0 000 1.419L4.134 7.68a1.003 1.003 0 001.419 0l.71-.71zm1.419 0l1.347 1.347.71-.71a2.006 2.006 0 012.837 0l2.837 2.838a2.006 2.006 0 010 2.837l-2.128 2.128a2.006 2.006 0 01-2.837 0L7.61 12.575a2.006 2.006 0 010-2.837l.709-.71-1.347-1.347-.71.71a2.006 2.006 0 01-2.837 0L.588 5.552a2.006 2.006 0 010-2.837L2.716.588a2.006 2.006 0 012.837 0L8.39 3.425a2.006 2.006 0 010 2.837l-.709.71zm2.057 2.056l.599.6a.5.5 0 010 .707l-.002.002a.5.5 0 01-.707 0l-.6-.6-.709.71a1.003 1.003 0 000 1.419l2.837 2.837a1.003 1.003 0 001.419 0l2.128-2.128a1.003 1.003 0 000-1.419L11.866 8.32a1.003 1.003 0 00-1.419 0l-.71.71z" fill="#000" fill-rule="nonzero"></path></svg>'},391:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(125),o=n(0);function s(e,t,n){e.isDataSourceSet&&e.getChildDataSources().forEach((function(e){e&&e.getDataSourceJson()&&e.id&&(r(e.getDataSourceJson(),n)&&t.push(e),s(e,t,n))}))}function r(e,t){return!!e&&t.some((function(t){return e.type&&t===e.type}))}t.traverseGetToUseDss=s,t.getWhetherUseDataSource=r,t.getToUseChildDss=function(e,t){var n={};return 0===t.length?Promise.resolve(n):Promise.all(e.filter((function(e){return e&&e.id&&!e.getDataSourceJson().isHidden&&e.isDataSourceSet&&!e.isDataView&&!e.isLocal})).map((function(e){return n[e.id]||(n[e.id]=[]),s(e,n[e.id],t)}))).then((function(){return Object.keys(n).forEach((function(e){0===n[e].length&&delete n[e]})),n}))},t.getSortedLabels=function(e){return e.sort((function(e,t){return e.localeCompare(t)}))};var i=[a.AllDataSourceTypes.FeatureSet];t.getAddedDataTypes=function(e){return e?e.filter((function(e){return!i.some((function(t){return t===e}))})):o.Immutable([])},t.getOutputTypes=function(e){return e?e.filter((function(e){return i.some((function(t){return t===e}))})):o.Immutable([])},t.getAllToUseRootDss=function(e,t){var n=e||[];return t&&Object.keys(t).forEach((function(e){if(!n.some((function(t){return t.id===e}))){var t=o.DataSourceManager.getInstance().getDataSource(e);t&&(n=n.concat(t))}})),n},t.getAllToUseDss=function(e,t){var n=e||[];return t&&Object.values(t).forEach((function(e){e&&e.length>0&&(n=n.concat(e))})),n}},392:function(e,t){e.exports='<svg viewBox="0 0 8 8" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 3.5v-3a.5.5 0 011 0v3h3a.5.5 0 010 1h-3v3a.5.5 0 01-1 0v-3h-3a.5.5 0 010-1h3z" fill-rule="evenodd"></path></svg>'},393:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 3h11a1 1 0 011 1v11a1 1 0 01-1 1H4a1 1 0 01-1-1V4a1 1 0 011-1zm0 1v11h11V4H4zm-4 7.5V1a1 1 0 011-1h9.5a.5.5 0 010 1H1v10.5a.5.5 0 01-1 0z" fill-rule="nonzero"></path></svg>'},394:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M9 6V2.333C9 .939 10.408 0 12 0h8c1.592 0 3 .939 3 2.333V6h8a1 1 0 010 2h-3l-1.858 22.153A2 2 0 0124.148 32H7.852a2 2 0 01-1.994-1.847L4 8H1a1 1 0 010-2h8zm2 0h10V2c0-.078-10-.078-10 0v4zM6.006 8l1.846 22h16.296l1.846-22H6.006zM13 12a1 1 0 011 1v12a1 1 0 01-2 0V13a1 1 0 011-1zm6 0a1 1 0 011 1v12a1 1 0 01-2 0V13a1 1 0 011-1z"></path></svg>'},395:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M9.5 6.25a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0zm-4.75 0a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0zM0 6.25a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},396:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M11 0v6h-1V1H1v10h5v1H0V0h11zM8.5 6a2.5 2.5 0 012.099 3.859l1.248 1.25a.522.522 0 11-.739.738l-1.25-1.248A2.5 2.5 0 118.5 6zm0 1a1.5 1.5 0 10.84 2.742l-.03.019.031-.02.034-.024.028-.02c.021-.015.041-.031.06-.048l-.057.045.082-.065a1.51 1.51 0 00.214-.23l.039-.057.001-.001.015-.024.014-.022.003-.005.008-.012.034-.058.003-.006A1.5 1.5 0 008.5 7zM5 7v1H2V7h3zm1-2v1H2V5h4zm3-2v1H2V3h7z" fill-rule="nonzero" fill="#000"></path></svg>'},397:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="M12.8 8L14 9l-7 5-7-5 1.2-1L7 12l5.8-4zM7 0l7 5-7 5-7-5 7-5z" fill-rule="evenodd"></path></svg>'},398:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M6 0a6 6 0 110 12A6 6 0 016 0zm0 1a5 5 0 100 10A5 5 0 006 1zm.5 3.5v4H7a.5.5 0 110 1H5a.5.5 0 110-1h.5v-3H5a.5.5 0 110-1h1.5zm-.5-2a.5.5 0 110 1 .5.5 0 010-1z" fill="#FFF" fill-rule="nonzero"></path></svg>'},399:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),o=n(400),s=n(401),r=n(172);t.getIconFromFieldType=function(e,t){var n,i;if(!e||!t)return null;var l=((n={})[a.JimuFieldType.Number]=o,n[a.JimuFieldType.String]=s,n[a.JimuFieldType.Date]=r,n),c=((i={})[a.JimuFieldType.Number]=t.colors.info,i[a.JimuFieldType.String]=t.colors.success,i[a.JimuFieldType.Date]=t.colors.warning,i);return{icon:l[e],color:c[e]}}},400:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M1.6 4.23L.553 5.238 0 4.558l1.687-1.46h.86v5.804H1.6V4.23zm2.035 3.63l2.168-2.18L6 5.471c.068-.073.13-.151.185-.233.055-.082.101-.168.138-.258a.741.741 0 00.055-.283.729.729 0 00-.244-.558.786.786 0 00-.256-.151.9.9 0 00-.312-.054.822.822 0 00-.583.214.918.918 0 00-.276.573l-.993-.082c.02-.267.082-.504.185-.709.102-.205.235-.375.398-.512.163-.137.352-.24.568-.311A2.23 2.23 0 015.566 3c.253 0 .488.034.706.102.218.069.409.17.572.304.163.134.291.304.386.512.095.208.142.45.142.73 0 .366-.08.681-.24.946-.16.265-.367.518-.62.758L4.786 8.016h2.586v.886H3.635V7.86zm5.952-2.426h.245c.136 0 .27-.008.398-.024a.999.999 0 00.347-.107.64.64 0 00.248-.237.8.8 0 00.095-.418.73.73 0 00-.22-.55.794.794 0 00-.576-.213.828.828 0 00-.509.168.948.948 0 00-.327.472l-1.002-.28c.064-.212.153-.398.269-.556.115-.159.252-.289.41-.39.157-.1.33-.176.52-.225.19-.05.386-.074.591-.074.242 0 .47.033.686.098.216.066.405.163.568.291a1.412 1.412 0 01.536 1.16c0 .312-.084.589-.252.832a1.177 1.177 0 01-.702.48v.016c.357.055.628.213.812.475.184.263.276.574.276.935 0 .279-.051.524-.154.738-.102.213-.24.392-.414.536a1.786 1.786 0 01-.603.328 2.31 2.31 0 01-.713.111c-.232 0-.45-.026-.655-.078a1.805 1.805 0 01-.556-.242 1.602 1.602 0 01-.43-.422A1.91 1.91 0 018.2 7.64l1.009-.278c.058.24.16.426.307.557.148.131.347.197.6.197a.986.986 0 00.658-.25.855.855 0 00.205-.287.906.906 0 00.075-.373.822.822 0 00-.114-.455.781.781 0 00-.292-.27 1.225 1.225 0 00-.398-.128 2.95 2.95 0 00-.434-.032h-.229v-.886z" fill="#000" fill-rule="nonzero"></path></svg>'},401:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M1.804 3.145h.638l1.786 5.71h-.843L3 7.548H1.2L.826 8.855H0l1.804-5.71zm.937 3.532l-.639-2.322-.65 2.322h1.289zm1.95-3.532h1.616c.157 0 .31.026.463.077.152.05.288.134.407.25.12.115.216.265.29.447.074.183.111.404.111.662 0 .322-.066.588-.199.798-.133.21-.306.36-.521.452v.016a.871.871 0 01.36.149c.111.078.206.177.284.298.078.121.14.261.185.42.045.158.067.329.067.512 0 .312-.045.571-.135.778-.09.207-.208.374-.354.5a1.308 1.308 0 01-.504.27c-.189.054-.381.08-.577.08H4.691V3.146zm.738 2.323h.673c.246 0 .43-.066.554-.198a.731.731 0 00.184-.52c0-.247-.063-.431-.19-.552-.127-.121-.33-.182-.612-.182H5.43v1.452zm0 2.516h.68c.093 0 .194-.008.301-.024a.675.675 0 00.518-.367.96.96 0 00.088-.448c0-.3-.071-.51-.214-.629-.142-.118-.364-.177-.664-.177h-.709v1.645zm5.903-3.5c-.152-.226-.3-.376-.442-.452a.914.914 0 00-.43-.113c-.215 0-.41.053-.583.158-.174.104-.323.25-.448.435a2.203 2.203 0 00-.29.65 2.988 2.988 0 00-.102.798c0 .306.034.588.102.846.068.259.165.482.29.67.125.188.274.336.448.443.174.108.368.162.583.162.168 0 .33-.055.489-.166.158-.11.305-.286.442-.528l.609.597c-.187.355-.416.613-.685.774-.27.161-.557.242-.861.242-.32 0-.614-.071-.882-.214a2.064 2.064 0 01-.69-.605 3.012 3.012 0 01-.454-.94 4.241 4.241 0 01-.164-1.217c0-.457.054-.872.164-1.246.109-.373.26-.692.453-.955.194-.264.424-.467.691-.61.268-.142.562-.213.882-.213.281 0 .542.069.782.206.24.137.463.37.67.697l-.574.58z" fill="#000" fill-rule="nonzero"></path></svg>'},558:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(559),l=n(1081),c=n(1085),d=n(125),u=n(38),p=n(392),h=n(139),m=function(e){function t(t){var n=e.call(this,t)||this;return n.externalDsStyle={width:"100%",height:"100%",maxWidth:"5000px",margin:0},n.__unmount=!1,n.showExternalDs=function(){n.setState({isExternalDsShown:!0})},n.onSelectDataFinished=function(e){e?n.state.getAppConfigAction?((0,n.state.getAppConfigAction)().addDataSources(e).exec(),e.map((function(e){return s.DataSourceManager.getInstance().createDataSource(e)})),n.props.changeInitStatus&&n.props.changeInitStatus(!1),n.setState({isExternalDsShown:!1})):console.error("Can not load jimu-for-builder"):n.setState({isExternalDsShown:!1})},n.onSelectDataCanceled=function(){n.setState({isExternalDsShown:!1})},n.onToggleExternalDs=function(){n.setState({isExternalDsShown:!n.state.isExternalDsShown})},n.onSearchValueChange=function(e){n.setState({searchValue:e.target.value})},n.ExternalDs=s.jsx(i.ExternalDataSourceSelector,{portalUrl:s.getAppStore().getState().portalUrl,onCancel:n.onSelectDataCanceled,onFinish:n.onSelectDataFinished,types:n.props.types&&n.props.types.some((function(e){return e===d.AllDataSourceTypes.FeatureLayer||e===d.AllDataSourceTypes.FeatureQuery}))?null:n.props.types}),n.state={isExternalDsShown:!1,getAppConfigAction:null,searchValue:""},n}return o(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,s.moduleLoader.loadModule("jimu-for-builder").then((function(t){e.__unmount||e.setState({getAppConfigAction:t.getAppConfigAction})}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.getWhetherOnlyUseAddedData=function(e){var t=this;return!!e&&e.every((function(e){return!t.getWhetherOneTypeIsOutput(e)}))},t.prototype.getWhetherOnlyUseWidgetOutput=function(e){var t=this;return!!e&&e.every((function(e){return t.getWhetherOneTypeIsOutput(e)}))},t.prototype.getWhetherOneTypeIsOutput=function(e){var t=s.DataSourceManager.getInstance().getDataSources();return Object.keys(t).some((function(n){return t[n]&&t[n].type===e&&t[n].getDataSourceJson()&&t[n].getDataSourceJson().isOutputFromWidget}))},t.prototype.render=function(){var e,t=s.jsx(c.default,{types:this.props.types,isDataSourceInited:this.props.isDataSourceInited,useDataSources:this.props.useDataSources,onChange:this.props.onChange,isMultiple:this.props.isMultiple,disableSelection:this.props.disableSelection,disableRemove:this.props.disableRemove,intl:this.props.intl,fromRootDsIds:this.props.fromRootDsIds,hideTypeDropdown:this.props.hideTypeDropdown,widgetId:this.props.widgetId,searchValue:this.state.searchValue,fromDsIds:this.props.fromDsIds,dataSources:this.props.dataSources}),n=s.jsx(l.default,{types:this.props.types,isDataSourceInited:this.props.isDataSourceInited,useDataSources:this.props.useDataSources,onChange:this.props.onChange,isMultiple:this.props.isMultiple,disableSelection:this.props.disableSelection,disableRemove:this.props.disableRemove,intl:this.props.intl,fromRootDsIds:this.props.fromRootDsIds,hideTypeDropdown:this.props.hideTypeDropdown,searchValue:this.state.searchValue,dataSources:this.props.dataSources,widgetId:this.props.widgetId}),a=s.jsx(r.Tabs,{pills:!0,fill:!0,className:"mt-3"},s.jsx(r.Tab,{id:"added",title:this.props.intl.formatMessage({id:"added",defaultMessage:r.defaultMessages.added}),defaultActive:!0},t),s.jsx(r.Tab,{id:"outputs",title:this.props.intl.formatMessage({id:"outputs",defaultMessage:r.defaultMessages.outputs})},n)),o=this.getWhetherOnlyUseAddedData(this.props.types),i=this.getWhetherOnlyUseWidgetOutput(this.props.types);return s.jsx("div",{className:s.classNames("w-100 h-100",(e={},e[this.props.className]=!!this.props.className,e))},s.jsx("div",{className:"component-data-source-list h-100 w-100"},!this.props.hideHeader&&s.jsx("div",{className:"ds-list-header jimu-widget-setting--header d-flex px-3 py-0",title:this.props.intl.formatMessage({id:"setDataSource",defaultMessage:r.defaultMessages.setDataSource})},s.jsx("div",{className:"flex-grow-1 text-truncate d-flex align-items-center"},s.jsx("span",null,this.props.intl.formatMessage({id:"setDataSource",defaultMessage:r.defaultMessages.setDataSource}))),this.props.onCloseClick&&s.jsx(r.Button,{type:"tertiary",size:"sm",icon:!0,className:"flex-shrink-0 text-center ds-list-close px-2 d-flex align-items-center",onClick:this.props.onCloseClick,title:this.props.intl.formatMessage({id:"close",defaultMessage:s.defaultMessages.close})},s.jsx(r.Icon,{icon:u,size:"16"}))),s.jsx("div",{className:"w-100 px-3 search"},s.jsx(r.Icon,{icon:h,size:16,className:"search-icon"}),s.jsx(r.TextInput,{value:this.state.searchValue,onChange:this.onSearchValueChange,className:"search-input",placeholder:this.props.intl.formatMessage({id:"search",defaultMessage:s.defaultMessages.search})})),s.jsx("div",{className:"w-100 ds-list-container"},s.jsx("div",{className:"ds-list-tabs h-100"},o?t:s.jsx("div",{className:"h-100"},i?n:a)),!this.props.disableAddData&&s.jsx("div",{className:" d-flex align-items-center px-3 ds-add-data",onClick:this.showExternalDs},s.jsx("div",{className:"add-data-icon-container d-flex align-items-center justify-content-center mr-2"},s.jsx(r.Icon,{icon:p,size:12,className:"add-data-icon"})),s.jsx("div",{className:"text-truncate flex-grow-1"},this.props.intl.formatMessage({id:"addNewData",defaultMessage:r.defaultMessages.addNewData})))),this.props.isDataSourceInited?null:s.jsx("div",{className:"jimu-secondary-loading"})),this.state.isExternalDsShown?s.jsx(r.Modal,{isOpen:this.state.isExternalDsShown,style:this.externalDsStyle,toggle:this.onToggleExternalDs,contentClassName:"h-100",className:"widget-ds-setting-add-data-popup"},this.ExternalDs):null)},t}(s.React.PureComponent);t.DataSourceList=s.injectIntl(s.themeUtils.withStyles(s.ReactRedux.connect((function(e){return{dataSources:e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.dataSources}}))(m),"DataSourceList"))},559:function(e,t,n){"use strict";var a,o,s,r,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=this&&this.__assign||function(){return(l=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var c,d=n(0),u=n(3),p=n(383),h=n(125),m=n(1078),f=n(1080),g=n(560),S=n(59),v=n(561),D=n(389),y=n(37),w=n(236),b=n(237),x=n(126),I=n(181);!function(e){e.WebMap="Web Map",e.WebScene="Web Scene",e.Layers="Layers",e.Url="URL"}(c||(c={}));var M=((o={})[c.WebMap]=p.ItemTypes.WebMap,o[c.WebScene]=p.ItemTypes.WebScene,o[c.Layers]=[p.ItemTypes.FeatureService,p.ItemTypes.MapService],o),C=((s={})[h.AllDataSourceTypes.WebMap]=c.WebMap,s[h.AllDataSourceTypes.WebScene]=c.WebScene,s[h.AllDataSourceTypes.FeatureLayer]=[c.Layers,c.Url],s[h.AllDataSourceTypes.FeatureQuery]=[c.Layers,c.Url],s),_=((r={})[c.WebMap]=n(231),r[c.WebScene]=n(232),r[c.Layers]=n(233),r[c.Url]=n(390),r),j=function(e){function t(t){var n,a=e.call(this,t)||this;return a.tabLabel=((n={})[c.WebMap]=a.props.intl.formatMessage({id:"webMap",defaultMessage:u.defaultMessages.webMap}),n[c.WebScene]=a.props.intl.formatMessage({id:"webScene",defaultMessage:u.defaultMessages.webScene}),n[c.Layers]=a.props.intl.formatMessage({id:"layers",defaultMessage:u.defaultMessages.layers}),n[c.Url]=a.props.intl.formatMessage({id:"url",defaultMessage:u.defaultMessages.url}),n),a.getTabTypeFromDsType=function(e){return e?Array.isArray(C[e])?C[e]:[C[e]]:[]},a.getTabIcon=function(e){return e?_[e]:null},a.getTabLabel=function(e){return e?a.tabLabel[e]:null},a.getElementPosition=function(e){if(!e)return null;for(var t=e.offsetLeft,n=e.offsetTop,a=e.offsetParent;null!==a;)t+=a.offsetLeft,n+=a.offsetTop,a=a.offsetParent;return{x:t,y:n}},a.getItemDetailPosition=function(){var e,t,n;if(!a.rootDom)return null;var o=a.getElementPosition(a.rootDom),s=null===(n=null===(t=null===(e=d.getAppStore())||void 0===e?void 0:e.getState())||void 0===t?void 0:t.appContext)||void 0===n?void 0:n.isRTL,r=o.x+260;return{t:"0",b:"0",l:s?"auto":r+"px",r:s?r+"px":"auto",w:"260px",h:"auto"}},a.getConfigDsId=function(){var e=d.getAppStore().getState(),t=e&&e.appStateInBuilder&&e.appStateInBuilder.appConfig;return d.appConfigUtils.getUniqueId(t,"dataSource")},a.getNextDsId=function(){if(!a.dataSourceId)return a.dataSourceId=a.getConfigDsId(),a.dataSourceId;var e=a.dataSourceId.split("_"),t=e[1]?parseInt(e[1])+1:d.uuidv1(),n=e[0]||"dataSource";return a.dataSourceId=n+"_"+t,a.dataSourceId},a.fetchDataFromItem=function(e){return e?e.type===p.ItemTypes.WebMap||e.type===p.ItemTypes.WebScene?g.fetchDataFromMapItem(e,a.getNextDsId(),a.props.portalUrl):g.fetchDataFromService(e.url,a.getNextDsId(),e.title,a.props.portalUrl,e.id):Promise.resolve(null)},a.onItemAdded=function(e,t){void 0===e&&(e=[]),a.setState({selectedItems:e,partSelectedItems:a.state.partSelectedItems.filter((function(t){return!e.some((function(e){return e.id===t.id}))}))}),a.toggleLoadStatus(!1),a.fetchDataFromItem(t).then((function(e){a.onDsJsonAdded(e),a.toggleLoadStatus(!0)}),(function(n){console.error(n),a.toggleLoadStatus(!0),a.toggleToastStatus(!0),a.setState({selectedItems:e.filter((function(e){return e.id!==t.id}))})}))},a.onItemRemoved=function(e,t){a.setState({selectedItems:e,partSelectedItems:a.state.partSelectedItems.filter((function(e){return e.id!==t.id}))}),a.toggleLoadStatus(!1),a.fetchDataFromItem(t).then((function(e){a.onDsJsonRemoved(e),a.toggleLoadStatus(!0)}),(function(e){console.error(e),a.toggleLoadStatus(!0),a.toggleToastStatus(!0)}))},a.onDsJsonAdded=function(e){var t;e.dsJson&&(a.props.onSelect&&a.props.onSelect([e.dsJson]),a.setState({selectedDss:a.state.selectedDss.concat(e.dsJson),dataSchemas:e.dataSchema?l(l({},a.state.dataSchemas),(t={},t[e.dataSchema.id]=e.dataSchema,t)):a.state.dataSchemas}))},a.onDsJsonRemoved=function(e){if(e.dsJson){a.props.onRemove&&a.props.onRemove([e.dsJson]);var t=l({},a.state.dataSchemas);delete t[e.dsJson.id],a.setState({selectedDss:a.state.selectedDss.filter((function(t){return t.itemId!==e.dsJson.itemId})),dataSchemas:t,selectedItems:a.state.selectedItems.filter((function(t){return t.id!==e.dsJson.itemId})),partSelectedItems:a.state.partSelectedItems.filter((function(t){return t.id!==e.dsJson.itemId}))})}},a.onDsJsonChange=function(e){var t=a.state.selectedDss.findIndex((function(t){return t.id===e.id})),n=a.state.selectedDss.slice();n.splice(t,1,e);var o=a.state.selectedItems.concat(a.state.partSelectedItems).find((function(t){return t.id===(null==e?void 0:e.itemId)})),s=a.state.selectedItems,r=a.state.partSelectedItems;o&&(a.getWhetherIsPartSelected(e)?(s=a.state.selectedItems.filter((function(t){return e.itemId&&t.id!==e.itemId})),r=a.state.partSelectedItems.concat(o)):(s=a.state.selectedItems.concat(o),r=a.state.partSelectedItems.filter((function(t){return e.itemId&&t.id!==e.itemId}))));a.setState({selectedDss:n,selectedItems:s,partSelectedItems:r})},a.getWhetherIsPartSelected=function(e){var t=!1;if(null==e?void 0:e.childDataSourceJsons){for(var n=0;n<Object.values(e.childDataSourceJsons).length;n++)if(a.getWhetherIsPartSelected(Object.values(e.childDataSourceJsons)[n])){t=!0;break}}else t=e.isHidden;return t},a.getWhetherCurrentDsIsHidden=function(e){return e&&e.isHidden},a.onAddedDataCollapseClicked=function(){a.setState({isSelectedDataCollapseOpen:!a.state.isSelectedDataCollapseOpen})},a.onFinish=function(){a.props.onFinish&&a.props.onFinish(a.state.selectedDss.map((function(e){return e&&e.without("geometryType")})))},a.onActiveTabChange=function(e){a.setState({activeTab:e})},a.toggleLoadStatus=function(e){a.setState({isLoaded:e})},a.toggleToastStatus=function(e){e?a.setState({isToastOpen:e},(function(){setTimeout((function(){a.setState({isToastOpen:!1})}),3e3)})):a.setState({isToastOpen:e})},a.onToggleData=function(e,t){e&&t&&(t.isHidden?a.onDsJsonChange(g.traverseUnhideParentDs(t,e)):t.id!==e.id?a.onDsJsonChange(g.traverseHideChildDs(t,e)):a.onDsJsonRemoved({dsJson:e,dataSchema:t}))},a.AddedItem=function(e){var t=e.rootDsJson,n=e.dataSchema;return d.jsx("div",{className:"added-ds-item"},d.jsx(v.DataSourceTree,{dataSource:n,isNodeSelectable:function(){return!0},renderSelectableNode:function(e){return a.renderDataItem(e,t)},getChildDataSources:a.getChildData,getLabel:a.getDataLabel}))},a.getChildData=function(e){return e&&e.childSchemas?Object.values(e.childSchemas):[]},a.getDataLabel=function(e){return e&&(e.label||e.id)},a.renderDataItem=function(e,t){if(!e)return null;var n=e,o=d.Immutable({id:n.id,type:n.type,label:n.label,isHidden:n.isHidden});return d.jsx("div",{className:"d-flex align-items-center justify-content-between w-100 item"},d.jsx("div",{className:"d-flex align-items-center flex-grow-1 text-truncate"},d.jsx("div",{className:"d-flex justify-content-center align-items-center flex-shrink-0 ds-thumbnail"},d.jsx(u.Icon,{icon:S.getDsIcon(o),className:"text-dark",size:"12"})),d.jsx("div",{className:"flex-grow-1 text-truncate pl-2 ds-type",title:a.getDataLabel(n)},a.getDataLabel(n))),d.jsx("div",{className:"d-flex align-items-center flex-shrink-0"},d.jsx(u.Button,{type:"tertiary",size:"sm",icon:!0,onClick:function(){return a.onToggleData(t,n)},title:(null==n?void 0:n.isHidden)?a.props.intl.formatMessage({id:"clickToShow",defaultMessage:u.defaultMessages.clickToShow}):(null==n?void 0:n.parentSchema)?a.props.intl.formatMessage({id:"clickToHide",defaultMessage:u.defaultMessages.clickToHide}):a.props.intl.formatMessage({id:"remove",defaultMessage:u.defaultMessages.remove})},d.jsx(u.Icon,{icon:(null==n?void 0:n.isHidden)?b:(null==n?void 0:n.parentSchema)?w:y,size:12}))))},a.state={selectedDss:[],selectedItems:[],partSelectedItems:[],activeTab:a.props.types&&a.getTabTypeFromDsType(a.props.types[0])?a.getTabTypeFromDsType(a.props.types[0])[0]:c.WebMap,isLoaded:!0,isToastOpen:!1,isSelectedDataCollapseOpen:!1,dataSchemas:{}},a}return i(t,e),t.prototype.render=function(){var e,t=this,n=this.AddedItem,a=this.props.types?Array.prototype.concat.apply([],this.props.types.map((function(e){return t.getTabTypeFromDsType(e)})).filter((function(e){return!!e}))):Object.keys(c).map((function(e){return c[e]}));return d.jsx("div",{className:d.classNames("h-100",(e={},e[this.props.className]=!!this.props.className,e))},d.jsx("div",{className:"w-100 component-external-data-source-selector",ref:function(e){return t.rootDom=e}},d.jsx("div",{className:"d-flex flex-wrap align-items-stretch w-100 h-100"},d.jsx("div",{className:"selector-left"},d.jsx("h3",{className:"selector-left-title"},this.props.isRadio?this.props.intl.formatMessage({id:"selectData",defaultMessage:u.defaultMessages.selectData}):this.props.intl.formatMessage({id:"addData",defaultMessage:u.defaultMessages.addData})),d.jsx(u.Nav,{underline:!0,vertical:!0,right:!0,className:"selector-left-tabs"},a.map((function(e){return d.jsx(u.NavItem,{key:e,className:d.classNames("w-100 mb-2",{"active-tab":t.state.activeTab===e})},d.jsx(u.NavLink,{onClick:function(){t.onActiveTabChange(e)},className:"d-flex"},d.jsx(u.Icon,{icon:t.getTabIcon(e),size:"16",className:"mr-2 flex-shrink-0"}),d.jsx("div",{className:"flex-grow-1 text-truncate text-left",title:t.getTabLabel(e)},t.getTabLabel(e))))})))),d.jsx("div",{className:"selector-right h-100"},d.jsx("div",{className:"selector-right-header w-100 d-flex justify-content-end"},d.jsx(u.Button,{type:"tertiary",size:"sm",icon:!0,className:"close-icon",onClick:this.props.onCancel},d.jsx(u.Icon,{width:20,height:20,icon:D}))),d.jsx("div",{className:"selector-right-body w-100"},(this.state.activeTab===c.WebMap||this.state.activeTab===c.WebScene||this.state.activeTab===c.Layers)&&[c.WebMap,c.WebScene,c.Layers].map((function(e,n){return d.jsx("div",{className:d.classNames("inner-item-selector-container h-100 w-100",{"d-none":e!==t.state.activeTab}),key:n},d.jsx(f.default,{itemType:M[e],intl:t.props.intl,portalUrl:t.props.portalUrl,isRadio:t.props.isRadio,onSelect:t.onItemAdded,onRemove:t.onItemRemoved,getItemDetailPosition:t.getItemDetailPosition,selectedItems:t.state.selectedItems,partSelectedItems:t.state.partSelectedItems}))})),this.state.activeTab===c.Url&&d.jsx(m.default,{onAdded:this.onDsJsonAdded,getDsId:this.getNextDsId,intl:this.props.intl,toggleLoadStatus:this.toggleLoadStatus,toggleToastStatus:this.toggleToastStatus})))),d.jsx("div",null,this.state.selectedDss&&this.state.selectedDss.length>0&&d.jsx("div",{className:"added-ds-container py-3"},d.jsx("div",{className:"d-flex justify-content-between align-items-center px-3"},d.jsx("div",{className:"d-flex align-items-center"},d.jsx("span",{className:"mr-2"},this.state.selectedDss.length),d.jsx("span",{className:"mr-2"},this.props.intl.formatMessage({id:"selected",defaultMessage:u.defaultMessages.selected})),d.jsx(u.Button,{type:"tertiary",size:"sm",icon:!0,onClick:this.onAddedDataCollapseClicked,title:this.state.isSelectedDataCollapseOpen?this.props.intl.formatMessage({id:"down",defaultMessage:u.defaultMessages.down}):this.props.intl.formatMessage({id:"up",defaultMessage:u.defaultMessages.up})},this.state.isSelectedDataCollapseOpen?d.jsx(u.Icon,{icon:x,size:"12"}):d.jsx(u.Icon,{icon:I,size:"12"}))),d.jsx("div",{className:"small-done-btn"},!this.state.isSelectedDataCollapseOpen&&d.jsx(u.Button,{onClick:this.onFinish,type:"primary",className:"text-truncate w-100"},this.props.intl.formatMessage({id:"done",defaultMessage:u.defaultMessages.done})))),this.state.isSelectedDataCollapseOpen&&d.jsx("div",{className:"added-ds-items"},d.jsx("div",null,this.state.selectedDss.map((function(e,a){return d.jsx(n,{key:a,rootDsJson:e,dataSchema:t.state.dataSchemas[e.id]})})))),this.state.isSelectedDataCollapseOpen&&d.jsx("div",{className:"big-done-btn w-100 px-3"},d.jsx(u.Button,{onClick:this.onFinish,type:"primary",className:"text-truncate w-100"},this.props.intl.formatMessage({id:"done",defaultMessage:u.defaultMessages.done}))))),d.jsx("div",null,!this.state.isLoaded&&d.jsx("div",{className:"jimu-primary-loading"})),d.jsx(u.Toast,{text:this.props.intl.formatMessage({id:"invalidResourceItem",defaultMessage:d.defaultMessages.invalidResourceItem}),type:u.ToastType.Error,open:this.state.isToastOpen})))},t}(d.React.PureComponent);t.ExternalDataSourceSelector=d.injectIntl(d.themeUtils.withStyles(j,"ExternalDataSourceSelector"))},560:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),s=n(383),r=n(125),i=n(1079);function l(e){return"GroupLayer"===e?i.SupportedLayerServiceTypes.GroupLayer:"ArcGISFeatureLayer"===e?i.SupportedLayerServiceTypes.FeatureLayer:null}function c(e){return e&&0!==e.length?Promise.all(e.map((function(e){return o.ServiceManager.getInstance().fetchServiceInfo(e).then((function(e){return e.definition}))}))).then((function(t){var n,a={};return t.forEach((function(t,o){n=e[o],a[n]=t})),a})):Promise.resolve({})}function d(e,t,n){if(!e||!n)return Promise.resolve(null);var a={id:e.id,label:n.name||e.label,type:e.type,parentSchema:t};return o.dataSourceUtils.fetchSupportedLayerDefinitions(e.url,n).then((function(e){return Object.keys(e).length>0?(a.childSchemas={},Promise.all(Object.keys(e).map((function(t){var n,s;return d(u(o.dataSourceUtils.fixLayerId(""+((null===(n=e[t])||void 0===n?void 0:n.name)||(null===(s=e[t])||void 0===s?void 0:s.id))),t,e[t]),a,e[t])}))).then((function(e){return e.forEach((function(e){a.childSchemas[e.id]=e})),a}))):a}))}function u(e,t,n){return e&&n?(t||n.type!==i.SupportedLayerServiceTypes.GroupLayer?o.dataSourceUtils.isSupportedSingleLayerService(t)?a=o.dataSourceUtils.getSingleDsJsonFromLayerDefinition(e,t,n):o.dataSourceUtils.isSupportedWholeService(t)&&(a=o.dataSourceUtils.getSingleDsJsonFromWholeServiceDefinition(e,t,n)):a=o.Immutable({id:e,type:o.DataSourceTypes.GroupLayer}),a):null;var a}function p(e,t){if(!e)return null;t||(t=o.Immutable({}));var n=t.set("isHidden",!!e.isHidden).set("type",e.type).set("id",function(e){if(!e)return null;for(var t=e.id;e.parentSchema;)t=o.dataSourceUtils.getChildDataSourceId(e.parentSchema.id,t),e=e.parentSchema;return t}(e));return e.childSchemas&&Object.keys(e.childSchemas).map((function(t){n.getIn(["childDataSourceJsons"])||(n=n.setIn(["childDataSourceJsons"],{}));var a=e.childSchemas[t].id;n=n.setIn(["childDataSourceJsons",a],p(e.childSchemas[t],null==n?void 0:n.childDataSourceJsons[a]))})),n}function h(e){if(!e)return null;for(var t=e;t.parentSchema;)t=t.parentSchema;return t}t.fetchDataFromMapItem=function(e,t,n){if(!e||!t||!e.type||e.type!==s.ItemTypes.WebMap&&e.type!==s.ItemTypes.WebScene)return Promise.resolve(null);var p={authentication:o.SessionManager.getInstance().getMainSession()};return o.esri.restPortal.getItemData(e.id,p).then((function(p){if(!p)return null;var h=function(e,t,n){if(!e||e.type!==s.ItemTypes.WebMap&&e.type!==s.ItemTypes.WebScene)return null;return o.Immutable({type:e.type===s.ItemTypes.WebMap?r.AllDataSourceTypes.WebMap:r.AllDataSourceTypes.WebScene,itemId:e.id,id:t,portalUrl:n})}(e,t,n);return function e(t,n,s,r){if(!t||!s)return Promise.resolve(null);var p={id:t.id,label:r.title,type:t.type,parentSchema:n},h=s.operationalLayers||s.layers||[],m=Object.values(i.SupportedServiceTypes).concat(Object.values(i.SupportedLayerServiceTypes)).map((function(e){return e.replace(/\s+/g,"").toLowerCase().replace("server","service")})),f=h.filter((function(e){return!!e&&("ArcGISFeatureLayer"===e.layerType?!!e.url:(e.id||e.title)&&e.layerType&&m.some((function(t){return e.layerType.toLowerCase().indexOf(t)>-1})))})),g=s.tables||[],S=f.concat(g),v={},D={};if(S.forEach((function(e){e.url?v[o.dataSourceUtils.getFixedLayerIdByLayer(e)]=e.url.replace(/^http:/,"https:"):D[o.dataSourceUtils.getFixedLayerIdByLayer(e)]={id:e.id,name:e.title,type:l(e.layerType)}})),0===Object.keys(v).length&&0===Object.keys(D).length)return Promise.resolve(p);return function(e){if(!e||0===Object.keys(e).length)return Promise.resolve({});var t={},n={};Object.keys(e).forEach((function(a){o.dataSourceUtils.isSupportedSingleLayerService(e[a])?t[a]=e[a]:o.dataSourceUtils.isSupportedWholeService(e[a])&&(n[a]=e[a])}));var s=a(a({},t),n);return Promise.all([o.dataSourceUtils.fetchSupportedLayerDefinitionsFromUrls(Object.values(t)),c(Object.values(n))]).then((function(e){var t=e[0],n=e[1],o=a(a({},t),n),r={};return Object.keys(s).forEach((function(e){r[e]=a(a({},o[s[e]]),{url:s[e]})})),r}))}(v).then((function(t){var n=a(a({},t),D);return Object.keys(n).length>0?(p.childSchemas={},Promise.all(Object.keys(n).map((function(t){return v[t]?d(u(t,v[t],n[t]),p,n[t]):D[t]?e(u(t,v[t],n[t]),p,S.find((function(e){return o.dataSourceUtils.getFixedLayerIdByLayer(e)===t})),S.find((function(e){return o.dataSourceUtils.getFixedLayerIdByLayer(e)===t}))):void 0}))).then((function(e){return e.forEach((function(e){p.childSchemas[e.id]=e})),p}))):p}))}(h,null,p,e).then((function(e){return{dsJson:h,dataSchema:e}}))}))},t.fetchDataFromService=function(e,t,n,a,s){return e&&t?o.ServiceManager.getInstance().fetchServiceInfo(e.replace(/^http:/,"https:")).then((function(o){var r=o.definition;if(!r)return null;var i=u(t,e,r);return d(i=function(e,t,n,a){if(!e)return null;t&&(e=e.set("label",t));n&&(e=e.set("portalUrl",n));a&&(e=e.set("itemId",a));return e}(i,n,a,s),null,r).then((function(e){return{dsJson:i,dataSchema:e}}))})):Promise.resolve(null)},t.traverseHideChildDs=function(e,t){return e?p(h(function e(t,n){if(!t)return null;var a=t;return a.isHidden=!!n,a.childSchemas&&Object.keys(a.childSchemas).map((function(t){a.childSchemas[t]=e(a.childSchemas[t],n)})),a}(e,!0)),t):null},t.traverseUnhideParentDs=function(e,t){return e?p(h(function e(t,n){if(!t)return null;var a=t;return a.isHidden=!!n,a.parentSchema&&(a.parentSchema=e(a.parentSchema,n)),a}(e,!1)),t):null}},561:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(3),l=n(387),c=n(388),d=function(e){function n(a){var o=e.call(this,a)||this;return o.toggleChildDss=function(){o.setState({isOpen:!o.state.isOpen})},o.drawCollapseLine=function(){var e,t;if(o.collapseRef&&o.lastNodeInCollapseRef){var n=o.lastNodeInCollapseRef.querySelector("#"+o.getUniqueId())||o.lastNodeInCollapseRef,a=window&&(null===(e=window.getComputedStyle(o.lastNodeInCollapseRef))||void 0===e?void 0:e.paddingTop),s=a?parseFloat(a)+2:0,r=window&&(null===(t=window.getComputedStyle(n))||void 0===t?void 0:t.paddingTop),i=r?parseFloat(r):0;o.setState({heightOfCollapseExceptForLastNode:o.collapseRef.offsetHeight-o.lastNodeInCollapseRef.offsetHeight+s,heightOfFirstNodeOfLastNodeInCollapse:n.offsetHeight-i})}o.props.drawCollapseLine&&o.props.drawCollapseLine()},o.getUniqueId=function(){return"first_node_in_collapse-"+n.count},o.getSelectableChildNodes=function(e){return e?(o.props.getChildDataSources(e)||[]).filter((function(e){return o.props.isNodeSelectable(e)})):[]},o.getChildNodes=function(e){return e?(o.props.getChildDataSources(e)||[]).filter((function(e){return o.props.isNodeSelectable(e)||o.getChildNodes(e).length>0})):[]},o.getLabel=function(){var e=o.props.getLabel(o.props.dataSource)||o.props.dataSource.id;return o.props.label?o.props.label+" / "+e:e},o.getHideLineStyle=function(){return{height:o.state.heightOfCollapseExceptForLastNode+o.state.heightOfFirstNodeOfLastNodeInCollapse/2+"px"}},o.getWhetherUnselectableParentAndChildNodeCanJoin=function(){var e=o.getChildNodes(o.props.dataSource);return!(o.getSelectableChildNodes(o.props.dataSource).length>0)&&1===e.length},o.getRenderContent=function(){if(!o.props.dataSource)return null;var e=o.getChildNodes(o.props.dataSource),n=e.length>0,a=o.props.isNodeSelectable(o.props.dataSource);if(!a&&!n)return null;var d=o.getSelectableChildNodes(o.props.dataSource).length>0,u=o.getLabel(),p=o.getWhetherUnselectableParentAndChildNodeCanJoin(),h=!o.props.isChildTree&&p,m=e&&e.map((function(n,a){return n&&n.id?r.React.createElement("div",{key:n.id,ref:function(t){return a===e.length-1?o.lastNodeInCollapseRef=t:void 0},className:r.classNames({"pt-3":0!==a})},o.props.getChildDataSources(n).length>0?r.React.createElement(t.DataSourceTree,s({},o.props,{dataSource:n,label:p?u:"",drawCollapseLine:o.drawCollapseLine,isChildTree:!h})):r.React.createElement("div",{className:"d-flex align-items-center"},r.React.createElement("div",{className:r.classNames("collapse-button leaf")}),r.React.createElement("div",{className:r.classNames("d-flex align-items-center w-100")},o.props.renderSelectableNode&&o.props.renderSelectableNode(n)))):null}));return d||a||!p?r.React.createElement("div",null,r.React.createElement("div",{className:"d-flex align-items-center"},r.React.createElement("div",{className:r.classNames("collapse-button",{root:!o.props.isChildTree})},n&&r.React.createElement(i.Button,{type:"tertiary",icon:!0,size:"sm",onClick:o.toggleChildDss,className:"w-10 px-0 d-flex align-items-center",title:o.state.isOpen?o.props.intl.formatMessage({id:"close",defaultMessage:r.defaultMessages.close}):o.props.intl.formatMessage({id:"open",defaultMessage:r.defaultMessages.open})},r.React.createElement(i.Icon,{icon:o.state.isOpen?l:c,size:"12"}))),r.React.createElement("div",{className:r.classNames("d-flex align-items-center w-100"),id:o.getUniqueId()},a?o.props.renderSelectableNode&&o.props.renderSelectableNode(o.props.dataSource):o.props.renderUnselectableNode&&o.props.renderUnselectableNode(u))),n&&r.React.createElement(i.Collapse,{isOpen:o.state.isOpen,className:"collapse-content",innerRef:function(e){return o.collapseRef=e},onEntering:o.drawCollapseLine,onExiting:o.drawCollapseLine,onEntered:o.drawCollapseLine,onExited:o.drawCollapseLine},m,r.React.createElement("div",{className:r.classNames("collapse-line",{root:!o.props.isChildTree}),style:o.getHideLineStyle()}))):n?r.React.createElement("div",null,m):null},n.count++,o.state={isOpen:!1,heightOfFirstNodeOfLastNodeInCollapse:0,heightOfCollapseExceptForLastNode:0},o}return o(n,e),n.prototype.componentDidMount=function(){this.drawCollapseLine()},n.prototype.componentDidUpdate=function(e){this.props.isNodeSelectable!==e.isNodeSelectable&&this.drawCollapseLine()},n.prototype.render=function(){var e,t=this.getWhetherUnselectableParentAndChildNodeCanJoin(),n=!this.props.isChildTree&&t,a=!this.props.isChildTree&&!n;return r.React.createElement("div",{className:r.classNames("w-100 h-100",(e={},e[this.props.className]=!!this.props.className,e))},r.React.createElement("div",{className:r.classNames("component-data-source-tree",{bg:this.props.useDefaultBackground&&a&&this.state.isOpen,"tree-root":a})},this.getRenderContent()))},n.count=-1,n}(r.React.PureComponent);t.DataSourceTree=r.injectIntl(r.themeUtils.withStyles(d,"DataSourceTree"))},562:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(1082),i=n(1083),l=function(e){function t(t){var n=e.call(this,t)||this;return n.dsManager=s.DataSourceManager.getInstance(),n.getWhetherShowSingleDss=function(){return n.props.rootDss&&n.props.rootDss.length>0},n.getSelectedErrorDss=function(){return n.props.useDataSources?n.props.useDataSources.asMutable().filter((function(e){return!(n.dsManager&&n.dsManager.getDataSource(null==e?void 0:e.mainDataSourceId))})).map((function(e){return e.mainDataSourceId})):null},n.state={isTypeDropdownOpen:!1,selectedErrorDss:null},n}return o(t,e),t.prototype.componentDidMount=function(){if(this.props.showErrorDss){var e=this.getSelectedErrorDss();this.setState({selectedErrorDss:e}),e&&e.length>0?this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!0):this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!1)}},t.prototype.componentDidUpdate=function(e){if(this.props.showErrorDss&&(!this.state.selectedErrorDss||0===this.state.selectedErrorDss.length)&&(!e.useDataSources||0===e.useDataSources.length)&&this.props.useDataSources&&0!==this.props.useDataSources.length){var t=this.getSelectedErrorDss();this.setState({selectedErrorDss:t}),t&&t.length>0?this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!0):this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!1)}},t.prototype.render=function(){var e=this;return s.React.createElement("div",{className:"ds-list px-3"},this.props.showErrorDss&&this.state.selectedErrorDss&&this.state.selectedErrorDss.map((function(t){return s.React.createElement(r.default,{useDataSources:e.props.useDataSources,dsId:t,key:t,onChange:e.props.onChange,isMultiple:e.props.isMultiple,disableSelection:e.props.disableSelection,disableRemove:e.props.disableRemove,intl:e.props.intl,className:"mb-3 ml-4",widgetId:e.props.widgetId})})),this.getWhetherShowSingleDss()?s.React.createElement("div",null,s.dataSourceUtils.getSortedArrayByLabel(this.props.rootDss).map((function(t){return t&&t.id?s.React.createElement(i.default,{useDataSources:e.props.useDataSources,ds:t,key:t.id,onChange:e.props.onChange,isMultiple:e.props.isMultiple,allToUseDss:e.props.allToUseDss,disableSelection:e.props.disableSelection,disableRemove:e.props.disableRemove,intl:e.props.intl,widgetId:e.props.widgetId}):null}))):null)},t}(s.React.PureComponent);t.default=l},563:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(391),l=n(125),c=n(59),d=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.getWhetherdisableSelectionType=function(e){return e.length<=1},n.onTypeSelected=function(e){var t,a=e.target.value;"All"===a?t=null:a===l.AllDataSourceTypes.FeatureLayer||a===l.AllDataSourceTypes.FeatureQuery?(t=[a],n.props.toUseTypes.some((function(e){return e===l.AllDataSourceTypes.FeatureLayer}))&&n.props.toUseTypes.some((function(e){return e===l.AllDataSourceTypes.FeatureQuery}))&&(t=[l.AllDataSourceTypes.FeatureLayer,l.AllDataSourceTypes.FeatureQuery])):t=[a],n.props.onTypeSelected(t)},n}return o(t,e),t.prototype.render=function(){var e=this,t=this.props.toUseTypes?s.Immutable(Array.from(new Set(this.props.toUseTypes.asMutable()))):s.Immutable([]);return s.React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3 to-use-types"},s.React.createElement("div",{className:"mr-2 w-25 text-truncate",title:this.props.intl.formatMessage({id:"type",defaultMessage:r.defaultMessages.type})},this.props.intl.formatMessage({id:"type",defaultMessage:r.defaultMessages.type})),this.getWhetherdisableSelectionType(t)?s.React.createElement("div",{className:"types-selected text-truncate mr-1",title:c.getDsTypeString(t[0],this.props.intl)},c.getDsTypeString(t[0],this.props.intl)):s.React.createElement(r.Select,{value:this.props.selectedTypes&&this.props.selectedTypes[0]||"All",onChange:this.onTypeSelected,className:"flex-shrink-0 to-use-dp",buttonProps:{className:"text-truncate h-100"}},i.getSortedLabels(t.asMutable()).map((function(t){return s.React.createElement("option",{value:t,key:t},c.getDsTypeString(t,e.props.intl))})),t&&t.length>1&&s.React.createElement("option",{value:"All"},this.props.intl.formatMessage({id:"all",defaultMessage:r.defaultMessages.all}))))},t}(s.React.PureComponent);t.default=d},564:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(3),l=n(39),c=n(565),d=n(59),u=n(21),p=n(127),h=n(393),m=n(394),f=function(e){function t(n){var a=e.call(this,n)||this;a.__unmount=!1,a.lastScrollTop=0,a.initQueryParams=function(){a.setState({queryParams:{page:1,pageSize:"number"==typeof a.state.dataView.maximum?Math.min(a.state.dataView.maximum,15):15}})},a.setQueryParams=function(){var e=a.state.dataView,t="number"==typeof(null==e?void 0:e.maximum)?e.maximum<=15?1:Math.ceil(e.maximum/15):null,n="number"==typeof(null==e?void 0:e.maximum)?Math.min(e.maximum,15):15,o=a.state.queryParams.page;t?o+1<=t&&(o+=1):o+=1,a.setState({queryParams:{page:o,pageSize:n}})},a.setLocalDataSource=function(){var e,t,n;if((null===(e=a.props.mainDataSource)||void 0===e?void 0:e.type)===u.DataSourceTypes.FeatureLayer){a.setState({isLocalDataSourceCreated:!1});var o=a.props.mainDataSource.getDataSourceJson().set("id",a.getLocalLoadId()).set("query",a.state.dataView).set("isHidden",!0);if(!a.props.isSettingMainDataSource){var s=null===(t=a.props.mainDataSource.getDataSourceJson())||void 0===t?void 0:t.query;s&&"number"==typeof s.maximum&&(o=o.setIn(["query","maximum"],"number"==typeof o.query.maximum?Math.min(o.query.maximum,s.maximum):s.maximum))}var i=r.DataSourceManager.getInstance().getDataSource(a.getLocalLoadId());i?(r.DataSourceManager.getInstance().updateDataSourceByDataSourceJson(i,o),r.lodash.defer((function(){a.__unmount||a.setState({localDataSource:i,isLocalDataSourceCreated:!0})}))):r.DataSourceManager.getInstance().createDataSource({id:o.id,dataSourceJson:o,layer:null===(n=a.props.mainDataSource)||void 0===n?void 0:n.layer}).then((function(e){a.__unmount||a.setState({localDataSource:e,isLocalDataSourceCreated:!0})}),(function(e){console.error("Preview table error: ",e),a.__unmount||a.setState({isLocalDataSourceCreated:!0})}))}},a.loadLocalDataSource=function(){var e,t;if((null===(e=a.state.localDataSource)||void 0===e?void 0:e.type)===u.DataSourceTypes.FeatureLayer&&(null===(t=a.props.mainDataSource)||void 0===t?void 0:t.type)===u.DataSourceTypes.FeatureLayer){a.setState({isLocalDataSourceLoaded:!1});var n=s({page:1,pageSize:a.state.queryParams.page*a.state.queryParams.pageSize},{outFields:["*"]});if(!a.props.isSettingMainDataSource){var o=a.props.mainDataSource.getConfigQueryParams()||{};n=a.props.mainDataSource.mergeQueryParams(o,n)}a.state.localDataSource.load(n,{widgetId:a.getLocalLoadId(),scope:r.QueryScope.InConfigView}).then((function(){a.__unmount||a.setState({isLocalDataSourceLoaded:!0})}),(function(e){console.error("Preview table error: ",e),a.__unmount||a.setState({isLocalDataSourceLoaded:!0})}))}},a.getUseDataSource=function(e){if(!e)return null;var t=e.getRootDataSource(),n=e.getMainDataSource();return r.Immutable({dataSourceId:e.id,rootDataSourceId:t&&t.id,mainDataSourceId:n&&n.id})},a.getNewDataView=function(e){if(!e)return r.Immutable({});var t=e.getDataSourceJson(),n=(null==t?void 0:t.dataViews)?Object.keys(t.dataViews):null,o=n&&n.map((function(e){return e.split("_")[1]})).filter((function(e){return a.isNumeric(e)})).length>0?Math.max.apply(null,n.map((function(e){return e.split("_")[1]})).filter((function(e){return a.isNumeric(e)})))+1:1;return r.Immutable({id:a.props.newDataViewId||"dataView_"+o,label:a.props.newDataViewLabel||a.props.intl.formatMessage({id:"dataView",defaultMessage:i.defaultMessages.dataView})+" "+o})},a.getPreviewTable=function(e){var t;if((null==e?void 0:e.type)===u.DataSourceTypes.FeatureLayer){var n=null===(t=e)||void 0===t?void 0:t.getRecordsByPage(1,a.state.queryParams.pageSize*a.state.queryParams.page),o=null==e?void 0:e.getSchema(),s=null==o?void 0:o.fields;if(!n||!s)return null;var i=Object.values(s).sort((function(e,t){return e.name.localeCompare(t.name)}));return r.jsx("div",{className:"table-container mr-2",onScroll:a.onScroll},r.jsx("div",{className:"table-header"},r.jsx("table",null,r.jsx("thead",null,r.jsx("tr",{className:"d-flex"},i.map((function(e,t){return r.jsx("th",{key:t,title:e.alias||e.name},e.alias||e.name)})))))),r.jsx("div",{className:"table-body"},r.jsx("table",null,r.jsx("tbody",null,n.map((function(e,t){return r.jsx("tr",{className:"d-flex",key:t},i.map((function(t,n){var o=e.getFormattedFieldValue(t.jimuName,a.props.intl);return r.jsx("td",{key:n,title:o},o)})))}))))))}},a.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},a.onScroll=function(e){var t=e.target.clientHeight,n=e.target.scrollHeight,o=e.target.scrollTop,s=n-(t+o)<=10,r=o>a.lastScrollTop;a.lastScrollTop=o<=0?0:o,a.state.isLocalDataSourceCreated&&a.state.isLocalDataSourceLoaded&&s&&r&&a.setQueryParams()},a.onDuplicate=function(){var e,t;if(a.props.onDuplicate){var n=a.getNewDataView(a.props.mainDataSource);n=a.props.dataView?a.props.dataView.merge(n.asMutable({deep:!0})):n,(null===(e=a.props.dataView)||void 0===e?void 0:e.label)&&(n=n.set("label",a.props.dataView.label+" "+(null===(t=a.props.intl.formatMessage({id:"copy",defaultMessage:i.defaultMessages.copy}))||void 0===t?void 0:t.toLocaleLowerCase()))),a.props.onDuplicate(n)}},a.onRemove=function(e){var t,n,o;e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var s=r.DataSourceManager.getInstance().getDataViewDataSourceId(null===(t=a.props.mainDataSource)||void 0===t?void 0:t.id,null===(n=a.props.dataView)||void 0===n?void 0:n.id);0===d.getWidgetsUsingDsOrItsDescendantDss(s,a.props.widgets).length?(a.state.getAppConfigAction&&(a.removeDataView(null===(o=a.props.dataView)||void 0===o?void 0:o.id),r.DataSourceManager.getInstance().destroyDataSource(s)),a.props.toggle()):a.setState({isRemoveWarningOpen:!0},(function(){return a.props.toggle()}))},a.removeDataView=function(e){var t;if(e&&a.state.getAppConfigAction){var n=null===(t=a.props.mainDataSource)||void 0===t?void 0:t.getDataSourceJson(),o=n.dataViews||r.Immutable({});o=o.without(e);var s=d.editDataSourceJson(n.setIn(["dataViews"],o));a.state.getAppConfigAction().editDataSource(s).exec()}},a.onLabelChange=function(e){var t=a.state.dataView;t=t.set("label",e.target.value),a.setState({dataView:t})},a.onSqlExprBuilderChange=function(e){var t=a.state.dataView;t=t.set("where",e),a.setState({dataView:t})},a.onSortChange=function(e,t){var n=a.state.dataView;n=n.set("orderBy",e),a.setState({dataView:n})},a.onPageSizeChange=function(e){var t=a.state.dataView;t="number"==typeof e?t.set("pageSize",e):t.without("pageSize"),a.setState({dataView:t})},a.onToggleMaximum=function(e,t){var n=a.state.dataView;n=t?n.set("maximum",100):n.without("maximum"),a.setState({dataView:n})},a.onMaximumChange=function(e){var t=a.state.dataView;t="number"==typeof e?t.set("maximum",e):t.set("maximum",100),a.setState({dataView:t})},a.onApply=function(){a.props.onApply(a.state.dataView)},a.toggleTitleInput=function(){a.setState({isTitleInputShown:!a.state.isTitleInputShown})},a.toggleRemoveWarning=function(){a.setState({isRemoveWarningOpen:!a.state.isRemoveWarningOpen})},t.count++;var o=a.props.dataView||a.getNewDataView(a.props.mainDataSource);return a.state={dataView:o,localDataSource:null,isTitleInputShown:!1,isRemoveWarningOpen:!1,isLocalDataSourceCreated:!1,isLocalDataSourceLoaded:!1,SqlExpressionBuilder:null,Sort:null,getAppConfigAction:null,queryParams:{page:1,pageSize:"number"==typeof(null==o?void 0:o.maximum)?Math.min(o.maximum,15):15}},a}return o(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,Promise.all([r.moduleLoader.loadModule("jimu-ui/advanced/sql-expression-builder"),r.moduleLoader.loadModule("jimu-for-builder")]).then((function(t){var n=t[0],a=t[1].getAppConfigAction;e.__unmount||e.setState({SqlExpressionBuilder:n.SqlExpressionBuilder,Sort:n.Sort,getAppConfigAction:a})})),this.props.mainDataSource&&this.setLocalDataSource()},t.prototype.componentDidUpdate=function(e,t){var n,a;(e.dataView!==this.props.dataView||!e.isOpen&&this.props.isOpen)&&(this.initQueryParams(),this.setState({dataView:this.props.dataView||this.getNewDataView(this.props.mainDataSource)})),(null===(n=t.dataView)||void 0===n?void 0:n.maximum)!==(null===(a=this.state.dataView)||void 0===a?void 0:a.maximum)&&this.initQueryParams(),e.mainDataSource===this.props.mainDataSource&&t.dataView===this.state.dataView||this.setLocalDataSource(),(t.queryParams!==this.state.queryParams||!t.isLocalDataSourceCreated&&this.state.isLocalDataSourceCreated)&&this.loadLocalDataSource(),e.isOpen&&!this.props.isOpen&&this.destroyLocalDataSource(),t.isTitleInputShown!==this.state.isTitleInputShown&&this.state.isTitleInputShown&&this.titleInput&&(this.titleInput.focus(),this.titleInput.select())},t.prototype.componentWillUnmount=function(){this.__unmount=!0,this.destroyLocalDataSource()},t.prototype.destroyLocalDataSource=function(){this.state.localDataSource&&r.DataSourceManager.getInstance().destroyDataSource(this.state.localDataSource.id)},t.prototype.getLocalLoadId=function(){return"DATA_VIEW_SETTING-"+t.count},t.prototype.getOrderByArray=function(e){var t;return null!==(t=null==e?void 0:e.map((function(e){return e.jimuFieldName+" "+e.order})).asMutable())&&void 0!==t?t:[]},t.prototype.render=function(){var e,t,n,a=this;if(!this.props.mainDataSource||this.props.mainDataSource.type!==u.DataSourceTypes.FeatureLayer)return null;var o=this.state.dataView,s=r.DataSourceManager.getInstance().getDataViewDataSourceId(null===(t=this.props.mainDataSource)||void 0===t?void 0:t.id,null===(n=this.props.dataView)||void 0===n?void 0:n.id),d=this.state.SqlExpressionBuilder,f=this.state.Sort;return r.jsx("div",null,r.jsx(i.Modal,{className:r.classNames((e={},e[this.props.className]=!!this.props.className,e)),isOpen:this.props.isOpen,centered:!0,toggle:this.props.toggle,returnfocusafterclose:"true",contentClassName:"data-view-container",backdrop:"static"},r.jsx(i.ModalHeader,{className:"d-flex justify-content-between header"},r.jsx("div",{className:"flex-grow-1 text-truncate"},this.props.disableRename?r.jsx("div",{className:"flex-grow-1 text-truncate",title:null==o?void 0:o.label},null==o?void 0:o.label):r.jsx("div",{className:"d-flex align-items-center pr-3"},this.state.isTitleInputShown?r.jsx(i.TextInput,{className:"flex-grow-1",value:null==o?void 0:o.label,onChange:this.onLabelChange,ref:function(e){return a.titleInput=e},onBlur:this.toggleTitleInput,onKeyUp:this.toggleTitleInput}):r.jsx("div",{className:"text-truncate",onClick:this.toggleTitleInput},null==o?void 0:o.label),r.jsx(i.Button,{className:"flex-shrink-0 ml-2",type:"tertiary",size:"sm",icon:!0,onClick:this.toggleTitleInput,title:this.props.intl.formatMessage({id:"edit",defaultMessage:i.defaultMessages.edit})},r.jsx(i.Icon,{icon:p,size:16})))),r.jsx("div",{className:"flex-shrink-0"},!this.props.disableDuplicate&&this.props.dataView&&r.jsx(i.Button,{className:"flex-shrink-0 cicle-button mr-3",type:"default",size:"sm",icon:!0,onClick:this.onDuplicate,title:this.props.intl.formatMessage({id:"duplicate",defaultMessage:l.defaultMessages.duplicate})},r.jsx(i.Icon,{icon:h,size:16})),!this.props.disableRemove&&this.props.dataView&&r.jsx(i.Button,{className:"flex-shrink-0 cicle-button",type:"default",size:"sm",icon:!0,onClick:this.onRemove,title:this.props.intl.formatMessage({id:"delete",defaultMessage:r.defaultMessages.delete})},r.jsx(i.Icon,{icon:m,size:16})))),o?r.jsx(i.ModalBody,{className:"d-flex"},r.jsx("div",{className:"w-38 h-100 flex-shrink-0"},r.jsx(i.Tabs,{underline:!0,fill:!0},r.jsx(i.Tab,{id:"filter",className:"view-tab",title:this.props.intl.formatMessage({id:"filter",defaultMessage:i.defaultMessages.filter}),defaultActive:!0},d&&r.jsx(d,{dataSource:this.props.mainDataSource,mode:r.SqlExpressionMode.Simple,expression:null==o?void 0:o.where,onChange:this.onSqlExprBuilderChange,queryScope:this.props.isSettingMainDataSource&&r.QueryScope.InRemoteConfigView})),r.jsx(i.Tab,{id:"sort",className:"view-tab",title:this.props.intl.formatMessage({id:"sort",defaultMessage:i.defaultMessages.sort})},f&&r.jsx(f,{onChange:this.onSortChange,value:(null==o?void 0:o.orderBy)||r.Immutable([]),useDataSource:this.getUseDataSource(this.props.mainDataSource)})),r.jsx(i.Tab,{id:"records",className:"view-tab",title:this.props.intl.formatMessage({id:"records",defaultMessage:i.defaultMessages.records})},r.jsx("div",null,r.jsx("div",{className:"d-flex justify-content-between mb-3"},r.jsx("div",{className:"label"},this.props.intl.formatMessage({id:"pageSize",defaultMessage:i.defaultMessages.pageSize})),r.jsx(i.NumericInput,{size:"sm",value:o.pageSize||r.CONSTANTS.DEFAULT_QUERY_PAGE_SIZE,onChange:this.onPageSizeChange,showHandlers:!1,precision:0,min:1})),r.jsx("div",{className:"d-flex justify-content-between mb-2"},r.jsx("div",{className:"label"},this.props.intl.formatMessage({id:"maximum",defaultMessage:i.defaultMessages.maximum})),r.jsx(i.Switch,{checked:"number"==typeof o.maximum,onChange:this.onToggleMaximum})),"number"==typeof o.maximum&&r.jsx("div",{className:"d-flex justify-content-between mb-3"},r.jsx("div",{className:"label"},this.props.intl.formatMessage({id:"maximumLimitationWarning",defaultMessage:i.defaultMessages.maximumLimitationWarning})),r.jsx(i.Link,{to:"https://developers.arcgis.com/javascript/latest/api-reference/esri-views-layers-FeatureLayerView.html#maximumNumberOfFeatures",className:"ml-2",target:"_blank"},this.props.intl.formatMessage({id:"details",defaultMessage:i.defaultMessages.details}))),"number"==typeof o.maximum&&r.jsx("div",{className:"d-flex justify-content-between mb-3"},r.jsx("div",{className:"label"},this.props.intl.formatMessage({id:"maximumRecordCount",defaultMessage:i.defaultMessages.maximumRecordCount})),r.jsx(i.NumericInput,{size:"sm",value:o.maximum,onChange:this.onMaximumChange,precision:0,min:1})))))),r.jsx("div",{className:"w-62 h-100 flex-grow-1 pl-3 preview-table"},this.getPreviewTable(this.state.localDataSource),(!this.state.isLocalDataSourceCreated||!this.state.isLocalDataSourceLoaded)&&r.jsx(i.Loading,{type:i.LoadingType.Primary}))):null,r.jsx(i.ModalFooter,null,r.jsx(i.Button,{className:"mr-2",type:"primary",onClick:this.onApply},this.props.intl.formatMessage({id:"applyChanges",defaultMessage:i.defaultMessages.applyChanges})),r.jsx(i.Button,{type:"default",onClick:this.props.toggle},this.props.intl.formatMessage({id:"cancel",defaultMessage:r.defaultMessages.cancel})))),r.jsx(c.DataSourceRemoveWarningPopup,{dataSourceId:s,isOpen:this.state.isRemoveWarningOpen,toggle:this.toggleRemoveWarning}))},t.count=-1,t}(r.React.PureComponent),g=r.ReactRedux.connect((function(e,t){var n,a,o,s;return{widgets:(null===(n=null==e?void 0:e.appContext)||void 0===n?void 0:n.isBuilder)?null===(o=null===(a=null==e?void 0:e.appStateInBuilder)||void 0===a?void 0:a.appConfig)||void 0===o?void 0:o.widgets:null===(s=null==e?void 0:e.appConfig)||void 0===s?void 0:s.widgets}}))(f);t.DataViewSettingPopup=r.injectIntl(r.themeUtils.withStyles(g,"DataViewSettingPopup"))},565:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<n;t++)for(var s=arguments[t],r=0,i=s.length;r<i;r++,o++)a[o]=s[r];return a};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(3),l=n(59),c=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.onCloseRemoveOptions=function(e){n.stopPropagation(e),n.props.toggle()},n.onCheckboxBtnClick=function(e,t){n.stopPropagation(t);var a=n.state.selectedWidgets.indexOf(e);a<0?n.state.selectedWidgets.push(e):n.state.selectedWidgets.splice(a,1),n.setState({selectedWidgets:s(n.state.selectedWidgets)})},n.onRemoveWidgets=function(e){if(n.stopPropagation(e),n.state.getAppConfigAction){var t,a,o=n.state.getAppConfigAction(),s=n.props.widgets?Object.values(n.props.widgets):[],i=l.getDescendantDssAndViews(n.props.dataSourceId);s.forEach((function(e){e&&(t=e.useDataSources?e.useDataSources.asMutable():[],a=t.filter((function(e){return!i.some((function(t){return t===e.dataSourceId}))})),o.editWidget(e.set("useDataSources",a).asMutable({deep:!0})))})),n.state.selectedWidgets.length>0&&n.state.selectedWidgets.forEach((function(e,t){o.removeWidget(e)}));var c=r.DataSourceManager.getInstance().getDataSource(n.props.dataSourceId);if(null==c?void 0:c.isDataView){var d=c.getDataSourceJson(),u=c.dataViewId,p=d.dataViews||r.Immutable({});p=p.without(u);var h=l.editDataSourceJson(d.setIn(["dataViews"],p));o.editDataSource(h).exec()}else o.removeDataSource(n.props.dataSourceId).exec()}n.props.toggle()},n.stopPropagation=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.state={selectedWidgets:[],getAppConfigAction:null},n}return o(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,r.moduleLoader.loadModule("jimu-for-builder").then((function(t){e.__unmount||e.setState({getAppConfigAction:t.getAppConfigAction})}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t=this;if(!this.props.dataSourceId)return null;var n=r.DataSourceManager.getInstance().getDataSource(this.props.dataSourceId);return r.jsx(i.Modal,{isOpen:this.props.isOpen,className:r.classNames("bg-light-300 d-flex justify-content-between",(e={},e[this.props.className]=!!this.props.className,e)),onClick:this.stopPropagation},r.jsx(i.ModalHeader,{className:"d-flex justify-content-between border-color-gray-300 py-3 font-16 font-dark-600",onClick:this.stopPropagation,toggle:this.props.toggle},this.props.intl.formatMessage({id:"removeDataSource",defaultMessage:i.defaultMessages.removeDataSource})),r.jsx(i.ModalBody,{onClick:this.stopPropagation},r.jsx("div",{className:"p-2"},r.jsx("p",{className:"font-13 font-dark-600"},this.props.intl.formatMessage({id:"youAreRemovingData",defaultMessage:i.defaultMessages.youAreRemovingData})),r.jsx("p",{className:"font-14 font-dark-800 mt-3"},n&&n.getLabel()||this.props.dataSourceId),r.jsx("p",{className:"font-13 font-dark-600 mt-3"},this.props.intl.formatMessage({id:"affectedWidgets",defaultMessage:i.defaultMessages.affectedWidgets})),r.jsx("p",{className:"font-14 font-dark-400 mt-5"},this.props.intl.formatMessage({id:"relatedWidgets",defaultMessage:i.defaultMessages.relatedWidgets})),r.jsx("div",{className:"related-widgets px-2 py-3"},r.jsx("div",null,l.getWidgetsUsingDsOrItsDescendantDss(this.props.dataSourceId,this.props.widgets).map((function(e){return e&&e.id?r.jsx(i.Label,{key:e.id,className:"d-flex"},r.jsx(i.Checkbox,{className:"mr-2 font-13",onClick:function(n){return t.onCheckboxBtnClick(e.id,n)},checked:t.state.selectedWidgets.indexOf(e.id)>-1}),r.jsx(i.Icon,{icon:e.icon,size:"16",className:"mr-1 font-dark-800"}),e.label):null})))),r.jsx("p",{className:"font-13 font-dark-600 mt-2"},this.props.intl.formatMessage({id:"howToRemoveWidgetsTip",defaultMessage:i.defaultMessages.howToRemoveWidgetsTip})))),r.jsx(i.ModalFooter,null,r.jsx("div",{className:"d-flex justify-content-end mt-10"},r.jsx(i.Button,{type:"primary",className:"mr-2",onClick:this.onRemoveWidgets},this.props.intl.formatMessage({id:"removeDataSource",defaultMessage:i.defaultMessages.removeDataSource})),r.jsx(i.Button,{type:"default",onClick:this.onCloseRemoveOptions},this.props.intl.formatMessage({id:"cancel",defaultMessage:r.defaultMessages.cancel})))))},t}(r.React.PureComponent),d=r.ReactRedux.connect((function(e,t){var n,a,o,s;return{widgets:(null===(n=null==e?void 0:e.appContext)||void 0===n?void 0:n.isBuilder)?null===(o=null===(a=null==e?void 0:e.appStateInBuilder)||void 0===a?void 0:a.appConfig)||void 0===o?void 0:o.widgets:null===(s=null==e?void 0:e.appConfig)||void 0===s?void 0:s.widgets}}))(c);t.DataSourceRemoveWarningPopup=r.injectIntl(r.themeUtils.withStyles(d,"DataSourceRemoveWarningPopup"))},566:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=n(3),i=n(59),l=n(395),c=n(396),d=n(397),u=n(234),p=n(236),h=n(237),m=n(398),f=function(e){function t(t){var n,a,o=e.call(this,t)||this;o.onLabelChange=function(e){o.setState({newLabel:e.target.value})},o.onMoreIconClick=function(e){o.stopPropagation(e),o.props.onMoreIconClick&&o.props.onMoreIconClick(o.props.dataSourceJson)},o.onCloseIconClick=function(e){o.stopPropagation(e),o.props.onCloseIconClick&&o.props.onCloseIconClick(o.props.dataSourceJson)},o.onRename=function(){var e=o.state.newLabel.trim();o.props.onRename&&o.props.onRename(e)},o.onDataSourceItemClick=function(e){o.stopPropagation(e),o.props.onDataSourceItemClick&&o.props.onDataSourceItemClick(o.props.dataSourceJson)},o.onMappingIconClick=function(e){o.stopPropagation(e),o.props.onMappingIconClick&&o.props.onMappingIconClick(o.props.dataSourceJson)},o.onHideIconClick=function(e){o.stopPropagation(e),o.props.onToggleHidden&&o.props.onToggleHidden(o.props.dataSourceJson)},o.stopPropagation=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},o.getWhetherIsSetDs=function(e){if(!e)return!1;var t=s.DataSourceManager.getInstance().getDataSource(e.id);return!!t&&t.isDataSourceSet},o.getChildDssLength=function(e){if(!e)return null;var t=s.DataSourceManager.getInstance().getDataSource(e.id);return t&&t.isDataSourceSet?t.getChildDataSources().length:null};var r=s.DataSourceManager.getInstance().getDataSource(null===(n=o.props.dataSourceJson)||void 0===n?void 0:n.id);return o.state={newLabel:r?r.getLabel():(null===(a=o.props.dataSourceJson)||void 0===a?void 0:a.id)||""},o}return o(t,e),t.prototype.componentDidUpdate=function(e,t){var n,a;if(e.isRenameInputShown!==this.props.isRenameInputShown&&this.props.isRenameInputShown&&this.renameInput&&(this.renameInput.focus(),this.renameInput.select()),e.dataSourceJson!==this.props.dataSourceJson){var o=s.DataSourceManager.getInstance().getDataSource(null===(n=this.props.dataSourceJson)||void 0===n?void 0:n.id);this.setState({newLabel:o?o.getLabel():(null===(a=this.props.dataSourceJson)||void 0===a?void 0:a.id)||""})}},t.prototype.render=function(){var e,t,n,a,o=this;if(!this.props.dataSourceJson)return null;var f,g=i.getWidgetsUsingDsOrItsViews(this.props.dataSourceJson.id,this.props.widgets),S=i.getWidgetsUsingDsOrItsDescendantDss(this.props.dataSourceJson.id,this.props.widgets),v=this.props.dataSourceJson.itemId&&this.props.portalUrl?this.props.portalUrl.replace(/\/$/,"")+"/home/item.html?id="+this.props.dataSourceJson.itemId:this.props.dataSourceJson.url,D=this.getWhetherIsSetDs(this.props.dataSourceJson);D&&(f=this.getChildDssLength(this.props.dataSourceJson));var y=s.DataSourceManager.getInstance().getDataSource(null===(t=this.props.dataSourceJson)||void 0===t?void 0:t.id);return s.jsx("div",{className:s.classNames((e={},e[this.props.className]=!!this.props.className,e))},s.jsx("div",{className:s.classNames("component-data-source-item",{"component-data-source-item-selected-item":this.props.isSelected,"cursor-pointer":!!this.props.onDataSourceItemClick}),onClick:this.onDataSourceItemClick},s.jsx("div",{className:"d-flex justify-content-between align-items-center ds-item-header"},s.jsx("div",{className:"d-flex align-items-center w-100"},s.jsx("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},s.jsx(r.Icon,{icon:i.getDsIcon(this.props.dataSourceJson),className:"text-dark",size:"12"})),s.jsx("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},s.jsx("div",{className:"text-truncate ds-type-name"},i.getDsTypeString(this.props.dataSourceJson.type,this.props.intl)))),s.jsx("div",{className:"d-flex"},this.props.isErrorIconShown?s.jsx("div",{className:"ml-1 flex-shrink-0 d-flex align-items-center ds-more p-2"},s.jsx("span",{className:"d-flex justify-content-center",title:this.props.intl.formatMessage({id:"uploadImageError",defaultMessage:r.defaultMessages.uploadImageError})},s.jsx(r.Icon,{icon:m,className:"align-baseline warning-icon",size:"12"}))):null,this.props.isMoreIconShown?s.jsx(r.Button,{size:"sm",icon:!0,type:"tertiary",className:"ml-1 flex-shrink-0 ds-more p-2",onClick:this.onMoreIconClick},s.jsx("span",{className:"d-flex justify-content-center",title:this.props.intl.formatMessage({id:"more",defaultMessage:r.defaultMessages.more})},s.jsx(r.Icon,{icon:l,className:"align-baseline",size:"12"}))):null,this.props.isHideable?s.jsx(r.Button,{size:"sm",icon:!0,type:"tertiary",className:"ml-1 flex-shrink-0 ds-more p-2",onClick:this.onHideIconClick},s.jsx("span",{className:"d-flex justify-content-center",title:(null===(n=this.props.dataSourceJson)||void 0===n?void 0:n.isHidden)?this.props.intl.formatMessage({id:"clickToShow",defaultMessage:r.defaultMessages.clickToShow}):this.props.intl.formatMessage({id:"clickToHide",defaultMessage:r.defaultMessages.clickToHide})},s.jsx(r.Icon,{icon:(null===(a=this.props.dataSourceJson)||void 0===a?void 0:a.isHidden)?h:p,className:"align-baseline",size:"12"}))):null)),s.jsx("div",{className:"ds-item-body"},this.props.isRenameInputShown?s.jsx(r.TextInput,{className:"flex-grow-1 text-truncate p-1 ds-label ds-label-input",ref:function(e){return o.renameInput=e},onBlur:this.onRename,onKeyUp:this.onRename,onChange:this.onLabelChange,value:this.state.newLabel,onClick:this.stopPropagation}):s.jsx("div",{className:"flex-grow-1 two-line-truncate ds-label text-left",title:y&&y.getLabel()||this.props.dataSourceJson.id},y&&y.getLabel()||this.props.dataSourceJson.id),s.jsx("div",{className:s.classNames("d-flex justify-content-between",{"mt-3":v||this.props.isMappingIconShown})},s.jsx("div",{className:"d-flex"},D?s.jsx("div",{className:"mr-5 ds-child-dss font-dark-600"},s.jsx("span",{title:""+this.props.intl.formatMessage({id:"containLayersWithNum",defaultMessage:r.defaultMessages.containLayersWithNum},{layerNum:f})},s.jsx(r.Icon,{icon:d,size:12,className:"mr-1"}),s.jsx("span",{className:"align-middle"},f))):null,this.props.isRelatedWidgetsShown?s.jsx("div",{className:"flex-grow-1 text-truncate flex-row ds-related-widgets font-dark-600"},s.jsx("span",{title:this.props.intl.formatMessage({id:"relatedWidgetsWithNum",defaultMessage:r.defaultMessages.relatedWidgetsWithNum},{directlyNum:g.length,totalNum:S.length})},s.jsx(r.Icon,{icon:u,size:12,className:"mr-1"}),s.jsx("span",{className:"align-middle"},g.length+" / "+S.length))):null),v?s.jsx(r.Button,{size:"sm",icon:!0,type:"tertiary",className:"ds-origin-label",href:v,target:"_blank",onClick:this.stopPropagation,title:this.props.intl.formatMessage({id:"source",defaultMessage:r.defaultMessages.source},{directlyNum:g.length,totalNum:S.length})},s.jsx(r.Icon,{icon:c,className:"m-0",size:12})):null))))},t}(s.React.PureComponent);t.DataSourceItem=s.ReactRedux.connect((function(e,t){var n=window&&window.jimuConfig&&window.jimuConfig.isBuilder?e.appStateInBuilder&&e.appStateInBuilder.portalUrl:e.portalUrl;if(t.isRelatedWidgetsShown){var a=window&&window.jimuConfig&&window.jimuConfig.isBuilder?e.appStateInBuilder&&e.appStateInBuilder.appConfig:e.appConfig;return{widgets:a&&a.widgets,portalUrl:n}}return{portalUrl:n}}))(s.injectIntl(s.themeUtils.withStyles(f,"DataSourceItem")))},567:function(e,t,n){"use strict";var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s,r=n(0),i=n(3),l=n(39);!function(e){e.First="POPULATED_VIEW_SELECTION_DEFAULT",e.Second="VIEW_DEFAULT_SELECTION_POPULATED"}(s=t.DataViewPriority||(t.DataViewPriority={}));var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getWhetherUseDsIsShallowEqual=function(e,t){var n=!1;return e&&t&&e.length===t.length&&(n=!e.some((function(e,n){return e.dataSourceId!==t[n].dataSourceId}))),n},t.isPopulatedView=function(e){return(null==e?void 0:e.dataViewId)===r.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID},t.isSelectionView=function(e){return(null==e?void 0:e.dataViewId)===r.CONSTANTS.SELECTION_DATA_VIEW_ID},t.isDefaultView=function(e){return"USE_MAIN_DATA_SOURCE"===(null==e?void 0:e.dataViewId)},t.isCommonView=function(e){return(null==e?void 0:e.dataViewId)&&!t.isPopulatedView(e)&&!t.isSelectionView(e)&&!t.isDefaultView(e)},t.getOneDefaultUseDs=function(e,n,a){var o=t.groupUseDataSourcesByMainDsAndAddAutoViews(e,n,a),r=[];r=t.props.defaultDataViewPriority===s.Second?[t.isCommonView,t.isDefaultView,t.isSelectionView,t.isPopulatedView]:[t.isPopulatedView,t.isCommonView,t.isSelectionView,t.isDefaultView];var i=Object.values(o).find((function(e){return e.some((function(e){return r[0](e)}))}))||Object.values(o).find((function(e){return e.some((function(e){return r[1](e)}))}))||Object.values(o).find((function(e){return e.some((function(e){return r[2](e)}))}))||Object.values(o).find((function(e){return e.some((function(e){return r[3](e)}))}))||Object.values(o)[0];return i?i.find((function(e){return r[0](e)}))||i.find((function(e){return r[1](e)}))||i.find((function(e){return r[2](e)}))||i.find((function(e){return r[3](e)}))||i[0]:null},t.getSelectedUseDsFromProps=function(e,n,a,o,s){var i,l,c=t.groupUseDataSourcesByMainDsAndAddAutoViews(e,a,s),d=t.getOneDefaultUseDs(e,a,s);return n?o?null===(i=c[n.mainDataSourceId])||void 0===i?void 0:i.find((function(e){return e.dataViewId===r.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID})):n.dataViewId?n:null===(l=c[n.mainDataSourceId])||void 0===l?void 0:l.find((function(e){return"USE_MAIN_DATA_SOURCE"===e.dataViewId})):d},t.getWhetherUseRepeatedDataSourceContext=function(e,n,a,o){var s,i,c,d,u=(null===(s=null===window||void 0===window?void 0:window.jimuConfig)||void 0===s?void 0:s.isBuilder)?null===(c=null===(i=r.getAppStore().getState())||void 0===i?void 0:i.appStateInBuilder)||void 0===c?void 0:c.appConfig:null===(d=r.getAppStore().getState())||void 0===d?void 0:d.appConfig;if(!(u&&e&&n&&0!==n.length&&a&&o))return!1;for(var p=l.searchUtils.getParentWidgetIdOfWidgetOrSection(u,e,r.LayoutItemType.Widget,o),h=u.widgets[p],m=h&&r.CONSTANTS.PROVIDE_REPEATED_DATA_SOURCE_CONTEXT_WIDGET_URI.some((function(e){return e===h.uri})),f=!1,g=function(e){var o=t.getRealUseDataSources(n[e],a);if(f=(null==h?void 0:h.useDataSources)&&h.useDataSources.some((function(e){return(null==o?void 0:o.dataSourceId)===e.dataSourceId})))return"break"},S=0;S<n.length;S++){if("break"===g(S))break}return m&&f},t.groupUseDataSourcesByMainDsAndAddAutoViews=function(e,n,a){if(!a||!n||0===n.length)return{};var o={};return n.forEach((function(e){if(o[e.mainDataSourceId]||(o[e.mainDataSourceId]=[]),!o[e.mainDataSourceId].some((function(t){return t.dataSourceId===e.dataSourceId})))if(!e.dataViewId&&e.dataSourceId===e.mainDataSourceId){var t=e.set("dataSourceId",r.DataSourceManager.getInstance().getDataViewDataSourceId(e.mainDataSourceId,"USE_MAIN_DATA_SOURCE")).set("dataViewId","USE_MAIN_DATA_SOURCE");o[e.mainDataSourceId]=o[e.mainDataSourceId].concat(t)}else o[e.mainDataSourceId]=o[e.mainDataSourceId].concat(e)})),Object.keys(o).forEach((function(s){o[s]=o[s].concat(t.getAutoAddedDataViews(e,o[s],n,a))})),o},t.getAutoAddedDataViews=function(e,n,a,o){if(!n||0===n.length||!o)return[];var s=[];if(t.props.useSelectionDataView){var i=n[0].set("dataSourceId",r.DataSourceManager.getInstance().getDataViewDataSourceId(n[0].mainDataSourceId,r.CONSTANTS.SELECTION_DATA_VIEW_ID)).set("dataViewId",r.CONSTANTS.SELECTION_DATA_VIEW_ID);s=s.concat(i)}if(t.props.usePopulatedDataView&&t.getWhetherUseRepeatedDataSourceContext(e,n,a,o)){var l=n[0].set("dataSourceId",r.DataSourceManager.getInstance().getDataViewDataSourceId(n[0].mainDataSourceId,r.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID)).set("dataViewId",r.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID);s=s.concat(l)}return s},t.getDsLabel=function(e,n){if(n&&n===r.CONSTANTS.SELECTION_DATA_VIEW_ID)return t.props.intl.formatMessage({id:"selectionDataView",defaultMessage:i.defaultMessages.selectionDataView});if(n&&n===r.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID)return t.props.intl.formatMessage({id:"populatedDataView",defaultMessage:i.defaultMessages.populatedDataView});if(n&&"USE_MAIN_DATA_SOURCE"===n)return t.props.intl.formatMessage({id:"default",defaultMessage:i.defaultMessages.default});var a=r.DataSourceManager.getInstance().getDataSource(e);return a?a.getLabel()||a.id:e},t.getRealUseDataSources=function(e,t){if(!e)return null;if("USE_MAIN_DATA_SOURCE"===e.dataViewId)return e.set("dataSourceId",e.mainDataSourceId).without("dataViewId");if(e.dataViewId===r.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID){var n=t.find((function(t){return t.mainDataSourceId===e.mainDataSourceId}));return n&&r.Immutable(n)}return e},t.onMainDataChange=function(e){var n=e.target.value;if(n!==t.props.selectedUseDataSource.mainDataSourceId){var a=r.Immutable(t.props.useDataSources.find((function(e){return e.mainDataSourceId===n}))||{dataSourceId:n,mainDataSourceId:n});t.props.onChange(a,t.props.isSelectedFromRepeatedDataSourceContext)}},t.onDataViewChange=function(e){if(t.props.selectedUseDataSource){var n=e.target.value,a=t.props.selectedUseDataSource.set("dataSourceId",r.DataSourceManager.getInstance().getDataViewDataSourceId(t.props.selectedUseDataSource.mainDataSourceId,n)).set("dataViewId",n);t.props.onChange(t.getRealUseDataSources(a,t.props.useDataSources),(null==a?void 0:a.dataViewId)===r.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID)}},t}return o(t,e),t.prototype.componentDidMount=function(){if(!this.props.selectedUseDataSource){var e=this.getOneDefaultUseDs(this.props.widgetId,this.props.useDataSources,this.props.browserSizeMode);this.props.onChange(this.getRealUseDataSources(e,this.props.useDataSources),(null==e?void 0:e.dataViewId)===r.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID)}},t.prototype.componentDidUpdate=function(e){if(e.widgetId!==this.props.widgetId||!this.getWhetherUseDsIsShallowEqual(e.useDataSources,this.props.useDataSources)||e.browserSizeMode!==this.props.browserSizeMode||!this.props.selectedUseDataSource){var t=this.getOneDefaultUseDs(this.props.widgetId,this.props.useDataSources,this.props.browserSizeMode);this.props.onChange(this.getRealUseDataSources(t,this.props.useDataSources),(null==t?void 0:t.dataViewId)===r.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID)}},t.prototype.render=function(){var e,t,n=this;if(!this.props.useDataSources)return null;var a=this.groupUseDataSourcesByMainDsAndAddAutoViews(this.props.widgetId,this.props.useDataSources,this.props.browserSizeMode),o=this.getSelectedUseDsFromProps(this.props.widgetId,this.props.selectedUseDataSource,this.props.useDataSources,this.props.isSelectedFromRepeatedDataSourceContext,this.props.browserSizeMode);return r.jsx("div",{className:r.classNames("w-100",(e={},e[this.props.className]=!!this.props.className,e))},r.jsx("div",{className:"component-main-data-and-view"},!this.props.hideMainDataSourceSelect&&r.jsx("div",{className:"w-100 text-truncate mb-12 option-label"},this.props.intl.formatMessage({id:"data",defaultMessage:i.defaultMessages.data})),!this.props.hideMainDataSourceSelect&&r.jsx("div",{className:"flex-grow-1"},r.jsx(i.Select,{value:null==o?void 0:o.mainDataSourceId,className:"select-max-width text-truncate",onChange:this.onMainDataChange},Object.keys(a).sort((function(e,t){return e.localeCompare(t)})).map((function(e,t){return r.jsx("option",{value:e,key:t,className:"select-max-width text-truncate"},n.getDsLabel(e))})))),r.jsx("div",{className:r.classNames("flex-grow-1",{"mt-3":!this.props.hideMainDataSourceSelect})},r.jsx(i.Select,{value:null==o?void 0:o.dataViewId,className:"select-max-width text-truncate",onChange:this.onDataViewChange},null===(t=a[null==o?void 0:o.mainDataSourceId])||void 0===t?void 0:t.sort((function(e,t){var n;return null===(n=null==e?void 0:e.dataSourceId)||void 0===n?void 0:n.localeCompare(null==t?void 0:t.dataSourceId)})).map((function(e,t){return r.jsx("option",{value:e.dataViewId,key:t,className:"select-max-width text-truncate"},n.getDsLabel(e.dataSourceId,e.dataViewId))}))))))},t}(r.React.PureComponent),d=r.ReactRedux.connect((function(e,t){var n,a;return{browserSizeMode:(null===(n=null==e?void 0:e.appContext)||void 0===n?void 0:n.isBuilder)?null===(a=null==e?void 0:e.appStateInBuilder)||void 0===a?void 0:a.browserSizeMode:null==e?void 0:e.browserSizeMode}}))(c);t.MainDataAndViewSelector=r.injectIntl(r.themeUtils.withStyles(d,"MainDataAndViewSelector"))},59:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o=n(0),s=n(3),r=n(125);function i(e,t){if(!e||!t)return[];var n=l(e,t),a=o.DataSourceManager.getInstance().getDataSource(e);if(!a)return n;var s=[];return a.getDataViews().forEach((function(e){s=s.concat(l(e.id,t))})),Array.from(new Set(n.concat(s)))}function l(e,t){if(!e||!t)return[];var n=c(e,t),a=function(e,t){if(!e||!t)return[];var n=d(o.DataSourceManager.getInstance().getDataSource(e)),a=[],s=[];return n.forEach((function(e){e&&e.id&&(s=c(e.id,t),a=a.concat(s))})),Array.from(new Set(a))}(e,t);return Array.from(new Set(n.concat(a))).map((function(e){return t[e]}))}function c(e,t){return e&&t?function(e){if(!e)return[];var t=[];return Object.keys(e).forEach((function(n){t.push(e[n])})),t}(t).filter((function(t){return t&&!1!==t.useDataSourcesEnabled&&t.useDataSources&&t.useDataSources.some((function(t){return t.dataSourceId===e}))})).map((function(e){return e.id})):[]}function d(e){if(!e||!e.id)return[];var t=u(),n=t&&t.dataSources,a=[];return n&&Object.keys(n).forEach((function(t){n[t]&&n[t].isOutputFromWidget&&n[t].originDataSources&&n[t].originDataSources.some((function(t){return t.dataSourceId===e.id}))&&(a=a.concat(o.DataSourceManager.getInstance().getDataSource(t)))})),a}function u(){var e=window&&window.jimuConfig&&window.jimuConfig.isBuilder?o.getAppStore().getState().appStateInBuilder:o.getAppStore().getState();return e&&e.appConfig}!function(e){e.Point="POINT",e.Polyline="POLYLINE",e.Polygon="POLYGON"}(a||(a={})),t.getWidgetsUsingDsOrItsViews=i,t.getWidgetsUsingDsOrItsDescendantDss=function e(t,n){if(!t||!n)return[];var a=i(t,n),s=o.DataSourceManager.getInstance().getDataSource(t);if(!s)return a;var r=[];return s.isDataSourceSet&&s.getChildDataSources().forEach((function(t){r=r.concat(e(t.id,n))})),Array.from(new Set(a.concat(r)))},t.getWidgetsUsingOneDsOrOneView=l,t.getDescendantDssAndViews=function e(t){var n,a;if(!t)return[];var s=o.DataSourceManager.getInstance().getDataSource(t);if(!s)return[t];var r=[t];return null===(n=s.getDataViews())||void 0===n||n.forEach((function(e){return r=r.concat(e.id)})),s.isDataSourceSet&&(null===(a=s.getChildDataSources())||void 0===a||a.forEach((function(t){r=r.concat(e(t.id))}))),r},t.isFuzzySearch=function(e,t){return!!e&&(!t||e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1)},t.isFuzzyFromDsIds=function(e,t){return!(!e||!e.id)&&(!t||t.indexOf(e.id)>-1)},t.getOutputDssFromOriginDs=d,t.getAppConfig=u,t.getDsIcon=function(e){switch(function(e,t,n){switch(e){case r.AllDataSourceTypes.WebMap:case r.AllDataSourceTypes.FeatureSet:case r.AllDataSourceTypes.WebScene:case r.AllDataSourceTypes.MapService:case r.AllDataSourceTypes.FeatureService:case r.AllDataSourceTypes.GroupLayer:return e;case r.AllDataSourceTypes.FeatureLayer:case r.AllDataSourceTypes.FeatureQuery:return n?e+"_"+o.SupportedLayerServiceTypes.Table:t?e+"_"+t:e;default:return"UNKNOWN"}}(e&&e.type,function(e){if(e){if(-1!==e.toLowerCase().indexOf(a.Point.toLowerCase()))return a.Point;if(-1!==e.toLowerCase().indexOf(a.Polyline.toLowerCase()))return a.Polyline;if(-1!==e.toLowerCase().indexOf(a.Polygon.toLowerCase()))return a.Polygon}return null}(e&&e.geometryType||function(e){var t=o.DataSourceManager.getInstance(),n=e&&t.getDataSource(e.id),a=null;!n||n.type!==r.AllDataSourceTypes.FeatureQuery&&n.type!==r.AllDataSourceTypes.FeatureLayer||(a=n.getLayerDefinition().geometryType);return a}(e)),function(e){var t,n;if(!e)return!1;var a=o.DataSourceManager.getInstance().getDataSource(e.id);return(null===(t=a)||void 0===t?void 0:t.getLayerDefinition)&&(null===(n=a.getLayerDefinition())||void 0===n?void 0:n.type)===o.SupportedLayerServiceTypes.Table}(e))){case r.AllDataSourceTypes.WebMap:return n(231);case r.AllDataSourceTypes.WebScene:return n(232);case r.AllDataSourceTypes.FeatureLayer+"_"+a.Point:case r.AllDataSourceTypes.FeatureQuery+"_"+a.Point:return n(376);case r.AllDataSourceTypes.FeatureLayer+"_"+a.Polyline:case r.AllDataSourceTypes.FeatureQuery+"_"+a.Polyline:return n(377);case r.AllDataSourceTypes.FeatureLayer+"_"+a.Polygon:case r.AllDataSourceTypes.FeatureQuery+"_"+a.Polygon:return n(378);case r.AllDataSourceTypes.FeatureLayer+"_"+o.SupportedLayerServiceTypes.Table:case r.AllDataSourceTypes.FeatureQuery+"_"+o.SupportedLayerServiceTypes.Table:return n(379);case""+r.AllDataSourceTypes.FeatureLayer:case""+r.AllDataSourceTypes.FeatureQuery:return n(233);case""+r.AllDataSourceTypes.FeatureSet:return n(234);case""+r.AllDataSourceTypes.FeatureService:return n(380);case""+r.AllDataSourceTypes.MapService:return n(381);case""+r.AllDataSourceTypes.GroupLayer:return n(382);default:return n(235)}},t.getDsTypeString=function(e,t){if(!e||!t)return"";switch(e){case r.AllDataSourceTypes.FeatureLayer:case r.AllDataSourceTypes.FeatureQuery:return t.formatMessage({id:"featureLayer",defaultMessage:s.defaultMessages.featureLayer});case r.AllDataSourceTypes.FeatureSet:return t.formatMessage({id:"featureSet",defaultMessage:s.defaultMessages.featureSet});case r.AllDataSourceTypes.FeatureService:return t.formatMessage({id:"featureService",defaultMessage:s.defaultMessages.featureService});case r.AllDataSourceTypes.MapService:return t.formatMessage({id:"mapService",defaultMessage:s.defaultMessages.mapService});case r.AllDataSourceTypes.GroupLayer:return t.formatMessage({id:"groupLayer",defaultMessage:s.defaultMessages.groupLayer});case r.AllDataSourceTypes.Map:return t.formatMessage({id:"map",defaultMessage:s.defaultMessages.map});case r.AllDataSourceTypes.SimpleLocal:return t.formatMessage({id:"simpleLocal",defaultMessage:s.defaultMessages.simpleLocal});case r.AllDataSourceTypes.WebMap:return t.formatMessage({id:"webMap",defaultMessage:s.defaultMessages.webMap});case r.AllDataSourceTypes.WebScene:return t.formatMessage({id:"webScene",defaultMessage:s.defaultMessages.webScene});case r.AllDataSourceTypes.CSV:return t.formatMessage({id:"csv",defaultMessage:s.defaultMessages.csv});default:return""}},t.getWhetherDataSourceIsInited=function(e){return!e||Object.keys(e).every((function(t){var n;return!(null===(n=e[t])||void 0===n?void 0:n.instanceStatus)||e[t].instanceStatus===o.DataSourceStatus.Created||e[t].instanceStatus===o.DataSourceStatus.CreateError}))},t.editDataSourceJson=function(e){var t=o.DataSourceManager.getInstance().getDataSource(null==e?void 0:e.id);if(!t||!e)return null;for(var n=t,a=e;n.parentDataSource;)a=n.parentDataSource.getDataSourceJson().setIn(["childDataSourceJsons",n.jimuChildId],a),n=n.parentDataSource;return function e(t){var n,a=o.DataSourceManager.getInstance().getDataSource(null==t?void 0:t.id);if(!a||!t)return null;var s=t,r=!!s.isHidden;a.isDataSourceSet&&(null===(n=a.getChildDataSources())||void 0===n?void 0:n.length)>0&&a.getChildDataSources().forEach((function(t){var n=s.getIn(["childDataSourceJsons",t.jimuChildId])||(null==t?void 0:t.getDataSourceJson());n&&(r&&(n=n.set("isHidden",!0)),s=s.setIn(["childDataSourceJsons",t.jimuChildId],e(n)))}));return s}(a)}}})}));